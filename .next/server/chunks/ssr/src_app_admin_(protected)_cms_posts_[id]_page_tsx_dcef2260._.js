module.exports=[245353,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(699570),f=a.i(866718),g=a.i(870430),h=a.i(429246),i=a.i(580701),j=a.i(757061),k=a.i(505084),l=a.i(820049),m=a.i(400210),n=a.i(114548),o=a.i(177156),p=a.i(321161),q=a.i(838632),r=a.i(633508),s=a.i(334044),t=a.i(476270),u=a.i(596221),v=a.i(167453),w=a.i(641710),x=a.i(104720),y=a.i(773320),z=a.i(944897),z=z,A=a.i(533350),B=a.i(587532),C=a.i(797063),D=a.i(292e3),E=a.i(406704);function F(a,b=200){if(!a||""===a.trim())return{wordCount:0,characterCount:0,readingTimeMinutes:0};let c=a.replace(/<[^>]*>/g," ").replace(/&nbsp;/g," ").replace(/&[a-z]+;/g," ").replace(/\s+/g," ").trim(),d=c.replace(/\s/g,"").length,e=c.split(/\s+/).filter(a=>a.length>0).length,f=Math.ceil(e/b);return{wordCount:e,characterCount:d,readingTimeMinutes:Math.max(1,f)}}function G(a){return 0===a?"< 1 min read":1===a?"1 min read":`${a} min read`}var H=a.i(571987),I=a.i(648571),J=a.i(368114);function K({params:a}){let{id:K}=(0,c.use)(a),L=(0,d.useRouter)(),M="new"===K,N=(0,c.useRef)(null),O=(0,c.useRef)(null),[P,Q]=(0,c.useState)(!M),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(null),[X,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(!1),[ad,ae]=(0,c.useState)(""),[af,ag]=(0,c.useState)(""),[ah,ai]=(0,c.useState)(""),[aj,ak]=(0,c.useState)(""),[al,am]=(0,c.useState)("DRAFT"),[an,ao]=(0,c.useState)(null),[ap,aq]=(0,c.useState)([]),[ar,as]=(0,c.useState)(""),[at,au]=(0,c.useState)(""),[av,aw]=(0,c.useState)(""),[ax,ay]=(0,c.useState)(!1),[az,aA]=(0,c.useState)(!1),aB=F(ah),aC=F(ad);(0,c.useEffect)(()=>{aE(),M?setTimeout(()=>{N.current?.focus()},100):aF()},[K]);let aD=(0,c.useCallback)(async()=>{let a=af;if(ad&&!af&&(ag(a=ad.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")),ay(!1)),!ad||!a){E.default.error("Title is required"),ad?$(!0):N.current?.focus();return}try{S(!0);let b=M?"/api/admin/cms/posts":`/api/admin/cms/posts/${K}`,c=M?"POST":"PUT",d=await fetch(b,{method:c,headers:{"Content-Type":"application/json"},body:JSON.stringify({title:ad,slug:a,content:ah,excerpt:aj,status:al,categoryId:an,selectedTags:ap,featuredImage:ar,seoTitle:at,seoDescription:av})});if(d.ok){let a=await d.json();E.default.success(M?"Post created":"Post updated"),W(new Date),M&&L.push(`/admin/cms/posts/${a.id}`)}else{let a=await d.text();E.default.error(a||"Failed to save post")}}catch(a){console.error("Error saving post:",a),E.default.error("An error occurred")}finally{S(!1)}},[ad,af,ah,aj,al,an,ap,ar,at,av,M,K,L]);(0,c.useEffect)(()=>{if(!M&&ad&&af)return O.current&&clearTimeout(O.current),O.current=setTimeout(()=>{aG()},2e3),()=>{O.current&&clearTimeout(O.current)}},[ad,af,ah,aj,al,an,ar,at,av]),(0,c.useEffect)(()=>{let a=a=>{(a.ctrlKey||a.metaKey)&&"s"===a.key&&(a.preventDefault(),aD()),(a.ctrlKey||a.metaKey)&&"k"===a.key&&(a.preventDefault(),aa(a=>!a))};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[aD]);let aE=async()=>{try{let a=await fetch("/api/admin/cms/categories");if(a.ok){let b=await a.json();Y(b)}}catch(a){console.error("Error fetching categories:",a)}},aF=async()=>{try{let a=await fetch(`/api/admin/cms/posts/${K}`);if(a.ok){let b=await a.json();ae(b.title),ag(b.slug),ai(b.content),ak(b.excerpt||""),am(b.status),ao(b.categoryId),aq(b.tags?.map(a=>a.id)||[]),as(b.featuredImage||""),au(b.seoTitle||""),aw(b.seoDescription||""),ay(!0),W(new Date(b.updatedAt||b.createdAt))}else E.default.error("Failed to fetch post"),L.push("/admin/cms/posts")}catch(a){console.error("Error fetching post:",a),E.default.error("An error occurred")}finally{Q(!1)}},aG=async()=>{if(ad&&af&&!R)try{U(!0);let a=`/api/admin/cms/posts/${K}`;(await fetch(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:ad,slug:af,content:ah,excerpt:aj,status:al,categoryId:an,selectedTags:ap,featuredImage:ar,seoTitle:at,seoDescription:av})})).ok&&W(new Date)}catch(a){console.error("Auto-save failed:",a)}finally{U(!1)}};return P?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)(u.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,b.jsxs)("div",{className:(0,J.cn)("min-h-screen bg-background transition-all duration-300",_&&"bg-gradient-to-b from-background to-muted/20"),children:[(0,b.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,b.jsxs)("div",{className:"container flex h-14 items-center justify-between mx-auto px-4 max-w-7xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",onClick:()=>L.back(),children:(0,b.jsx)(m.ArrowLeft,{className:"w-4 h-4"})}),(0,b.jsx)("div",{className:"flex items-center gap-2 text-sm",children:T?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"h-3 w-3 animate-spin text-muted-foreground"}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"Saving..."})]}):V?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.CheckCircle2,{className:"h-3 w-3 text-green-600"}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:["Saved ",V.toLocaleTimeString()]})]}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"Not saved"})}),!M&&(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(x.FileText,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:[aB.wordCount," words"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(w.Clock,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:G(aB.readingTimeMinutes)})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",onClick:()=>aa(!_),title:"Toggle Focus Mode (Ctrl+K)",children:[_?(0,b.jsx)(t.Minimize2,{className:"w-4 h-4 mr-2"}):(0,b.jsx)(s.Maximize2,{className:"w-4 h-4 mr-2"}),"Focus"]}),(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",onClick:()=>window.open(`/en/blog/${af}`,"_blank"),disabled:!af,children:[(0,b.jsx)(o.Eye,{className:"w-4 h-4 mr-2"}),"Preview"]}),(0,b.jsxs)(j.Sheet,{open:Z,onOpenChange:$,children:[(0,b.jsx)(j.SheetTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",children:[(0,b.jsx)(p.Settings,{className:"w-4 h-4 mr-2"}),"Settings"]})}),(0,b.jsxs)(j.SheetContent,{side:"right",className:"w-full sm:max-w-lg overflow-y-auto",children:[(0,b.jsxs)(j.SheetHeader,{className:"pb-4 border-b",children:[(0,b.jsxs)(j.SheetTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(p.Settings,{className:"w-5 h-5"}),"Post Settings"]}),(0,b.jsx)(j.SheetDescription,{children:"Configure your post settings, metadata, and SEO"})]}),(0,b.jsxs)("div",{className:"space-y-6 py-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[(0,b.jsx)(x.FileText,{className:"w-4 h-4"}),"Basic Information"]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"slug",className:"flex items-center gap-2",children:[(0,b.jsx)(z.default,{className:"w-4 h-4 text-muted-foreground"}),"URL Slug"]}),(0,b.jsx)(f.Input,{id:"slug",value:af,onChange:a=>{ag(a.target.value),ay(!0)},placeholder:"post-slug",className:"font-mono"}),(0,b.jsxs)("div",{className:"flex items-start gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)(C.Info,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),(0,b.jsx)("span",{children:"URL-friendly identifier. Auto-generated from title if left empty."})]}),af&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground font-mono bg-muted px-2 py-1 rounded",children:["/blog/",af]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"excerpt",className:"flex items-center gap-2",children:[(0,b.jsx)(x.FileText,{className:"w-4 h-4 text-muted-foreground"}),"Excerpt"]}),(0,b.jsx)(h.Textarea,{id:"excerpt",value:aj,onChange:a=>ak(a.target.value),placeholder:"Short summary for list views and SEO (optional)",rows:3,className:"resize-none"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[aj.length," characters"]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"category",className:"flex items-center gap-2",children:[(0,b.jsx)(A.Tag,{className:"w-4 h-4 text-muted-foreground"}),"Category"]}),(0,b.jsxs)(i.Select,{value:an||"",onValueChange:ao,children:[(0,b.jsx)(i.SelectTrigger,{id:"category",children:(0,b.jsx)(i.SelectValue,{placeholder:"Select a category (optional)"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"",children:"No category"}),X.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id,children:a.name},a.id))]})]})]})]}),(0,b.jsx)(k.Separator,{}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[(0,b.jsx)(B.Search,{className:"w-4 h-4"}),"SEO Settings"]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"seo-title",className:"flex items-center gap-2",children:["SEO Title",(0,b.jsx)("span",{className:"text-xs font-normal text-muted-foreground",children:"(optional)"})]}),(0,b.jsx)(f.Input,{id:"seo-title",value:at,onChange:a=>au(a.target.value),placeholder:"Custom meta title for search engines",maxLength:60}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("p",{className:(0,J.cn)("text-xs",at.length>60?"text-red-600":"text-muted-foreground"),children:[at.length,"/60 characters"]}),at.length>60&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[(0,b.jsx)(D.AlertCircle,{className:"w-3 h-3"}),(0,b.jsx)("span",{children:"Too long"})]})]}),!at&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"If empty, the post title will be used"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"seo-description",className:"flex items-center gap-2",children:["SEO Description",(0,b.jsx)("span",{className:"text-xs font-normal text-muted-foreground",children:"(optional)"})]}),(0,b.jsx)(h.Textarea,{id:"seo-description",value:av,onChange:a=>aw(a.target.value),placeholder:"Meta description for search engines",rows:3,className:"resize-none",maxLength:160}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("p",{className:(0,J.cn)("text-xs",av.length>160?"text-red-600":"text-muted-foreground"),children:[av.length,"/160 characters"]}),av.length>160&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-xs text-red-600",children:[(0,b.jsx)(D.AlertCircle,{className:"w-3 h-3"}),(0,b.jsx)("span",{children:"Too long"})]})]}),!av&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"If empty, the excerpt will be used"})]})]}),(0,b.jsx)(k.Separator,{}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[(0,b.jsx)(C.Info,{className:"w-4 h-4"}),"Publication Status"]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Status"}),(0,b.jsxs)(i.Select,{value:al,onValueChange:am,children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"DRAFT",children:"Draft"}),(0,b.jsx)(i.SelectItem,{value:"PUBLISHED",children:"Published"}),(0,b.jsx)(i.SelectItem,{value:"ARCHIVED",children:"Archived"})]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-2 text-xs text-muted-foreground mt-1",children:[(0,b.jsx)(C.Info,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),(0,b.jsxs)("span",{children:["DRAFT"===al&&"Post is saved but not visible to the public","PUBLISHED"===al&&"Post is live and visible to all visitors","ARCHIVED"===al&&"Post is hidden from public view"]})]})]})]})]})]})]}),(0,b.jsxs)(i.Select,{value:al,onValueChange:am,children:[(0,b.jsx)(i.SelectTrigger,{className:"w-[130px]",children:(0,b.jsx)(i.SelectValue,{})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"DRAFT",children:"Draft"}),(0,b.jsx)(i.SelectItem,{value:"PUBLISHED",children:"Published"}),(0,b.jsx)(i.SelectItem,{value:"ARCHIVED",children:"Archived"})]})]}),(0,b.jsx)(e.Button,{onClick:aD,disabled:R||T,className:"bg-green-600 hover:bg-green-700 text-white",children:R?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Save,{className:"w-4 h-4 mr-2"}),M?"Publish":"Update"]})})]})]})}),(0,b.jsxs)("main",{className:(0,J.cn)("container mx-auto px-4 py-8 transition-all duration-300",_?"max-w-3xl":"max-w-5xl"),children:[(0,b.jsx)("div",{className:(0,J.cn)("mb-8 group relative transition-all",ab&&"ring-2 ring-primary ring-offset-2"),onDragOver:a=>{a.preventDefault(),a.stopPropagation(),ac(!0)},onDragLeave:a=>{a.preventDefault(),a.stopPropagation(),ac(!1)},onDrop:a=>{a.preventDefault(),a.stopPropagation(),ac(!1),Array.from(a.dataTransfer.files).filter(a=>a.type.startsWith("image/")).length>0&&aA(!0)},children:ar?(0,b.jsxs)("div",{className:"relative aspect-video w-full overflow-hidden rounded-lg shadow-lg border",children:[(0,b.jsx)(H.default,{src:ar,alt:"Cover",fill:!0,className:"object-cover",priority:!0}),(0,b.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors"}),(0,b.jsxs)("div",{className:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,b.jsxs)(e.Button,{variant:"secondary",size:"sm",onClick:()=>aA(!0),children:[(0,b.jsx)(y.Upload,{className:"w-4 h-4 mr-2"}),"Change"]}),(0,b.jsxs)(e.Button,{variant:"destructive",size:"sm",onClick:()=>as(""),children:[(0,b.jsx)(r.X,{className:"w-4 h-4 mr-2"}),"Remove"]})]})]}):(0,b.jsxs)("button",{type:"button",onClick:()=>aA(!0),className:(0,J.cn)("w-full h-32 border-2 border-dashed rounded-lg transition-all","hover:border-primary hover:bg-muted/50","flex flex-col items-center justify-center gap-2 text-muted-foreground","focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",ab&&"border-primary bg-primary/5"),children:[(0,b.jsx)(q.Image,{className:"w-8 h-8"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Add Cover Image"}),(0,b.jsx)("span",{className:"text-xs",children:"Click or drag and drop"})]})}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)(h.Textarea,{ref:N,value:ad,onChange:a=>{let b=a.target.value;ae(b),a.target.style.height="auto",a.target.style.height=a.target.scrollHeight+"px",M&&!ax&&ag(b.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,""))},placeholder:"Post title...",className:"w-full resize-none overflow-hidden bg-transparent text-4xl font-bold border-none focus-visible:ring-0 p-0 placeholder:text-muted-foreground/50 min-h-[60px] leading-tight",rows:1}),ad&&(0,b.jsxs)("div",{className:"mt-2 flex items-center gap-4 text-xs text-muted-foreground",children:[(0,b.jsxs)("span",{children:[aC.wordCount," words"]}),af&&(0,b.jsxs)("span",{className:"font-mono",children:["/",af]})]})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(l.RichTextEditor,{content:ah,onChange:ai}),ah&&(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between text-xs text-muted-foreground border-t pt-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("span",{children:[aB.wordCount," words"]}),(0,b.jsxs)("span",{children:[aB.characterCount," characters"]}),(0,b.jsx)("span",{children:G(aB.readingTimeMinutes)})]}),(0,b.jsxs)("div",{className:"text-xs",children:["Press ",(0,b.jsx)("kbd",{className:"px-1.5 py-0.5 bg-muted rounded text-xs",children:"Ctrl+S"})," to save"]})]})]})]}),(0,b.jsx)(I.MediaPicker,{open:az,onOpenChange:aA,onSelect:a=>{a.length>0&&as(a[0].url),aA(!1)},type:"IMAGE",multiple:!1})]})}a.s(["default",()=>K],245353)}];

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="5d162f2c-be35-5f5c-aed2-754b381a997b")}catch(e){}}();
//# sourceMappingURL=src_app_admin_%28protected%29_cms_posts_%5Bid%5D_page_tsx_dcef2260._.js.map
//# debugId=5d162f2c-be35-5f5c-aed2-754b381a997b
