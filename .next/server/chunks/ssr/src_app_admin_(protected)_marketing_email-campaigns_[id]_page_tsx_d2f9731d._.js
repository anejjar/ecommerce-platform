module.exports=[927168,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(591119),f=a.i(699570),g=a.i(786304),h=a.i(596221),i=a.i(400210),j=a.i(692759),k=a.i(824569),l=a.i(781560),m=a.i(992258),n=a.i(177156),o=a.i(765910),p=a.i(406704),q=a.i(238246),r=a.i(814574),s=a.i(866718),t=a.i(870430),u=a.i(429246),v=a.i(48468),w=a.i(814188),w=w;function x({campaignId:a,open:d,onOpenChange:e,onSuccess:g}){let[i,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)("all"),[n,o]=(0,c.useState)(""),[q,x]=(0,c.useState)(""),y=async()=>{k(!0);try{let b={};if("test"===l){if(!n){p.toast.error("Please enter a test email address"),k(!1);return}b.testEmail=n}else if("all"===l)b.sendToAll=!0;else if("custom"===l){if(!q){p.toast.error("Please enter at least one email address"),k(!1);return}let a=q.split(/[,\n]/).map(a=>a.trim()).filter(a=>a.length>0);if(0===a.length){p.toast.error("Please enter valid email addresses"),k(!1);return}b.recipientEmails=a}let c=await fetch(`/api/admin/email-campaigns/${a}/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to send campaign")}let d=await c.json();"test"===l?p.toast.success(`Test email sent to ${n}`):p.toast.success(d.message||"Campaign sent successfully"),g(),e(!1),z()}catch(a){p.toast.error(a.message)}finally{k(!1)}},z=()=>{m("all"),o(""),x("")};return(0,b.jsx)(r.Dialog,{open:d,onOpenChange:e,children:(0,b.jsxs)(r.DialogContent,{children:[(0,b.jsxs)(r.DialogHeader,{children:[(0,b.jsx)(r.DialogTitle,{children:"Send Campaign"}),(0,b.jsx)(r.DialogDescription,{children:"Choose how you want to send this email campaign"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)(v.RadioGroup,{value:l,onValueChange:a=>m(a),children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 border rounded-lg p-4",children:[(0,b.jsx)(v.RadioGroupItem,{value:"all",id:"all"}),(0,b.jsxs)(t.Label,{htmlFor:"all",className:"flex-1 cursor-pointer",children:[(0,b.jsx)("div",{className:"font-medium",children:"Send to All Subscribers"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Send to all active newsletter subscribers"})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 border rounded-lg p-4",children:[(0,b.jsx)(v.RadioGroupItem,{value:"test",id:"test"}),(0,b.jsxs)(t.Label,{htmlFor:"test",className:"flex-1 cursor-pointer",children:[(0,b.jsx)("div",{className:"font-medium",children:"Send Test Email"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Send a test to verify design and content"})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 border rounded-lg p-4",children:[(0,b.jsx)(v.RadioGroupItem,{value:"custom",id:"custom"}),(0,b.jsxs)(t.Label,{htmlFor:"custom",className:"flex-1 cursor-pointer",children:[(0,b.jsx)("div",{className:"font-medium",children:"Custom Recipient List"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Send to specific email addresses"})]})]})]}),"test"===l&&(0,b.jsxs)("div",{children:[(0,b.jsx)(t.Label,{htmlFor:"testEmail",children:"Test Email Address"}),(0,b.jsx)(s.Input,{id:"testEmail",type:"email",value:n,onChange:a=>o(a.target.value),placeholder:"your-email@example.com"})]}),"custom"===l&&(0,b.jsxs)("div",{children:[(0,b.jsx)(t.Label,{htmlFor:"customEmails",children:"Email Addresses"}),(0,b.jsx)(u.Textarea,{id:"customEmails",value:q,onChange:a=>x(a.target.value),placeholder:"email1@example.com, email2@example.com or one per line",rows:5}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Enter email addresses separated by commas or new lines"})]}),"all"===l&&(0,b.jsx)("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900 rounded-lg p-4",children:(0,b.jsxs)("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[(0,b.jsx)("strong",{children:"Note:"})," This will send the campaign to all active newsletter subscribers. This action cannot be undone."]})})]}),(0,b.jsxs)(r.DialogFooter,{children:[(0,b.jsx)(f.Button,{type:"button",variant:"outline",onClick:()=>e(!1),children:"Cancel"}),(0,b.jsxs)(f.Button,{onClick:y,disabled:i,children:[i&&(0,b.jsx)(h.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"test"===l?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(w.default,{className:"mr-2 h-4 w-4"}),"Send Test"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.Send,{className:"mr-2 h-4 w-4"}),"Send Campaign"]})]})]})]})})}var y=a.i(131361),z=a.i(206015);function A(){var a;let r,s,t=(0,d.useParams)(),u=(0,d.useRouter)(),[v,w]=(0,c.useState)(null),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(!1);(0,c.useEffect)(()=>{t.id&&E()},[t.id]);let E=async()=>{try{let a=await fetch(`/api/admin/email-campaigns/${t.id}`);if(!a.ok)throw Error("Failed to fetch campaign");let b=await a.json();w(b)}catch(a){console.error("Error fetching campaign:",a),p.toast.error("Failed to load campaign")}finally{B(!1)}},F=async()=>{if(confirm("Are you sure you want to delete this campaign?"))try{if(!(await fetch(`/api/admin/email-campaigns/${t.id}`,{method:"DELETE"})).ok)throw Error("Failed to delete campaign");p.toast.success("Campaign deleted"),u.push("/admin/marketing/email-campaigns")}catch(a){p.toast.error("Failed to delete campaign")}};return A?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(h.Loader2,{className:"h-8 w-8 animate-spin"})}):v?(0,b.jsx)(y.FeatureCheck,{featureName:"email_campaigns",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(q.default,{href:"/admin/marketing/email-campaigns",children:(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",children:[(0,b.jsx)(i.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back"]})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:v.name}),(a=v.status,s=(r={DRAFT:{className:"bg-gray-500/10 text-gray-600 border-gray-200",label:"Draft"},SCHEDULED:{className:"bg-blue-500/10 text-blue-600 border-blue-200",label:"Scheduled"},SENDING:{className:"bg-yellow-500/10 text-yellow-600 border-yellow-200",label:"Sending"},SENT:{className:"bg-green-500/10 text-green-600 border-green-200",label:"Sent"},PAUSED:{className:"bg-orange-500/10 text-orange-600 border-orange-200",label:"Paused"},CANCELLED:{className:"bg-red-500/10 text-red-600 border-red-200",label:"Cancelled"}})[a]||r.DRAFT,(0,b.jsx)(g.Badge,{variant:"outline",className:s.className,children:s.label}))]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:v.subject})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:["DRAFT"===v.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.default,{href:`/admin/marketing/email-campaigns/${v.id}/edit`,children:(0,b.jsxs)(f.Button,{variant:"outline",children:[(0,b.jsx)(k.Edit,{className:"h-4 w-4 mr-2"}),"Edit"]})}),(0,b.jsxs)(f.Button,{onClick:()=>D(!0),children:[(0,b.jsx)(j.Send,{className:"h-4 w-4 mr-2"}),"Send Campaign"]})]}),"SENT"!==v.status&&"SENDING"!==v.status&&(0,b.jsxs)(f.Button,{variant:"destructive",onClick:F,children:[(0,b.jsx)(l.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-5",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(m.Mail,{className:"h-4 w-4"}),"Sent"]})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:v.totalSent.toLocaleString()})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(n.Eye,{className:"h-4 w-4"}),"Opens"]})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:v.totalOpened.toLocaleString()}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[v&&0!==v.totalSent?Math.round(v.totalOpened/v.totalSent*100):0,"% rate"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsxs)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(o.MousePointer,{className:"h-4 w-4"}),"Clicks"]})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:v.totalClicked.toLocaleString()}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[v&&0!==v.totalSent?Math.round(v.totalClicked/v.totalSent*100):0,"% rate"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Bounced"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:v.totalBounced})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"pb-2",children:(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Unsubscribed"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"text-2xl font-bold",children:v.totalUnsubscribed})})]})]}),(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Campaign Information"})}),(0,b.jsxs)(e.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Type"}),(0,b.jsx)("div",{className:"mt-1",children:(0,b.jsx)(g.Badge,{variant:"outline",children:v.type.replace(/_/g," ")})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Subject Line"}),(0,b.jsx)("div",{className:"mt-1",children:v.subject})]}),v.preheader&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Preheader"}),(0,b.jsx)("div",{className:"mt-1 text-sm",children:v.preheader})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"From"}),(0,b.jsxs)("div",{className:"mt-1",children:[v.fromName||"Store"," <",v.fromEmail||"store@example.com",">"]})]}),v.replyTo&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Reply To"}),(0,b.jsx)("div",{className:"mt-1",children:v.replyTo})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Created"}),(0,b.jsx)("div",{className:"mt-1",children:new Date(v.createdAt).toLocaleString()})]}),v.sentAt&&(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Sent"}),(0,b.jsx)("div",{className:"mt-1",children:new Date(v.sentAt).toLocaleString()})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Email Preview"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"border rounded-lg p-4 bg-muted/50 max-h-96 overflow-auto",children:(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:v.htmlContent}})})})]})]}),v.recipients&&v.recipients.length>0&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{children:["Recipients (",v.recipients.length,")"]}),(0,b.jsx)(e.CardDescription,{children:"Recipient engagement details"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)(z.Table,{children:[(0,b.jsx)(z.TableHeader,{children:(0,b.jsxs)(z.TableRow,{children:[(0,b.jsx)(z.TableHead,{children:"Email"}),(0,b.jsx)(z.TableHead,{children:"Sent"}),(0,b.jsx)(z.TableHead,{children:"Opened"}),(0,b.jsx)(z.TableHead,{children:"Clicked"}),(0,b.jsx)(z.TableHead,{children:"Status"})]})}),(0,b.jsx)(z.TableBody,{children:v.recipients.slice(0,100).map(a=>(0,b.jsxs)(z.TableRow,{children:[(0,b.jsx)(z.TableCell,{className:"font-medium",children:a.email}),(0,b.jsx)(z.TableCell,{children:a.sent?(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-green-500/10 text-green-600",children:"Sent"}):(0,b.jsx)(g.Badge,{variant:"outline",children:"Pending"})}),(0,b.jsx)(z.TableCell,{children:a.opened?(0,b.jsx)("span",{className:"text-green-600",children:"✓"}):(0,b.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,b.jsx)(z.TableCell,{children:a.clicked?(0,b.jsx)("span",{className:"text-green-600",children:"✓"}):(0,b.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,b.jsx)(z.TableCell,{children:a.bounced&&(0,b.jsx)(g.Badge,{variant:"outline",className:"bg-red-500/10 text-red-600",children:"Bounced"})})]},a.id))})]}),v.recipients.length>100&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-4 text-center",children:"Showing first 100 recipients"})]})]}),(0,b.jsx)(x,{campaignId:v.id,open:C,onOpenChange:D,onSuccess:E})]})}):(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Campaign not found"}),(0,b.jsx)(q.default,{href:"/admin/marketing/email-campaigns",children:(0,b.jsx)(f.Button,{className:"mt-4",children:"Back to Campaigns"})})]})}a.s(["default",()=>A],927168)}];

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="0a2d9bd3-5338-5fa6-b7f1-890fd66dbf95")}catch(e){}}();
//# sourceMappingURL=src_app_admin_%28protected%29_marketing_email-campaigns_%5Bid%5D_page_tsx_d2f9731d._.js.map
//# debugId=0a2d9bd3-5338-5fa6-b7f1-890fd66dbf95
