{"version":3,"sources":["../../../../src/components/admin/FeatureGateLayout.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { useSession } from 'next-auth/react'\r\nimport { useRouter } from 'next/navigation'\r\nimport toast from 'react-hot-toast'\r\n\r\ninterface FeatureGateLayoutProps {\r\n  featureName: string\r\n  featureDisplayName: string\r\n  children: React.ReactNode\r\n}\r\n\r\nexport default function FeatureGateLayout({\r\n  featureName,\r\n  featureDisplayName,\r\n  children,\r\n}: FeatureGateLayoutProps) {\r\n  const { data: session, status } = useSession()\r\n  const router = useRouter()\r\n  const [featureEnabled, setFeatureEnabled] = useState<boolean | null>(null)\r\n  const [isLoading, setIsLoading] = useState(true)\r\n\r\n  useEffect(() => {\r\n    const checkFeatureAccess = async () => {\r\n      try {\r\n        // Check if feature is enabled\r\n        const response = await fetch('/api/features/enabled')\r\n        if (response.ok) {\r\n          const data = await response.json()\r\n          const isEnabled = data.features?.includes(featureName)\r\n          setFeatureEnabled(isEnabled)\r\n\r\n          if (!isEnabled) {\r\n            // Feature is disabled - redirect to admin dashboard\r\n            toast.error(`${featureDisplayName} feature is not available`)\r\n            router.push('/admin')\r\n            return\r\n          }\r\n        } else {\r\n          // If API fails, assume feature is disabled\r\n          setFeatureEnabled(false)\r\n          router.push('/admin')\r\n          return\r\n        }\r\n      } catch (error) {\r\n        console.error('Error checking feature access:', error)\r\n        setFeatureEnabled(false)\r\n        toast.error('Unable to verify feature access')\r\n        router.push('/admin')\r\n      } finally {\r\n        setIsLoading(false)\r\n      }\r\n    }\r\n\r\n    if (status !== 'loading' && session) {\r\n      checkFeatureAccess()\r\n    }\r\n  }, [status, session, router, featureName, featureDisplayName])\r\n\r\n  // Show loading state while checking\r\n  if (status === 'loading' || isLoading || featureEnabled === null) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // If feature is disabled, show nothing (will redirect)\r\n  if (!featureEnabled) {\r\n    return null\r\n  }\r\n\r\n  // Feature is enabled - render children\r\n  return <>{children}</>\r\n}\r\n"],"names":[],"mappings":";;0DAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,QAQe,SAAS,EAAkB,aACxC,CAAW,oBACX,CAAkB,UAClB,CAAQ,CACe,EACvB,GAAM,CAAE,KAAM,CAAO,CAAE,QAAM,CAAE,CAAG,CAAA,EAAA,EAAA,UAAA,AAAU,IACtC,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiB,MAC/D,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,SAwC3C,CAtCA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAqB,UACzB,GAAI,CAEF,IAAM,EAAW,MAAM,MAAM,yBAC7B,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAO,MAAM,EAAS,IAAI,GAC1B,EAAY,EAAK,QAAQ,EAAE,SAAS,GAG1C,GAFA,EAAkB,GAEd,CAAC,EAAW,CAEd,EAAA,OAAK,CAAC,KAAK,CAAC,CAAA,EAAG,EAAmB,yBAAyB,CAAC,EAC5D,EAAO,IAAI,CAAC,UACZ,MACF,CACF,KAAO,CAEL,GAAkB,GAClB,EAAO,IAAI,CAAC,UACZ,MACF,CACF,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,iCAAkC,GAChD,GAAkB,GAClB,EAAA,OAAK,CAAC,KAAK,CAAC,mCACZ,EAAO,IAAI,CAAC,SACd,QAAU,CACR,GAAa,EACf,CACF,EAEe,YAAX,GAAwB,GAC1B,GAEJ,EAAG,CAHoC,AAGnC,EAAQ,EAAS,EAAQ,EAAa,EAAmB,EAG9C,YAAX,GAAwB,GAAgC,MAAM,CAAzB,GAErC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2EACf,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8BAAqB,oBAOrC,EAKE,CAAA,EAAA,EAAA,GAAA,EAAA,EAAA,EALc,MAKd,CAAA,UAAG,IAJD,IAKX","debug_id":"f37dae80-e87b-51c0-abb9-6ad664f5c713"}