module.exports=[648187,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(238246),f=a.i(699570),g=a.i(591119),h=a.i(786304),i=a.i(866718),j=a.i(870430),k=a.i(429246),l=a.i(206015),m=a.i(814574),n=a.i(596221),o=a.i(400210),p=a.i(284505),q=a.i(992258),r=a.i(824569),s=a.i(915618),t=a.i(406704),u=a.i(901359);function v({params:a}){let{id:v}=(0,c.use)(a),w=(0,d.useRouter)(),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!0),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)({amount:"",paymentDate:new Date().toISOString().split("T")[0],paymentMethod:"cash",transactionId:"",referenceNumber:"",notes:""});(0,c.useEffect)(()=>{L()},[v]);let L=async()=>{try{A(!0);let a=await fetch(`/api/invoices/${v}`);if(a.ok){let b=await a.json();y(b)}else t.default.error("Failed to fetch invoice"),w.push("/admin/invoices")}catch(a){console.error("Error fetching invoice:",a),t.default.error("An error occurred")}finally{A(!1)}},M=async()=>{try{let a=await fetch(`/api/invoices/${v}/download`);if(a.ok){let b=await a.blob(),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`invoice-${x?.invoiceNumber}.pdf`,document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(c),document.body.removeChild(d),t.default.success("Invoice downloaded")}else t.default.error("Failed to download invoice")}catch(a){console.error("Error downloading invoice:",a),t.default.error("Failed to download invoice")}},N=async a=>{try{(await fetch(`/api/invoices/${v}/send`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})})).ok?(t.default.success("Invoice sent successfully"),I(!1),L()):t.default.error("Failed to send invoice")}catch(a){console.error("Error sending invoice:",a),t.default.error("Failed to send invoice")}},O=async()=>{try{(await fetch(`/api/invoices/${v}/payments`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...J,amount:parseFloat(J.amount)})})).ok?(t.default.success("Payment recorded successfully"),G(!1),K({amount:"",paymentDate:new Date().toISOString().split("T")[0],paymentMethod:"cash",transactionId:"",referenceNumber:"",notes:""}),L()):t.default.error("Failed to record payment")}catch(a){console.error("Error recording payment:",a),t.default.error("Failed to record payment")}};if(z)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)(n.Loader2,{className:"h-8 w-8 animate-spin text-gray-600"})});if(!x)return(0,b.jsx)("div",{className:"container mx-auto py-8",children:(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)("p",{className:"text-gray-600",children:"Invoice not found"}),(0,b.jsx)(e.default,{href:"/admin/invoices",children:(0,b.jsx)(f.Button,{className:"mt-4",children:"Back to Invoices"})})]})})});let P="string"==typeof x.billingAddress?JSON.parse(x.billingAddress):x.billingAddress;return(0,b.jsxs)("div",{className:"container mx-auto py-8 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(e.default,{href:"/admin/invoices",children:(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",children:[(0,b.jsx)(o.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back"]})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold",children:["Invoice ",x.invoiceNumber]}),(0,b.jsxs)("p",{className:"text-gray-600 mt-1",children:["Created ",new Date(x.createdAt).toLocaleDateString()]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(h.Badge,{className:{DRAFT:"bg-gray-100 text-gray-800",SENT:"bg-blue-100 text-blue-800",VIEWED:"bg-purple-100 text-purple-800",PAID:"bg-green-100 text-green-800",PARTIALLY_PAID:"bg-yellow-100 text-yellow-800",OVERDUE:"bg-red-100 text-red-800",CANCELLED:"bg-gray-100 text-gray-800",REFUNDED:"bg-orange-100 text-orange-800"}[x.status]||"bg-gray-100 text-gray-800",children:x.status.replace("_"," ")}),(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>E(!D),children:[(0,b.jsx)(r.Edit,{className:"mr-2 h-4 w-4"}),D?"Cancel":"Edit"]}),(0,b.jsxs)(f.Button,{variant:"outline",onClick:M,children:[(0,b.jsx)(p.Download,{className:"mr-2 h-4 w-4"}),"Download"]}),(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>I(!0),children:[(0,b.jsx)(q.Mail,{className:"mr-2 h-4 w-4"}),"Send"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Invoice Details"})}),(0,b.jsx)(g.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Invoice Number"}),(0,b.jsx)("p",{className:"font-medium",children:x.invoiceNumber})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Invoice Type"}),(0,b.jsx)("p",{className:"font-medium",children:x.invoiceType})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Invoice Date"}),(0,b.jsx)("p",{children:new Date(x.invoiceDate).toLocaleDateString()})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Due Date"}),(0,b.jsx)("p",{children:x.dueDate?new Date(x.dueDate).toLocaleDateString():"Not set"})]})]})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Items"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{children:(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableHead,{children:"Description"}),(0,b.jsx)(l.TableHead,{children:"SKU"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Quantity"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Unit Price"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Total"})]})}),(0,b.jsx)(l.TableBody,{children:x.items?.map(a=>(0,b.jsxs)(l.TableRow,{children:[(0,b.jsx)(l.TableCell,{children:a.description}),(0,b.jsx)(l.TableCell,{children:a.sku||"-"}),(0,b.jsx)(l.TableCell,{className:"text-right",children:a.quantity}),(0,b.jsx)(l.TableCell,{className:"text-right",children:(0,u.formatCurrencyWithSymbol)(a.unitPrice,x.currencySymbol)}),(0,b.jsx)(l.TableCell,{className:"text-right",children:(0,u.formatCurrencyWithSymbol)(a.total,x.currencySymbol)})]},a.id))})]})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Summary"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Subtotal:"}),(0,b.jsx)("span",{children:(0,u.formatCurrencyWithSymbol)(x.subtotal,x.currencySymbol)})]}),x.tax>0&&(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Tax:"}),(0,b.jsx)("span",{children:(0,u.formatCurrencyWithSymbol)(x.tax,x.currencySymbol)})]}),x.shipping>0&&(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Shipping:"}),(0,b.jsx)("span",{children:(0,u.formatCurrencyWithSymbol)(x.shipping,x.currencySymbol)})]}),x.discount>0&&(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Discount:"}),(0,b.jsxs)("span",{children:["-",(0,u.formatCurrencyWithSymbol)(x.discount,x.currencySymbol)]})]}),(0,b.jsxs)("div",{className:"flex justify-between font-bold text-lg pt-2 border-t",children:[(0,b.jsx)("span",{children:"Total:"}),(0,b.jsx)("span",{children:(0,u.formatCurrencyWithSymbol)(x.total,x.currencySymbol)})]}),x.amountPaid>0&&(0,b.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,b.jsx)("span",{children:"Amount Paid:"}),(0,b.jsx)("span",{children:(0,u.formatCurrencyWithSymbol)(x.amountPaid,x.currencySymbol)})]}),x.balanceDue>0&&(0,b.jsxs)("div",{className:"flex justify-between text-red-600 font-bold",children:[(0,b.jsx)("span",{children:"Balance Due:"}),(0,b.jsx)("span",{children:(0,u.formatCurrencyWithSymbol)(x.balanceDue,x.currencySymbol)})]})]})})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Customer"})}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[x.customerName&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Name"}),(0,b.jsx)("p",{children:x.customerName})]}),x.customerEmail&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Email"}),(0,b.jsx)("p",{children:x.customerEmail})]}),P&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Billing Address"}),(0,b.jsxs)("div",{className:"text-sm",children:[P.address1&&(0,b.jsx)("p",{children:P.address1}),P.address2&&(0,b.jsx)("p",{children:P.address2}),(0,b.jsxs)("p",{children:[P.city,P.state&&`, ${P.state}`,P.postalCode&&` ${P.postalCode}`]}),P.country&&(0,b.jsx)("p",{children:P.country})]})]})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Payments"})}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[x.payments&&x.payments.length>0?(0,b.jsx)("div",{className:"space-y-2",children:x.payments.map(a=>(0,b.jsxs)("div",{className:"border rounded p-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:(0,u.formatCurrencyWithSymbol)(a.amount,x.currencySymbol)}),(0,b.jsx)("span",{className:"text-sm text-gray-500",children:new Date(a.paymentDate).toLocaleDateString()})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:a.paymentMethod})]},a.id))}):(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"No payments recorded"}),(0,b.jsxs)(f.Button,{className:"w-full",variant:"outline",onClick:()=>G(!0),children:[(0,b.jsx)(s.Plus,{className:"mr-2 h-4 w-4"}),"Record Payment"]})]})]}),x.notes&&(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Notes"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("p",{className:"text-sm",children:x.notes})})]})]})]}),(0,b.jsx)(m.Dialog,{open:F,onOpenChange:G,children:(0,b.jsxs)(m.DialogContent,{children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{children:"Record Payment"}),(0,b.jsx)(m.DialogDescription,{children:"Record a payment for this invoice"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Amount"}),(0,b.jsx)(i.Input,{type:"number",step:"0.01",value:J.amount,onChange:a=>K({...J,amount:a.target.value}),placeholder:"0.00"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Payment Date"}),(0,b.jsx)(i.Input,{type:"date",value:J.paymentDate,onChange:a=>K({...J,paymentDate:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Payment Method"}),(0,b.jsx)(i.Input,{value:J.paymentMethod,onChange:a=>K({...J,paymentMethod:a.target.value}),placeholder:"cash, card, bank transfer, etc."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Transaction ID (Optional)"}),(0,b.jsx)(i.Input,{value:J.transactionId,onChange:a=>K({...J,transactionId:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Reference Number (Optional)"}),(0,b.jsx)(i.Input,{value:J.referenceNumber,onChange:a=>K({...J,referenceNumber:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Notes (Optional)"}),(0,b.jsx)(k.Textarea,{value:J.notes,onChange:a=>K({...J,notes:a.target.value}),rows:3})]})]}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>G(!1),children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:O,children:"Record Payment"})]})]})}),(0,b.jsx)(m.Dialog,{open:H,onOpenChange:I,children:(0,b.jsxs)(m.DialogContent,{children:[(0,b.jsxs)(m.DialogHeader,{children:[(0,b.jsx)(m.DialogTitle,{children:"Send Invoice"}),(0,b.jsx)(m.DialogDescription,{children:"Send this invoice via email to the customer"})]}),(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{children:"Email Address"}),(0,b.jsx)(i.Input,{type:"email",value:x.customerEmail||"",readOnly:!0,placeholder:"Customer email"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Invoice will be sent to this email address"})]})}),(0,b.jsxs)(m.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>I(!1),children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:()=>N(),children:"Send Invoice"})]})]})})]})}a.s(["default",()=>v])}];

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="cbd17e6e-79fb-5868-9469-2a083048b643")}catch(e){}}();
//# sourceMappingURL=src_app_admin_%28protected%29_invoices_%5Bid%5D_page_tsx_7bc3dfd6._.js.map
//# debugId=cbd17e6e-79fb-5868-9469-2a083048b643
