module.exports=[60365,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(699570),e=a.i(591119),f=a.i(866718),g=a.i(870430),h=a.i(284505),i=a.i(941675),j=a.i(790166),k=a.i(940784),l=a.i(660246),m=a.i(669520),n=a.i(839761),o=a.i(406704),p=a.i(256711),q=a.i(42724),r=a.i(774016);function s(a,b,c){var d;let e;return d=-b,e=(0,r.toDate)(a,c?.in),isNaN(d)?(0,q.constructFrom)(c?.in||a,NaN):(d&&e.setDate(e.getDate()+d),e)}function t(a,b){let c=(0,r.toDate)(a,b?.in);return c.setDate(1),c.setHours(0,0,0,0),c}var u=a.i(322658);function v(){let[a,q]=(0,c.useState)({from:(0,p.format)(s(new Date,7),"yyyy-MM-dd"),to:(0,p.format)(new Date,"yyyy-MM-dd")}),[r,v]=(0,c.useState)(null),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)([]),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(null),G=[{label:"Today",from:(0,p.format)(new Date,"yyyy-MM-dd"),to:(0,p.format)(new Date,"yyyy-MM-dd")},{label:"Last 7 Days",from:(0,p.format)(s(new Date,7),"yyyy-MM-dd"),to:(0,p.format)(new Date,"yyyy-MM-dd")},{label:"Last 30 Days",from:(0,p.format)(s(new Date,30),"yyyy-MM-dd"),to:(0,p.format)(new Date,"yyyy-MM-dd")},{label:"This Month",from:(0,p.format)(t(new Date),"yyyy-MM-dd"),to:(0,p.format)((0,u.endOfMonth)(new Date),"yyyy-MM-dd")},{label:"Last Month",from:(0,p.format)(t(s(new Date,30)),"yyyy-MM-dd"),to:(0,p.format)((0,u.endOfMonth)(s(new Date,30)),"yyyy-MM-dd")}];(0,c.useEffect)(()=>{H()},[a]);let H=async()=>{D(!0),F(null);try{let b=new URLSearchParams({dateFrom:a.from,dateTo:a.to}),c=new URLSearchParams({startDate:a.from,endDate:a.to}),d=await fetch(`/api/pos/analytics/sales?${c.toString()}`);if(d.ok){let a=await d.json();v({totalSales:a.totalSales||0,totalOrders:a.totalOrders||0,averageOrderValue:a.averageOrderValue||0,salesByDate:a.salesByDate||[]})}else{let a=await d.json().catch(()=>({}));throw Error(a.error||"Failed to fetch sales data")}let e=new URLSearchParams({startDate:a.from,endDate:a.to,limit:"10"}),f=await fetch(`/api/pos/analytics/top-products?${e.toString()}`);if(f.ok){let a=await f.json();x(a||[])}else{let a=await f.json().catch(()=>({}));console.error("Failed to fetch top products:",a)}let g=await fetch(`/api/pos/orders?${b.toString()}`);if(g.ok){let a=(await g.json()).orders||[],b=new Map;a.forEach(a=>{if(a.cashier&&a.orderId){let c=a.cashier.id,d=a.cashier.user?.name||"Unknown",e=b.get(c)||{name:d,sales:0,orders:0};b.set(c,{name:d,sales:e.sales+a.total,orders:e.orders+1})}});let c=Array.from(b.entries()).map(([a,b])=>({cashierId:a,cashierName:b.name,totalSales:b.sales,totalOrders:b.orders,averageOrderValue:b.orders>0?b.sales/b.orders:0}));z(c);let d=new Map;a.forEach(a=>{if(a.orderId){let b=a.paymentMethod,c=d.get(b)||{count:0,total:0};d.set(b,{count:c.count+1,total:c.total+a.total})}});let e=Array.from(d.values()).reduce((a,b)=>a+b.total,0),f=Array.from(d.entries()).map(([a,b])=>({method:a,count:b.count,total:b.total,percentage:e>0?b.total/e*100:0}));B(f)}}catch(b){console.error("Error fetching reports:",b);let a=b?.message||"Failed to load reports";F(a),o.default.error(a)}finally{D(!1)}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"POS Reports"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Sales analytics and performance metrics"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(d.Button,{onClick:H,variant:"outline",disabled:C,children:[(0,b.jsx)(m.RefreshCw,{className:`h-4 w-4 mr-2 ${C?"animate-spin":""}`}),"Refresh"]}),(0,b.jsxs)(d.Button,{onClick:()=>{let a=[];a.push(["Sales Summary"]),a.push(["Total Sales",`$${r?.totalSales.toFixed(2)||"0.00"}`]),a.push(["Total Orders",r?.totalOrders.toString()||"0"]),a.push(["Average Order Value",`$${r?.averageOrderValue.toFixed(2)||"0.00"}`]),a.push([]),a.push(["Top Products"]),a.push(["Product Name","Quantity","Revenue"]),w.forEach(b=>{a.push([b.productName,b.quantity.toString(),`$${b.revenue.toFixed(2)}`])}),a.push([]),a.push(["Cashier Performance"]),a.push(["Cashier Name","Total Sales","Total Orders","Average Order Value"]),y.forEach(b=>{a.push([b.cashierName,`$${b.totalSales.toFixed(2)}`,b.totalOrders.toString(),`$${b.averageOrderValue.toFixed(2)}`])});let b=new Blob([a.map(a=>a.map(a=>`"${a}"`).join(",")).join("\n")],{type:"text/csv"}),c=window.URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`pos-reports-${(0,p.format)(new Date,"yyyy-MM-dd")}.csv`,d.click(),window.URL.revokeObjectURL(c),o.default.success("Reports exported to CSV")},variant:"outline",disabled:!r,children:[(0,b.jsx)(h.Download,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Date Range"}),(0,b.jsx)(e.CardDescription,{children:"Select the period for your reports"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:G.map(c=>(0,b.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>{q({from:c.from,to:c.to})},className:a.from===c.from&&a.to===c.to?"bg-primary text-primary-foreground":"",children:c.label},c.label))}),(0,b.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(g.Label,{htmlFor:"dateFrom",children:"From Date"}),(0,b.jsx)(f.Input,{id:"dateFrom",type:"date",value:a.from,onChange:b=>q({...a,from:b.target.value}),className:"mt-1"})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(g.Label,{htmlFor:"dateTo",children:"To Date"}),(0,b.jsx)(f.Input,{id:"dateTo",type:"date",value:a.to,onChange:b=>q({...a,to:b.target.value}),className:"mt-1"})]}),(0,b.jsxs)(d.Button,{onClick:H,disabled:C,children:[(0,b.jsx)(i.Calendar,{className:"h-4 w-4 mr-2"}),"Update"]})]})]})})]}),E&&(0,b.jsx)(e.Card,{className:"border-destructive",children:(0,b.jsx)(e.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"text-center text-destructive",children:[(0,b.jsx)("p",{className:"font-semibold",children:"Error loading reports"}),(0,b.jsx)("p",{className:"text-sm mt-1",children:E})]})})}),C?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[1,2,3].map(a=>(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{className:"space-y-0 pb-2",children:(0,b.jsx)("div",{className:"h-4 w-24 bg-muted animate-pulse rounded"})}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"h-8 w-32 bg-muted animate-pulse rounded mb-2"}),(0,b.jsx)("div",{className:"h-3 w-20 bg-muted animate-pulse rounded"})]})]},a))}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)("div",{className:"h-6 w-32 bg-muted animate-pulse rounded"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-2",children:[1,2,3].map(a=>(0,b.jsx)("div",{className:"h-16 bg-muted animate-pulse rounded"},a))})})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Total Sales"}),(0,b.jsx)(j.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:["$",r?.totalSales.toFixed(2)||"0.00"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[r?.totalOrders||0," orders"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Total Orders"}),(0,b.jsx)(k.ShoppingBag,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:r?.totalOrders||0}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Average: $",r?.averageOrderValue.toFixed(2)||"0.00"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Active Cashiers"}),(0,b.jsx)(l.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:y.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Performance tracked"})]})]})]}),r&&r.salesByDate.length>0&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(n.BarChart3,{className:"h-5 w-5"}),"Sales Trend"]}),(0,b.jsx)(e.CardDescription,{children:"Daily sales breakdown"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:r.salesByDate.sort((a,b)=>a.date.localeCompare(b.date)).map(a=>{let c=Math.max(...r.salesByDate.map(a=>a.sales)),d=c>0?a.sales/c*100:0;return(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"font-medium",children:(0,p.format)(new Date(a.date),"MMM dd, yyyy")}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:["$",a.sales.toFixed(2)," • ",a.orders," orders"]})]}),(0,b.jsx)("div",{className:"w-full bg-muted rounded-full h-3",children:(0,b.jsx)("div",{className:"bg-primary h-3 rounded-full transition-all",style:{width:`${d}%`}})})]},a.date)})})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Top Products"}),(0,b.jsx)(e.CardDescription,{children:"Best selling products by revenue"})]}),(0,b.jsx)(e.CardContent,{children:0===w.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(k.ShoppingBag,{className:"h-12 w-12 text-muted-foreground mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-muted-foreground font-medium",children:"No products sold in this period"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Try selecting a different date range"})]}):(0,b.jsx)("div",{className:"space-y-2",children:w.slice(0,10).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center font-bold",children:c+1}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",children:a.productName}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.quantity," units sold"]})]})]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsxs)("p",{className:"font-bold text-lg",children:["$",a.revenue.toFixed(2)]})})]},a.productId))})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Cashier Performance"}),(0,b.jsx)(e.CardDescription,{children:"Sales performance by cashier"})]}),(0,b.jsx)(e.CardContent,{children:0===y.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(l.Users,{className:"h-12 w-12 text-muted-foreground mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-muted-foreground font-medium",children:"No cashier data available"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"No orders processed by cashiers in this period"})]}):(0,b.jsx)("div",{className:"space-y-2",children:y.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",children:a.cashierName}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.totalOrders," orders"]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"font-bold text-lg",children:["$",a.totalSales.toFixed(2)]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Avg: $",a.averageOrderValue.toFixed(2)]})]})]},a.cashierId))})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Payment Methods"}),(0,b.jsx)(e.CardDescription,{children:"Breakdown by payment type"})]}),(0,b.jsx)(e.CardContent,{children:0===A.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(j.DollarSign,{className:"h-12 w-12 text-muted-foreground mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{className:"text-muted-foreground font-medium",children:"No payment data available"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"No payment transactions in this period"})]}):(0,b.jsx)("div",{className:"space-y-3",children:A.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsx)("span",{className:"font-semibold capitalize",children:a.method.replace("_"," ")}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.count," transactions • $",a.total.toFixed(2)," (",a.percentage.toFixed(1),"%)"]})]}),(0,b.jsx)("div",{className:"w-full bg-muted rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-primary h-2 rounded-full",style:{width:`${a.percentage}%`}})})]},a.method))})})]})]})]})}a.s(["default",()=>v],60365)}];

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2de43dd4-38fd-58ad-81a1-4358c1e2e308")}catch(e){}}();
//# sourceMappingURL=src_app_admin_%28protected%29_pos_reports_page_tsx_362dad0a._.js.map
//# debugId=2de43dd4-38fd-58ad-81a1-4358c1e2e308
