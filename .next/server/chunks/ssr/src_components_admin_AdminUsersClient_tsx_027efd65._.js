
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="474218ce-404d-5c8f-8178-9b52e9b553d3")}catch(e){}}();
module.exports=[820790,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(699570),e=a.i(866718),f=a.i(206015),g=a.i(580701),h=a.i(786304),i=a.i(915618),j=a.i(587532),k=a.i(781560),l=a.i(824569),m=a.i(603314),n=a.i(814574),o=a.i(870430),p=a.i(124348),q=a.i(797063),r=a.i(406704);let s={SUPERADMIN:["PRODUCT:MANAGE","ORDER:MANAGE","CUSTOMER:MANAGE","CATEGORY:MANAGE","REVIEW:MANAGE","DISCOUNT:MANAGE","SETTINGS:MANAGE","ANALYTICS:MANAGE","FEATURES:MANAGE","ADMIN_USER:MANAGE","STOCK_ALERT:MANAGE","NEWSLETTER:MANAGE","REFUND:MANAGE","INVENTORY:MANAGE","SUPPLIER:MANAGE","PURCHASE_ORDER:MANAGE"],ADMIN:["PRODUCT:MANAGE","ORDER:MANAGE","CUSTOMER:MANAGE","CATEGORY:MANAGE","REVIEW:MANAGE","DISCOUNT:MANAGE","SETTINGS:MANAGE","ANALYTICS:MANAGE","ADMIN_USER:MANAGE","STOCK_ALERT:MANAGE","NEWSLETTER:MANAGE","REFUND:MANAGE","INVENTORY:MANAGE","SUPPLIER:MANAGE","PURCHASE_ORDER:MANAGE"],MANAGER:["ORDER:MANAGE","CUSTOMER:VIEW","CUSTOMER:UPDATE","PRODUCT:VIEW","PRODUCT:UPDATE","PRODUCT:CREATE","CATEGORY:VIEW","REVIEW:VIEW","REVIEW:UPDATE","STOCK_ALERT:VIEW","REFUND:VIEW","REFUND:UPDATE","INVENTORY:MANAGE","SUPPLIER:VIEW","PURCHASE_ORDER:MANAGE"],EDITOR:["PRODUCT:VIEW","PRODUCT:CREATE","PRODUCT:UPDATE","CATEGORY:MANAGE","REVIEW:VIEW","STOCK_ALERT:VIEW"],SUPPORT:["ORDER:VIEW","CUSTOMER:VIEW","PRODUCT:VIEW","CATEGORY:VIEW","REVIEW:VIEW","REFUND:VIEW"],VIEWER:["PRODUCT:VIEW","ORDER:VIEW","CUSTOMER:VIEW","CATEGORY:VIEW","REVIEW:VIEW","DISCOUNT:VIEW","ANALYTICS:VIEW","STOCK_ALERT:VIEW","NEWSLETTER:VIEW","REFUND:VIEW"],CUSTOMER:[]};function t(a,b,c){if(!a)return!1;if("SUPERADMIN"===a)return!0;let d=s[a]||[],e=`${b}:${c}`;if(d.includes(e))return!0;let f=`${b}:MANAGE`;return!!(d.includes(f)&&["VIEW","CREATE","UPDATE","DELETE"].includes(c))}let u=[{value:"ADMIN",label:"Admin",description:"Full access except feature management"},{value:"MANAGER",label:"Manager",description:"Manage orders, customers, and products"},{value:"EDITOR",label:"Editor",description:"Edit products and categories"},{value:"SUPPORT",label:"Support",description:"View orders and customers"},{value:"VIEWER",label:"Viewer",description:"Read-only access"}],v={value:"SUPERADMIN",label:"Super Admin",description:"Full access including feature management"};function w({open:a,onOpenChange:f,onUserSaved:i,editingUser:j,currentUserRole:k}){let[l,t]=(0,c.useState)(!1),[w,x]=(0,c.useState)({name:"",email:"",role:"MANAGER",password:"",confirmPassword:""}),[y,z]=(0,c.useState)([]),A=!!j,B="SUPERADMIN"===k?[v,...u]:u;(0,c.useEffect)(()=>{j?x({name:j.name||"",email:j.email,role:j.role,password:"",confirmPassword:""}):x({name:"",email:"",role:"MANAGER",password:"",confirmPassword:""})},[j,a]),(0,c.useEffect)(()=>{let a,b;z((a=s[w.role]||[],b={},a.forEach(a=>{let[c,d]=a.split(":");b[c]||(b[c]=new Set),"MANAGE"===d?(b[c].add("VIEW"),b[c].add("CREATE"),b[c].add("UPDATE"),b[c].add("DELETE"),b[c].add("MANAGE")):b[c].add(d)}),Object.entries(b).map(([a,b])=>({resource:a,actions:Array.from(b).sort()}))))},[w.role]);let C=async a=>{a.preventDefault(),t(!0);try{if(!A&&!w.password){r.default.error("Password is required"),t(!1);return}if(!A&&w.password!==w.confirmPassword){r.default.error("Passwords do not match"),t(!1);return}if(!A&&w.password.length<8){r.default.error("Password must be at least 8 characters"),t(!1);return}let a={name:w.name,email:w.email,role:w.role};A||(a.password=w.password);let b=A?`/api/admin/users/${j.id}`:"/api/admin/users",c=await fetch(b,{method:A?"PATCH":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!c.ok){let a=await c.json();throw Error(a.error||"Failed to save user")}r.default.success(A?"Admin user updated successfully":"Admin user created successfully"),i()}catch(a){console.error("Error saving user:",a),r.default.error(a.message||"Failed to save admin user")}finally{t(!1)}};return(0,b.jsx)(n.Dialog,{open:a,onOpenChange:f,children:(0,b.jsxs)(n.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(n.DialogHeader,{children:[(0,b.jsx)(n.DialogTitle,{children:A?"Edit Admin User":"Add New Admin User"}),(0,b.jsx)(n.DialogDescription,{children:A?"Update admin user information and role":"Create a new admin user with specific role and permissions"})]}),(0,b.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(o.Label,{htmlFor:"name",children:"Name"}),(0,b.jsx)(e.Input,{id:"name",value:w.name,onChange:a=>x({...w,name:a.target.value}),placeholder:"John Doe"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(o.Label,{htmlFor:"email",children:["Email ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(e.Input,{id:"email",type:"email",value:w.email,onChange:a=>x({...w,email:a.target.value}),placeholder:"admin@example.com",required:!0,disabled:A})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(o.Label,{htmlFor:"role",children:["Role ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsxs)(g.Select,{value:w.role,onValueChange:a=>x({...w,role:a}),children:[(0,b.jsx)(g.SelectTrigger,{children:(0,b.jsx)(g.SelectValue,{})}),(0,b.jsx)(g.SelectContent,{children:B.map(a=>(0,b.jsx)(g.SelectItem,{value:a.value,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Shield,{className:"h-4 w-4"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.label}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.description})]})]})},a.value))})]})]}),y.length>0&&(0,b.jsxs)(p.Alert,{children:[(0,b.jsx)(q.Info,{className:"h-4 w-4"}),(0,b.jsxs)(p.AlertDescription,{children:[(0,b.jsx)("div",{className:"font-medium mb-2",children:"Role Permissions:"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[y.slice(0,5).map(a=>(0,b.jsxs)(h.Badge,{variant:"secondary",className:"text-xs",children:[a.resource,": ",a.actions.join(", ")]},a.resource)),y.length>5&&(0,b.jsxs)(h.Badge,{variant:"secondary",className:"text-xs",children:["+",y.length-5," more"]})]})]})]}),!A&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(o.Label,{htmlFor:"password",children:["Password ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(e.Input,{id:"password",type:"password",value:w.password,onChange:a=>x({...w,password:a.target.value}),placeholder:"Min. 8 characters",required:!0,minLength:8})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(o.Label,{htmlFor:"confirmPassword",children:["Confirm Password ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(e.Input,{id:"confirmPassword",type:"password",value:w.confirmPassword,onChange:a=>x({...w,confirmPassword:a.target.value}),placeholder:"Re-enter password",required:!0})]})]}),(0,b.jsxs)(n.DialogFooter,{children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>f(!1),disabled:l,children:"Cancel"}),(0,b.jsx)(d.Button,{type:"submit",disabled:l,children:l?"Saving...":A?"Update User":"Create User"})]})]})]})})}let x={SUPERADMIN:"bg-purple-500/10 text-purple-500 border-purple-500/20",ADMIN:"bg-blue-500/10 text-blue-500 border-blue-500/20",MANAGER:"bg-green-500/10 text-green-500 border-green-500/20",EDITOR:"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",SUPPORT:"bg-orange-500/10 text-orange-500 border-orange-500/20",VIEWER:"bg-gray-500/10 text-gray-500 border-gray-500/20"},y={SUPERADMIN:"Full access including feature management",ADMIN:"Full access except feature management",MANAGER:"Manage orders, customers, and products",EDITOR:"Edit products and categories",SUPPORT:"View orders and customers",VIEWER:"Read-only access"};function z({currentUserRole:a}){let[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!0),[s,u]=(0,c.useState)(""),[v,z]=(0,c.useState)("all"),[A,B]=(0,c.useState)(1),[C,D]=(0,c.useState)(0),[E,F]=(0,c.useState)(0),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(null),K=t(a,"ADMIN_USER","CREATE"),L=t(a,"ADMIN_USER","UPDATE"),M=t(a,"ADMIN_USER","DELETE"),N=async()=>{try{q(!0);let a=new URLSearchParams({page:A.toString(),limit:"10"});s&&a.append("search",s),"all"!==v&&a.append("role",v);let b=await fetch(`/api/admin/users?${a}`);if(!b.ok)throw Error("Failed to fetch users");let c=await b.json();o(c.users),D(c.total),F(c.totalPages)}catch(a){console.error("Error fetching users:",a),r.default.error("Failed to load admin users")}finally{q(!1)}};(0,c.useEffect)(()=>{N()},[A,v]);let O=()=>{B(1),N()},P=async a=>{if(confirm("Are you sure you want to delete this admin user?"))try{let b=await fetch(`/api/admin/users/${a}`,{method:"DELETE"});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to delete user")}r.default.success("Admin user deleted successfully"),N()}catch(a){console.error("Error deleting user:",a),r.default.error(a.message||"Failed to delete admin user")}},Q=()=>{H(!1),J(null)};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{className:"flex flex-1 gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,b.jsx)(j.Search,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(e.Input,{placeholder:"Search by name or email...",className:"pl-8",value:s,onChange:a=>u(a.target.value),onKeyDown:a=>"Enter"===a.key&&O()})]}),(0,b.jsx)(d.Button,{onClick:O,variant:"secondary",children:"Search"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(g.Select,{value:v,onValueChange:z,children:[(0,b.jsx)(g.SelectTrigger,{className:"w-[180px]",children:(0,b.jsx)(g.SelectValue,{placeholder:"Filter by role"})}),(0,b.jsxs)(g.SelectContent,{children:[(0,b.jsx)(g.SelectItem,{value:"all",children:"All Roles"}),(0,b.jsx)(g.SelectItem,{value:"SUPERADMIN",children:"Super Admin"}),(0,b.jsx)(g.SelectItem,{value:"ADMIN",children:"Admin"}),(0,b.jsx)(g.SelectItem,{value:"MANAGER",children:"Manager"}),(0,b.jsx)(g.SelectItem,{value:"EDITOR",children:"Editor"}),(0,b.jsx)(g.SelectItem,{value:"SUPPORT",children:"Support"}),(0,b.jsx)(g.SelectItem,{value:"VIEWER",children:"Viewer"})]})]}),K&&(0,b.jsxs)(d.Button,{onClick:()=>H(!0),children:[(0,b.jsx)(i.Plus,{className:"h-4 w-4 mr-2"}),"Add Admin User"]})]})]})}),(0,b.jsxs)("div",{className:"rounded-md border",children:[(0,b.jsxs)(f.Table,{children:[(0,b.jsx)(f.TableHeader,{children:(0,b.jsxs)(f.TableRow,{children:[(0,b.jsx)(f.TableHead,{children:"User"}),(0,b.jsx)(f.TableHead,{children:"Role"}),(0,b.jsx)(f.TableHead,{children:"Status"}),(0,b.jsx)(f.TableHead,{children:"Created"}),(L||M)&&(0,b.jsx)(f.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(f.TableBody,{children:p?(0,b.jsx)(f.TableRow,{children:(0,b.jsx)(f.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"Loading..."})}):0===n.length?(0,b.jsx)(f.TableRow,{children:(0,b.jsx)(f.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No admin users found"})}):n.map(a=>(0,b.jsxs)(f.TableRow,{children:[(0,b.jsx)(f.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium",children:a.name||"No name"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:a.email})]})}),(0,b.jsx)(f.TableCell,{children:(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)(h.Badge,{className:x[a.role]||"",variant:"outline",children:[(0,b.jsx)(m.Shield,{className:"h-3 w-3 mr-1"}),a.role]}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:y[a.role]})]})}),(0,b.jsx)(f.TableCell,{children:a.emailVerified?(0,b.jsx)(h.Badge,{variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/20",children:"Verified"}):(0,b.jsx)(h.Badge,{variant:"outline",className:"bg-yellow-500/10 text-yellow-600 border-yellow-500/20",children:"Pending"})}),(0,b.jsx)(f.TableCell,{children:(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:new Date(a.createdAt).toLocaleDateString()})}),(L||M)&&(0,b.jsx)(f.TableCell,{className:"text-right",children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[L&&(0,b.jsx)(d.Button,{variant:"ghost",size:"sm",onClick:()=>{J(a),H(!0)},children:(0,b.jsx)(l.Edit,{className:"h-4 w-4"})}),M&&"SUPERADMIN"!==a.role&&(0,b.jsx)(d.Button,{variant:"ghost",size:"sm",onClick:()=>P(a.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,b.jsx)(k.Trash2,{className:"h-4 w-4"})})]})})]},a.id))})]}),E>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between px-4 py-4 border-t",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",(A-1)*10+1," to ",Math.min(10*A,C)," of ",C," users"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>B(A-1),disabled:1===A,children:"Previous"}),(0,b.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>B(A+1),disabled:A===E,children:"Next"})]})]})]}),(0,b.jsx)(w,{open:G,onOpenChange:Q,onUserSaved:()=>{N(),Q()},editingUser:I,currentUserRole:a})]})}a.s(["AdminUsersClient",()=>z],820790)}];

//# sourceMappingURL=src_components_admin_AdminUsersClient_tsx_027efd65._.js.map
//# debugId=474218ce-404d-5c8f-8178-9b52e9b553d3
