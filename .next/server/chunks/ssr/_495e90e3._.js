
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e763f5ef-312a-5833-822b-575adc159a8b")}catch(e){}}();
module.exports=[648571,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(814574),e=a.i(699570),f=a.i(185135),g=a.i(287470),h=a.i(866718),i=a.i(587532),j=a.i(773320),k=a.i(533441),l=a.i(580701),m=a.i(406704);a.s(["MediaPicker",0,({open:a,onOpenChange:n,onSelect:o,multiple:p=!1,type:q})=>{let[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)("ALL"),D=async()=>{u(!0);try{let a=new URLSearchParams;z&&a.append("search",z);let b=q||("ALL"!==B?B:void 0);b&&a.append("type",b);let c=await fetch(`/api/media?${a.toString()}`),d=await c.json();if(d.error)throw Error(d.error);s(d.media)}catch(a){console.error(a),m.toast.error("Failed to load media")}finally{u(!1)}};(0,c.useEffect)(()=>{a&&(D(),w([]))},[a,z,B]);let E=a=>{p?w(b=>b.find(b=>b.id===a.id)?b.filter(b=>b.id!==a.id):[...b,a]):w([a])};return(0,b.jsx)(d.Dialog,{open:a,onOpenChange:n,children:(0,b.jsxs)(d.DialogContent,{className:"max-w-5xl h-[85vh] flex flex-col p-0 gap-0 overflow-hidden",children:[(0,b.jsx)(d.DialogHeader,{className:"p-4 border-b bg-white z-10",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(d.DialogTitle,{className:"text-xl font-semibold",children:"Media Library"}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)(e.Button,{variant:x?"secondary":"default",size:"sm",onClick:()=>y(!x),children:[(0,b.jsx)(j.Upload,{className:"mr-2 h-4 w-4"}),x?"Back to Library":"Upload New"]})})]})}),(0,b.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col bg-gray-50/50",children:[!x&&(0,b.jsxs)("div",{className:"p-4 border-b bg-white flex flex-col sm:flex-row gap-4 items-center",children:[(0,b.jsxs)("div",{className:"relative flex-1 w-full",children:[(0,b.jsx)(i.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(h.Input,{placeholder:"Search media files...",className:"pl-9 bg-gray-50 border-gray-200 focus:bg-white transition-colors",value:z,onChange:a=>A(a.target.value)})]}),!q&&(0,b.jsx)("div",{className:"w-full sm:w-[200px]",children:(0,b.jsxs)(l.Select,{value:B,onValueChange:C,children:[(0,b.jsx)(l.SelectTrigger,{children:(0,b.jsx)(l.SelectValue,{placeholder:"Filter by type"})}),(0,b.jsxs)(l.SelectContent,{children:[(0,b.jsx)(l.SelectItem,{value:"ALL",children:"All Media"}),(0,b.jsx)(l.SelectItem,{value:"IMAGE",children:"Images"}),(0,b.jsx)(l.SelectItem,{value:"VIDEO",children:"Videos"}),(0,b.jsx)(l.SelectItem,{value:"DOCUMENT",children:"Documents"})]})]})})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:x?(0,b.jsx)(g.MediaUploader,{onUploadComplete:()=>{D(),y(!1),m.toast.success("Upload complete")}}):(0,b.jsx)(f.MediaGrid,{items:r,selectedItems:v.map(a=>a.id),onSelect:a=>E(a),onItemClick:a=>E(a),loading:t})})]}),(0,b.jsxs)("div",{className:"p-4 border-t bg-white flex justify-between items-center z-10",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[v.length," item",1!==v.length&&"s"," selected"]}),v.length>0&&(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>w([]),className:"text-muted-foreground hover:text-foreground",children:"Clear selection"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),(0,b.jsxs)(e.Button,{onClick:()=>{o(v),n(!1)},disabled:0===v.length,className:"px-8",children:[(0,b.jsx)(k.Check,{className:"mr-2 h-4 w-4"}),"Insert Selected"]})]})]})]})})}])},838632,a=>{"use strict";var b=a.i(849625);a.s(["Image",()=>b.default])},816201,a=>{"use strict";var b=a.i(626405);a.s(["CheckCircle",()=>b.default])},773320,a=>{"use strict";var b=a.i(135652);a.s(["Upload",()=>b.default])},482520,(a,b,c)=>{"use strict";b.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},324560,(a,b,c)=>{"use strict";var d=a.r(482520);function e(){}function f(){}f.resetWarningCache=e,b.exports=function(){function a(a,b,c,e,f,g){if(g!==d){var h=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}function b(){return a}a.isRequired=a;var c={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:b,element:a,elementType:a,instanceOf:b,node:a,objectOf:b,oneOf:b,oneOfType:b,shape:b,exact:b,checkPropTypes:f,resetWarningCache:e};return c.PropTypes=c,c}},341212,(a,b,c)=>{b.exports=a.r(324560)()},64791,a=>{"use strict";var b=a.i(835134);a.s(["Video",()=>b.default])},874200,976695,a=>{"use strict";function b(a,c=2){if(!+a)return"0 Bytes";let d=Math.floor(Math.log(a)/Math.log(1024));return`${parseFloat((a/Math.pow(1024,d)).toFixed(c<0?0:c))} ${["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][d]}`}a.s(["formatBytes",()=>b],874200);var c=a.i(833190);a.s(["FileIcon",()=>c.default],976695)},185135,287470,a=>{"use strict";var b=a.i(187924),c=a.i(571987),d=a.i(874200),e=a.i(976695),f=a.i(64791),g=a.i(536658),g=g,h=a.i(104720),i=a.i(533441),j=a.i(368114);let k=({item:a,selected:k,onSelect:l,onClick:m})=>{let n="IMAGE"===a.type;return(0,b.jsxs)("div",{className:(0,j.cn)("group relative aspect-square cursor-pointer rounded-lg border bg-card overflow-hidden transition-all hover:shadow-md",k?"border-primary ring-2 ring-primary ring-offset-2":"border-border"),onClick:b=>{b.stopPropagation(),b.ctrlKey||b.metaKey?l(a,!0):m(a)},children:[(0,b.jsx)("div",{className:(0,j.cn)("absolute left-2 top-2 z-10 flex h-6 w-6 items-center justify-center rounded-full border bg-white transition-opacity",k?"opacity-100 border-primary bg-primary text-primary-foreground":"opacity-0 group-hover:opacity-100 border-gray-300"),onClick:b=>{b.stopPropagation(),l(a,!0)},children:k&&(0,b.jsx)(i.Check,{className:"h-4 w-4"})}),(0,b.jsx)("div",{className:"relative h-full w-full bg-muted/20",children:n&&a.secureUrl?(0,b.jsx)(c.default,{src:a.secureUrl,alt:a.altText||a.filename,fill:!0,className:"object-cover transition-transform group-hover:scale-105",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 20vw"}):(0,b.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center p-4 text-muted-foreground",children:["VIDEO"===a.type&&(0,b.jsx)(f.Video,{className:"h-12 w-12 mb-2"}),"AUDIO"===a.type&&(0,b.jsx)(g.default,{className:"h-12 w-12 mb-2"}),"DOCUMENT"===a.type&&(0,b.jsx)(h.FileText,{className:"h-12 w-12 mb-2"}),"OTHER"===a.type&&(0,b.jsx)(e.FileIcon,{className:"h-12 w-12 mb-2"}),(0,b.jsx)("span",{className:"text-xs font-medium truncate w-full text-center",children:a.filename})]})}),(0,b.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 bg-black/60 p-2 text-white opacity-0 transition-opacity group-hover:opacity-100",children:[(0,b.jsx)("p",{className:"truncate text-xs font-medium",children:a.filename}),(0,b.jsx)("p",{className:"text-[10px] text-gray-300",children:(0,d.formatBytes)(a.fileSize)})]})]})};var l=a.i(596221),m=a.i(849625),m=m,n=a.i(773320),o=a.i(699570);a.s(["MediaGrid",0,({items:a,selectedItems:c,onSelect:d,onItemClick:e,loading:f,onUploadClick:g})=>f&&0===a.length?(0,b.jsx)("div",{className:"flex h-64 w-full items-center justify-center",children:(0,b.jsx)(l.Loader2,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===a.length?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center h-[calc(100vh-350px)] px-4",children:(0,b.jsxs)("div",{className:"w-full max-w-3xl border-2 border-dashed rounded-3xl p-12 flex flex-col items-center justify-center bg-muted/30 hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"relative mb-6 group",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-3xl group-hover:bg-primary/30 transition-all duration-500"}),(0,b.jsx)("div",{className:"relative bg-background rounded-full p-6 shadow-sm ring-1 ring-border group-hover:scale-110 transition-transform duration-500",children:(0,b.jsx)("div",{className:"bg-primary/10 rounded-full p-4",children:(0,b.jsx)(m.default,{className:"h-12 w-12 text-primary",strokeWidth:1.5})})})]}),(0,b.jsx)("h3",{className:"text-2xl font-bold tracking-tight mb-2",children:"No media files yet"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-8 max-w-md text-center text-base",children:"Upload images, videos, or documents to start building your library. Your assets will be available across your entire store."}),(0,b.jsx)("div",{className:"flex items-center gap-4 mb-12",children:g&&(0,b.jsxs)(o.Button,{onClick:g,size:"lg",className:"h-12 px-8 text-base shadow-lg hover:shadow-xl transition-all hover:-translate-y-0.5",children:[(0,b.jsx)(n.Upload,{className:"h-5 w-5 mr-2"}),"Upload Files"]})}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-12 w-full max-w-2xl border-t pt-8",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2 group cursor-default",children:[(0,b.jsx)("div",{className:"p-3 rounded-xl bg-blue-50 dark:bg-blue-950/30 text-blue-600 dark:text-blue-400 group-hover:scale-110 transition-transform",children:(0,b.jsx)(m.default,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h4",{className:"font-semibold text-sm",children:"Images"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:"JPG, PNG, WebP"})]})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2 group cursor-default",children:[(0,b.jsx)("div",{className:"p-3 rounded-xl bg-purple-50 dark:bg-purple-950/30 text-purple-600 dark:text-purple-400 group-hover:scale-110 transition-transform",children:(0,b.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h4",{className:"font-semibold text-sm",children:"Videos"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:"MP4, WebM"})]})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-2 group cursor-default",children:[(0,b.jsx)("div",{className:"p-3 rounded-xl bg-green-50 dark:bg-green-950/30 text-green-600 dark:text-green-400 group-hover:scale-110 transition-transform",children:(0,b.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h4",{className:"font-semibold text-sm",children:"Documents"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:"PDF, DOC, TXT"})]})]})]})]})}):(0,b.jsx)("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6",children:a.map(a=>(0,b.jsx)(k,{item:a,selected:c.includes(a.id),onSelect:d,onClick:e},a.id))})],185135);var p=a.i(572131),q=a.i(866965),r=a.i(633508),s=a.i(816201),t=a.i(292e3),u=a.i(173390);a.s(["MediaUploader",0,({onUploadComplete:a,folderId:c})=>{let[f,g]=(0,p.useState)([]),[h,i]=(0,p.useState)(!1),k=(0,p.useCallback)(a=>{let b=a.map(a=>({file:a,id:Math.random().toString(36).substring(7),progress:0,status:"pending"}));g(a=>[...a,...b])},[]),{getRootProps:l,getInputProps:m,isDragActive:v}=(0,q.useDropzone)({onDrop:k,accept:{"image/*":[],"video/*":[],"audio/*":[],"application/pdf":[]}}),w=async a=>{let b=new FormData;b.append("file",a.file),c&&b.append("folderId",c);try{let c=new XMLHttpRequest;c.upload.onprogress=b=>{if(b.lengthComputable){let c=Math.round(b.loaded/b.total*100);g(b=>b.map(b=>b.id===a.id?{...b,progress:c,status:"uploading"}:b))}};let d=new Promise((a,b)=>{c.onload=()=>{if(c.status>=200&&c.status<300)a(JSON.parse(c.responseText));else{let a="Upload failed";try{let b=JSON.parse(c.responseText);b.error&&(a=b.error)}catch{}b(Error(a))}},c.onerror=()=>b(Error("Upload failed"))});c.open("POST","/api/media/upload"),c.send(b),await d,g(b=>b.map(b=>b.id===a.id?{...b,progress:100,status:"completed"}:b))}catch(c){let b=c instanceof Error?c.message:"Failed";g(c=>c.map(c=>c.id===a.id?{...c,status:"error",error:b}:c))}},x=async()=>{i(!0);let b=f.filter(a=>"pending"===a.status);for(let a=0;a<b.length;a+=3){let c=b.slice(a,a+3);await Promise.all(c.map(a=>w(a)))}i(!1),a()};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{...l(),className:(0,j.cn)("flex flex-col items-center justify-center rounded-lg border-2 border-dashed p-12 transition-colors cursor-pointer",v?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-primary/50"),children:[(0,b.jsx)("input",{...m()}),(0,b.jsx)(n.Upload,{className:"mb-4 h-12 w-12 text-muted-foreground"}),(0,b.jsx)("p",{className:"mb-2 text-lg font-medium",children:v?"Drop files here":"Drag & drop files here, or click to select"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Supports images, videos, audio, and documents up to 10MB"})]}),f.length>0&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("h3",{className:"font-medium",children:["Upload Queue (",f.length,")"]}),(0,b.jsxs)("div",{className:"space-x-2",children:[(0,b.jsx)(o.Button,{variant:"outline",size:"sm",onClick:()=>{g(a=>a.filter(a=>"completed"!==a.status))},disabled:h||!f.some(a=>"completed"===a.status),children:"Clear Completed"}),(0,b.jsx)(o.Button,{size:"sm",onClick:x,disabled:h||!f.some(a=>"pending"===a.status),children:h?"Uploading...":"Start Upload"})]})]}),(0,b.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:f.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-md border p-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 overflow-hidden",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded bg-muted",children:(0,b.jsx)(e.FileIcon,{className:"h-5 w-5 text-muted-foreground"})}),(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsx)("p",{className:"truncate text-sm font-medium",children:a.file.name}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,d.formatBytes)(a.file.size)})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:["uploading"===a.status&&(0,b.jsx)(u.Progress,{value:a.progress,className:"w-24"}),"completed"===a.status&&(0,b.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,b.jsx)(s.CheckCircle,{className:"mr-1 h-4 w-4"}),(0,b.jsx)("span",{className:"text-xs",children:"Done"})]}),"error"===a.status&&(0,b.jsxs)("div",{className:"flex items-center text-red-600",title:a.error,children:[(0,b.jsx)(t.AlertCircle,{className:"mr-1 h-4 w-4"}),(0,b.jsx)("span",{className:"text-xs max-w-[150px] truncate",children:a.error||"Error"})]}),"pending"===a.status&&(0,b.jsx)(o.Button,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>{var b;return b=a.id,void g(a=>a.filter(a=>a.id!==b))},children:(0,b.jsx)(r.X,{className:"h-4 w-4"})})]})]},a.id))})]})]})}],287470)}];

//# sourceMappingURL=_495e90e3._.js.map
//# debugId=e763f5ef-312a-5833-822b-575adc159a8b
