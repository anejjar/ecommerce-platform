{"version":3,"sources":null,"sections":[{"offset":{"line":5,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/i18n.ts"],"sourcesContent":["import { getRequestConfig } from 'next-intl/server';\nimport { notFound } from 'next/navigation';\n\n// Supported locales - can be managed from admin\nexport const locales = ['en', 'fr'] as const;\nexport type Locale = (typeof locales)[number];\nexport const defaultLocale: Locale = 'en';\n\nexport default getRequestConfig(async ({ requestLocale }) => {\n  let locale = await requestLocale;\n\n  // Validate that the incoming `locale` parameter is valid\n  if (!locale || !locales.includes(locale as Locale)) {\n    locale = defaultLocale;\n  }\n\n  try {\n    // Try to load translations from the messages directory (admin managed)\n    const messages = (await import(`../messages/${locale}.json`)).default;\n    return {\n      locale: locale as string,\n      messages\n    };\n  } catch (error) {\n    // If no translation file exists, fall back to English\n    console.warn(`Translation file for ${locale} not found, using English`);\n    const messages = (await import(`../messages/en.json`)).default;\n    return {\n      locale: locale as string,\n      messages\n    };\n  }\n});\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAIO,MAAM,UAAU;IAAC;IAAM;CAAK;AAE5B,MAAM,gBAAwB;uCAEtB,IAAA,oNAAgB,EAAC,OAAO,EAAE,aAAa,EAAE;IACtD,IAAI,SAAS,MAAM;IAEnB,yDAAyD;IACzD,IAAI,CAAC,UAAU,CAAC,QAAQ,QAAQ,CAAC,SAAmB;QAClD,SAAS;IACX;IAEA,IAAI;QACF,uEAAuE;QACvE,MAAM,WAAW,CAAC;;;;;;;;;kBAAa,CAAC,YAAY,EAAE,OAAO,KAAK,CAAC,CAAC,EAAE,OAAO;QACrE,OAAO;YACL,QAAQ;YACR;QACF;IACF,EAAE,OAAO,OAAO;QACd,sDAAsD;QACtD,QAAQ,IAAI,CAAC,CAAC,qBAAqB,EAAE,OAAO,yBAAyB,CAAC;QACtE,MAAM,WAAW,CAAC,gFAAmC,EAAE,OAAO;QAC9D,OAAO;YACL,QAAQ;YACR;QACF;IACF;AACF"}},{"offset":{"line":56,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/navigation.ts"],"sourcesContent":["import { createNavigation } from 'next-intl/navigation';\r\nimport { locales } from './i18n';\r\n\r\nexport const { Link, redirect, usePathname, useRouter } =\r\n    createNavigation({ locales });\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEO,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,WAAW,EAAE,SAAS,EAAE,GACnD,IAAA,kRAAgB,EAAC;IAAE,SAAA,sHAAO;AAAC"}},{"offset":{"line":77,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/redux/hooks.ts"],"sourcesContent":["import { useDispatch, useSelector, useStore } from 'react-redux';\nimport type { RootState, AppDispatch, AppStore } from './store';\n\nexport const useAppDispatch = useDispatch.withTypes<AppDispatch>();\nexport const useAppSelector = useSelector.withTypes<RootState>();\nexport const useAppStore = useStore.withTypes<AppStore>();\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAGO,MAAM,iBAAiB,wKAAW,CAAC,SAAS;AAC5C,MAAM,iBAAiB,wKAAW,CAAC,SAAS;AAC5C,MAAM,cAAc,qKAAQ,CAAC,SAAS"}},{"offset":{"line":94,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/formatting.ts"],"sourcesContent":["/**\r\n * Localized formatting utilities for currency, dates, and numbers\r\n */\r\n\r\n/**\r\n * Format currency based on locale\r\n */\r\nexport function formatCurrency(\r\n  amount: number | string,\r\n  locale: string = 'en',\r\n  currency: string = 'USD'\r\n): string {\r\n  const numAmount = typeof amount === 'string' ? parseFloat(amount) : amount;\r\n\r\n  try {\r\n    return new Intl.NumberFormat(locale, {\r\n      style: 'currency',\r\n      currency,\r\n    }).format(numAmount);\r\n  } catch (error) {\r\n    // Fallback to USD if currency not supported\r\n    return new Intl.NumberFormat(locale, {\r\n      style: 'currency',\r\n      currency: 'USD',\r\n    }).format(numAmount);\r\n  }\r\n}\r\n\r\n/**\r\n * Format date based on locale\r\n */\r\nexport function formatDate(\r\n  date: Date | string,\r\n  locale: string = 'en',\r\n  options?: Intl.DateTimeFormatOptions\r\n): string {\r\n  const dateObj = typeof date === 'string' ? new Date(date) : date;\r\n\r\n  const defaultOptions: Intl.DateTimeFormatOptions = {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    ...options,\r\n  };\r\n\r\n  return new Intl.DateTimeFormat(locale, defaultOptions).format(dateObj);\r\n}\r\n\r\n/**\r\n * Format date and time based on locale\r\n */\r\nexport function formatDateTime(\r\n  date: Date | string,\r\n  locale: string = 'en',\r\n  options?: Intl.DateTimeFormatOptions\r\n): string {\r\n  const dateObj = typeof date === 'string' ? new Date(date) : date;\r\n\r\n  const defaultOptions: Intl.DateTimeFormatOptions = {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    ...options,\r\n  };\r\n\r\n  return new Intl.DateTimeFormat(locale, defaultOptions).format(dateObj);\r\n}\r\n\r\n/**\r\n * Format number based on locale\r\n */\r\nexport function formatNumber(\r\n  number: number | string,\r\n  locale: string = 'en',\r\n  options?: Intl.NumberFormatOptions\r\n): string {\r\n  const num = typeof number === 'string' ? parseFloat(number) : number;\r\n\r\n  return new Intl.NumberFormat(locale, options).format(num);\r\n}\r\n\r\n/**\r\n * Format percentage based on locale\r\n */\r\nexport function formatPercentage(\r\n  value: number | string,\r\n  locale: string = 'en',\r\n  decimals: number = 0\r\n): string {\r\n  const num = typeof value === 'string' ? parseFloat(value) : value;\r\n\r\n  return new Intl.NumberFormat(locale, {\r\n    style: 'percent',\r\n    minimumFractionDigits: decimals,\r\n    maximumFractionDigits: decimals,\r\n  }).format(num / 100);\r\n}\r\n\r\n/**\r\n * Format relative time (e.g., \"2 days ago\", \"in 3 hours\")\r\n */\r\nexport function formatRelativeTime(\r\n  date: Date | string,\r\n  locale: string = 'en'\r\n): string {\r\n  const dateObj = typeof date === 'string' ? new Date(date) : date;\r\n  const now = new Date();\r\n  const diffInSeconds = Math.floor((now.getTime() - dateObj.getTime()) / 1000);\r\n\r\n  const rtf = new Intl.RelativeTimeFormat(locale, { numeric: 'auto' });\r\n\r\n  const intervals: { unit: Intl.RelativeTimeFormatUnit; seconds: number }[] = [\r\n    { unit: 'year', seconds: 31536000 },\r\n    { unit: 'month', seconds: 2592000 },\r\n    { unit: 'week', seconds: 604800 },\r\n    { unit: 'day', seconds: 86400 },\r\n    { unit: 'hour', seconds: 3600 },\r\n    { unit: 'minute', seconds: 60 },\r\n    { unit: 'second', seconds: 1 },\r\n  ];\r\n\r\n  for (const interval of intervals) {\r\n    const count = Math.floor(Math.abs(diffInSeconds) / interval.seconds);\r\n    if (count >= 1) {\r\n      return rtf.format(diffInSeconds > 0 ? -count : count, interval.unit);\r\n    }\r\n  }\r\n\r\n  return rtf.format(0, 'second');\r\n}\r\n\r\n/**\r\n * Format file size with locale-specific number formatting\r\n */\r\nexport function formatFileSize(\r\n  bytes: number,\r\n  locale: string = 'en',\r\n  decimals: number = 2\r\n): string {\r\n  if (bytes === 0) return '0 Bytes';\r\n\r\n  const k = 1024;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n  const value = bytes / Math.pow(k, i);\r\n  const formatted = formatNumber(value, locale, {\r\n    minimumFractionDigits: decimals,\r\n    maximumFractionDigits: decimals,\r\n  });\r\n\r\n  return `${formatted} ${sizes[i]}`;\r\n}\r\n\r\n/**\r\n * Get locale-specific currency symbol\r\n */\r\nexport function getCurrencySymbol(locale: string = 'en', currency: string = 'USD'): string {\r\n  const formatted = new Intl.NumberFormat(locale, {\r\n    style: 'currency',\r\n    currency,\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0,\r\n  }).format(0);\r\n\r\n  // Extract symbol by removing the number\r\n  return formatted.replace(/\\d/g, '').trim();\r\n}\r\n\r\n/**\r\n * Format currency amount with custom symbol\r\n * This is used when you want to use the currency symbol from settings\r\n */\r\nexport function formatCurrencyWithSymbol(\r\n  amount: number | string,\r\n  symbol: string = '$',\r\n  locale: string = 'en-US'\r\n): string {\r\n  const numAmount = typeof amount === 'string' ? parseFloat(amount) : amount;\r\n  \r\n  if (isNaN(numAmount)) {\r\n    return `${symbol}0.00`;\r\n  }\r\n\r\n  // Format the number with locale-specific formatting\r\n  const formatted = new Intl.NumberFormat(locale, {\r\n    minimumFractionDigits: 2,\r\n    maximumFractionDigits: 2,\r\n  }).format(numAmount);\r\n\r\n  return `${symbol}${formatted}`;\r\n}\r\n\r\n/**\r\n * Format currency amount with custom symbol (no decimals)\r\n */\r\nexport function formatCurrencyWithSymbolNoDecimals(\r\n  amount: number | string,\r\n  symbol: string = '$',\r\n  locale: string = 'en-US'\r\n): string {\r\n  const numAmount = typeof amount === 'string' ? parseFloat(amount) : amount;\r\n  \r\n  if (isNaN(numAmount)) {\r\n    return `${symbol}0`;\r\n  }\r\n\r\n  // Format the number with locale-specific formatting\r\n  const formatted = new Intl.NumberFormat(locale, {\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0,\r\n  }).format(numAmount);\r\n\r\n  return `${symbol}${formatted}`;\r\n}\r\n\r\n/**\r\n * Format list of items based on locale\r\n */\r\nexport function formatList(\r\n  items: string[],\r\n  locale: string = 'en',\r\n  type: 'conjunction' | 'disjunction' = 'conjunction'\r\n): string {\r\n  if (items.length === 0) return '';\r\n  if (items.length === 1) return items[0];\r\n\r\n  const formatter = new Intl.ListFormat(locale, {\r\n    style: 'long',\r\n    type,\r\n  });\r\n\r\n  return formatter.format(items);\r\n}\r\n\r\n/**\r\n * Format compact number (e.g., 1K, 1M)\r\n */\r\nexport function formatCompactNumber(\r\n  number: number | string,\r\n  locale: string = 'en'\r\n): string {\r\n  const num = typeof number === 'string' ? parseFloat(number) : number;\r\n\r\n  return new Intl.NumberFormat(locale, {\r\n    notation: 'compact',\r\n    compactDisplay: 'short',\r\n  }).format(num);\r\n}\r\n\r\n/**\r\n * Locale configuration for specific locales\r\n */\r\nexport const localeConfigs = {\r\n  en: {\r\n    currency: 'USD',\r\n    dateFormat: 'MM/DD/YYYY',\r\n    timeFormat: '12h',\r\n  },\r\n  fr: {\r\n    currency: 'EUR',\r\n    dateFormat: 'DD/MM/YYYY',\r\n    timeFormat: '24h',\r\n  },\r\n} as const;\r\n\r\n/**\r\n * Get locale configuration\r\n */\r\nexport function getLocaleConfig(locale: string) {\r\n  return localeConfigs[locale as keyof typeof localeConfigs] || localeConfigs.en;\r\n}\r\n"],"names":[],"mappings":"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"}},{"offset":{"line":309,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/image-utils.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\n\r\n/**\r\n * Placeholder image data URL for product images\r\n * A professional SVG placeholder with icon\r\n */\r\nexport const PLACEHOLDER_PRODUCT_IMAGE = `data:image/svg+xml;charset=utf-8,${encodeURIComponent(\r\n  `<svg width=\"400\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\r\n    <defs>\r\n      <linearGradient id=\"bg\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n        <stop offset=\"0%\" style=\"stop-color:#f9fafb;stop-opacity:1\" />\r\n        <stop offset=\"100%\" style=\"stop-color:#f3f4f6;stop-opacity:1\" />\r\n      </linearGradient>\r\n    </defs>\r\n    <rect width=\"400\" height=\"400\" fill=\"url(#bg)\"/>\r\n    <g transform=\"translate(200, 200)\">\r\n      <!-- Shopping bag icon -->\r\n      <path d=\"M-40 -20 L-40 60 L40 60 L40 -20 Z\" fill=\"#e5e7eb\" stroke=\"#d1d5db\" stroke-width=\"2\"/>\r\n      <rect x=\"-35\" y=\"-15\" width=\"70\" height=\"70\" fill=\"#e5e7eb\"/>\r\n      <path d=\"M-25 -20 Q-25 -45 0 -45 Q25 -45 25 -20\" fill=\"none\" stroke=\"#9ca3af\" stroke-width=\"3\" stroke-linecap=\"round\"/>\r\n      <!-- Shopping bag icon bottom -->\r\n      <circle cx=\"0\" cy=\"20\" r=\"3\" fill=\"#9ca3af\"/>\r\n    </g>\r\n    <text x=\"200\" y=\"280\" font-family=\"system-ui, -apple-system, sans-serif\" font-size=\"14\" fill=\"#9ca3af\" text-anchor=\"middle\" font-weight=\"500\">No Image Available</text>\r\n  </svg>`\r\n)}`;\r\n\r\n/**\r\n * Handle image error by replacing with placeholder\r\n * Works with both regular img elements and Next.js Image component\r\n */\r\nexport function handleImageError(e: React.SyntheticEvent<HTMLImageElement, Event>) {\r\n  const target = e.currentTarget;\r\n  // Prevent infinite loop if placeholder also fails\r\n  const currentSrc = target.src || target.getAttribute('src') || '';\r\n\r\n  if (currentSrc && !currentSrc.includes('data:image/svg+xml') && !currentSrc.includes('placeholder')) {\r\n    try {\r\n      // For Next.js Image, we need to update the src directly\r\n      // The onError handler receives the native img element\r\n      target.src = PLACEHOLDER_PRODUCT_IMAGE;\r\n      target.setAttribute('src', PLACEHOLDER_PRODUCT_IMAGE);\r\n      target.onerror = null; // Prevent infinite loop\r\n    } catch (error) {\r\n      // If setting src fails, try to hide the image and show placeholder\r\n      console.warn('Failed to set placeholder image:', error);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Handle image error for native HTML img elements\r\n * Use this for standard <img> tags (non-Next.js Image components)\r\n */\r\nexport function handleNativeImageError(e: React.SyntheticEvent<HTMLImageElement, Event>) {\r\n  const target = e.currentTarget;\r\n  const currentSrc = target.src || '';\r\n\r\n  if (currentSrc && !currentSrc.includes('data:image/svg+xml') && !currentSrc.includes('placeholder')) {\r\n    target.onerror = null; // Prevent infinite loop\r\n    target.src = PLACEHOLDER_PRODUCT_IMAGE;\r\n  }\r\n}\r\n\r\n/**\r\n * Get product image URL with fallback to placeholder\r\n */\r\nexport function getProductImageUrl(imageUrl: string | null | undefined): string {\r\n  if (!imageUrl || imageUrl.trim() === '') {\r\n    return PLACEHOLDER_PRODUCT_IMAGE;\r\n  }\r\n  return imageUrl;\r\n}\r\n\r\n/**\r\n * Hook for handling image errors with state\r\n * Use this for Next.js Image components when onError doesn't work reliably\r\n */\r\nexport function useImageErrorHandler(initialSrc: string | null | undefined) {\r\n  const [imageSrc, setImageSrc] = useState<string>(\r\n    getProductImageUrl(initialSrc)\r\n  );\r\n  const [hasError, setHasError] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (initialSrc && initialSrc !== imageSrc && !hasError) {\r\n      setImageSrc(initialSrc);\r\n      setHasError(false);\r\n    }\r\n  }, [initialSrc, imageSrc, hasError]);\r\n\r\n  const handleError = useCallback(() => {\r\n    if (!hasError) {\r\n      setHasError(true);\r\n      setImageSrc(PLACEHOLDER_PRODUCT_IMAGE);\r\n    }\r\n  }, [hasError]);\r\n\r\n  return { imageSrc, handleError, hasError };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAMO,MAAM,4BAA4B,CAAC,iCAAiC,EAAE,mBAC3E,CAAC;;;;;;;;;;;;;;;;;QAiBK,CAAC,GACN;AAMI,SAAS,iBAAiB,CAAgD;IAC/E,MAAM,SAAS,EAAE,aAAa;IAC9B,kDAAkD;IAClD,MAAM,aAAa,OAAO,GAAG,IAAI,OAAO,YAAY,CAAC,UAAU;IAE/D,IAAI,cAAc,CAAC,WAAW,QAAQ,CAAC,yBAAyB,CAAC,WAAW,QAAQ,CAAC,gBAAgB;QACnG,IAAI;YACF,wDAAwD;YACxD,sDAAsD;YACtD,OAAO,GAAG,GAAG;YACb,OAAO,YAAY,CAAC,OAAO;YAC3B,OAAO,OAAO,GAAG,MAAM,wBAAwB;QACjD,EAAE,OAAO,OAAO;YACd,mEAAmE;YACnE,QAAQ,IAAI,CAAC,oCAAoC;QACnD;IACF;AACF;AAMO,SAAS,uBAAuB,CAAgD;IACrF,MAAM,SAAS,EAAE,aAAa;IAC9B,MAAM,aAAa,OAAO,GAAG,IAAI;IAEjC,IAAI,cAAc,CAAC,WAAW,QAAQ,CAAC,yBAAyB,CAAC,WAAW,QAAQ,CAAC,gBAAgB;QACnG,OAAO,OAAO,GAAG,MAAM,wBAAwB;QAC/C,OAAO,GAAG,GAAG;IACf;AACF;AAKO,SAAS,mBAAmB,QAAmC;IACpE,IAAI,CAAC,YAAY,SAAS,IAAI,OAAO,IAAI;QACvC,OAAO;IACT;IACA,OAAO;AACT;AAMO,SAAS,qBAAqB,UAAqC;IACxE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EACtC,mBAAmB;IAErB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IAEzC,IAAA,kNAAS,EAAC;QACR,IAAI,cAAc,eAAe,YAAY,CAAC,UAAU;YACtD,YAAY;YACZ,YAAY;QACd;IACF,GAAG;QAAC;QAAY;QAAU;KAAS;IAEnC,MAAM,cAAc,IAAA,oNAAW,EAAC;QAC9B,IAAI,CAAC,UAAU;YACb,YAAY;YACZ,YAAY;QACd;IACF,GAAG;QAAC;KAAS;IAEb,OAAO;QAAE;QAAU;QAAa;IAAS;AAC3C"}},{"offset":{"line":403,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/editor-utils.ts"],"sourcesContent":["/**\r\n * CMS Page Editor Utility Functions\r\n *\r\n * Helper functions for working with the Elementor-style page builder,\r\n * including block tree manipulation, container operations, and more.\r\n */\r\n\r\nimport { EditorBlock, ContainerType, NavigatorNode } from '@/types/editor';\r\n\r\n// ============================================\r\n// Block Tree Traversal\r\n// ============================================\r\n\r\n/**\r\n * Build a hierarchical tree structure from flat blocks array\r\n */\r\nexport function buildBlockTree(blocks: EditorBlock[]): EditorBlock[] {\r\n  const blockMap = new Map<string, EditorBlock>();\r\n  const rootBlocks: EditorBlock[] = [];\r\n\r\n  // First pass: Create map and initialize children arrays\r\n  blocks.forEach(block => {\r\n    blockMap.set(block.id, { ...block, children: [] });\r\n  });\r\n\r\n  // Second pass: Build hierarchy\r\n  blocks.forEach(block => {\r\n    const blockWithChildren = blockMap.get(block.id)!;\r\n\r\n    if (block.parentId) {\r\n      const parent = blockMap.get(block.parentId);\r\n      if (parent) {\r\n        if (!parent.children) {\r\n          parent.children = [];\r\n        }\r\n        parent.children.push(blockWithChildren);\r\n      } else {\r\n        // Parent not found, treat as root\r\n        rootBlocks.push(blockWithChildren);\r\n      }\r\n    } else {\r\n      rootBlocks.push(blockWithChildren);\r\n    }\r\n  });\r\n\r\n  // Sort children by order\r\n  const sortByOrder = (blocks: EditorBlock[]) => {\r\n    blocks.sort((a, b) => a.order - b.order);\r\n    blocks.forEach(block => {\r\n      if (block.children && block.children.length > 0) {\r\n        sortByOrder(block.children);\r\n      }\r\n    });\r\n  };\r\n\r\n  sortByOrder(rootBlocks);\r\n\r\n  return rootBlocks;\r\n}\r\n\r\n/**\r\n * Flatten a hierarchical block tree into a flat array\r\n */\r\nexport function flattenBlockTree(blocks: EditorBlock[]): EditorBlock[] {\r\n  const result: EditorBlock[] = [];\r\n\r\n  const traverse = (block: EditorBlock) => {\r\n    const { children, ...blockWithoutChildren } = block;\r\n    result.push(blockWithoutChildren as EditorBlock);\r\n\r\n    if (children && children.length > 0) {\r\n      children.forEach(traverse);\r\n    }\r\n  };\r\n\r\n  blocks.forEach(traverse);\r\n\r\n  return result;\r\n}\r\n\r\n/**\r\n * Find a block by ID in the tree\r\n */\r\nexport function findBlockById(\r\n  blocks: EditorBlock[],\r\n  blockId: string\r\n): EditorBlock | null {\r\n  for (const block of blocks) {\r\n    if (block.id === blockId) {\r\n      return block;\r\n    }\r\n\r\n    if (block.children && block.children.length > 0) {\r\n      const found = findBlockById(block.children, blockId);\r\n      if (found) {\r\n        return found;\r\n      }\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Find the parent of a block\r\n */\r\nexport function findBlockParent(\r\n  blocks: EditorBlock[],\r\n  blockId: string,\r\n  parentBlock?: EditorBlock\r\n): EditorBlock | null {\r\n  for (const block of blocks) {\r\n    if (block.children && block.children.some(child => child.id === blockId)) {\r\n      return block;\r\n    }\r\n\r\n    if (block.children && block.children.length > 0) {\r\n      const found = findBlockParent(block.children, blockId, block);\r\n      if (found) {\r\n        return found;\r\n      }\r\n    }\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n/**\r\n * Get all ancestor blocks of a given block\r\n */\r\nexport function getBlockAncestors(\r\n  blocks: EditorBlock[],\r\n  blockId: string\r\n): EditorBlock[] {\r\n  const ancestors: EditorBlock[] = [];\r\n\r\n  const findAncestors = (currentBlocks: EditorBlock[], targetId: string): boolean => {\r\n    for (const block of currentBlocks) {\r\n      if (block.children && block.children.some(child => child.id === targetId)) {\r\n        ancestors.unshift(block);\r\n        return true;\r\n      }\r\n\r\n      if (block.children && block.children.length > 0) {\r\n        if (findAncestors(block.children, targetId)) {\r\n          ancestors.unshift(block);\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  findAncestors(blocks, blockId);\r\n\r\n  return ancestors;\r\n}\r\n\r\n/**\r\n * Get all descendant blocks of a given block\r\n */\r\nexport function getBlockDescendants(block: EditorBlock): EditorBlock[] {\r\n  const descendants: EditorBlock[] = [];\r\n\r\n  const traverse = (currentBlock: EditorBlock) => {\r\n    if (currentBlock.children && currentBlock.children.length > 0) {\r\n      currentBlock.children.forEach(child => {\r\n        descendants.push(child);\r\n        traverse(child);\r\n      });\r\n    }\r\n  };\r\n\r\n  traverse(block);\r\n\r\n  return descendants;\r\n}\r\n\r\n// ============================================\r\n// Block Manipulation\r\n// ============================================\r\n\r\n/**\r\n * Update a block in the tree\r\n */\r\nexport function updateBlockInTree(\r\n  blocks: EditorBlock[],\r\n  blockId: string,\r\n  updates: Partial<EditorBlock>\r\n): EditorBlock[] {\r\n  return blocks.map(block => {\r\n    if (block.id === blockId) {\r\n      return { ...block, ...updates };\r\n    }\r\n\r\n    if (block.children && block.children.length > 0) {\r\n      return {\r\n        ...block,\r\n        children: updateBlockInTree(block.children, blockId, updates),\r\n      };\r\n    }\r\n\r\n    return block;\r\n  });\r\n}\r\n\r\n/**\r\n * Remove a block from the tree\r\n */\r\nexport function removeBlockFromTree(\r\n  blocks: EditorBlock[],\r\n  blockId: string\r\n): EditorBlock[] {\r\n  return blocks\r\n    .filter(block => block.id !== blockId)\r\n    .map(block => {\r\n      if (block.children && block.children.length > 0) {\r\n        return {\r\n          ...block,\r\n          children: removeBlockFromTree(block.children, blockId),\r\n        };\r\n      }\r\n      return block;\r\n    });\r\n}\r\n\r\n/**\r\n * Move a block to a new parent\r\n */\r\nexport function moveBlockToParent(\r\n  blocks: EditorBlock[],\r\n  blockId: string,\r\n  newParentId: string | null,\r\n  newOrder: number\r\n): EditorBlock[] {\r\n  // First, find and remove the block\r\n  const block = findBlockById(blocks, blockId);\r\n  if (!block) {\r\n    return blocks;\r\n  }\r\n\r\n  const withoutBlock = removeBlockFromTree(blocks, blockId);\r\n\r\n  // Update the block's parent and order\r\n  const movedBlock = {\r\n    ...block,\r\n    parentId: newParentId,\r\n    order: newOrder,\r\n  };\r\n\r\n  // If moving to root\r\n  if (!newParentId) {\r\n    return [...withoutBlock, movedBlock];\r\n  }\r\n\r\n  // Otherwise, add to new parent\r\n  return updateBlockInTree(withoutBlock, newParentId, (parent) => ({\r\n    ...parent,\r\n    children: [...(parent.children || []), movedBlock],\r\n  }));\r\n}\r\n\r\n/**\r\n * Duplicate a block\r\n */\r\nexport function duplicateBlock(\r\n  block: EditorBlock,\r\n  generateId: () => string\r\n): EditorBlock {\r\n  const newId = generateId();\r\n\r\n  const duplicated: EditorBlock = {\r\n    ...block,\r\n    id: newId,\r\n    order: block.order + 1,\r\n  };\r\n\r\n  // Recursively duplicate children\r\n  if (block.children && block.children.length > 0) {\r\n    duplicated.children = block.children.map(child =>\r\n      duplicateBlock(child, generateId)\r\n    );\r\n  }\r\n\r\n  return duplicated;\r\n}\r\n\r\n// ============================================\r\n// Container Operations\r\n// ============================================\r\n\r\n/**\r\n * Check if a block is a container\r\n */\r\nexport function isContainer(block: EditorBlock): boolean {\r\n  return block.containerType !== ContainerType.BLOCK;\r\n}\r\n\r\n/**\r\n * Check if a block can be dropped into another block\r\n */\r\nexport function canDropInto(\r\n  draggedBlock: EditorBlock,\r\n  targetBlock: EditorBlock\r\n): boolean {\r\n  // Can't drop into regular blocks\r\n  if (!isContainer(targetBlock)) {\r\n    return false;\r\n  }\r\n\r\n  // Can't drop a container into itself or its descendants\r\n  if (draggedBlock.id === targetBlock.id) {\r\n    return false;\r\n  }\r\n\r\n  const descendants = getBlockDescendants(draggedBlock);\r\n  if (descendants.some(d => d.id === targetBlock.id)) {\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n/**\r\n * Get the maximum nesting depth of a block tree\r\n */\r\nexport function getMaxDepth(blocks: EditorBlock[], currentDepth = 0): number {\r\n  if (!blocks || blocks.length === 0) {\r\n    return currentDepth;\r\n  }\r\n\r\n  let maxDepth = currentDepth;\r\n\r\n  blocks.forEach(block => {\r\n    if (block.children && block.children.length > 0) {\r\n      const childDepth = getMaxDepth(block.children, currentDepth + 1);\r\n      maxDepth = Math.max(maxDepth, childDepth);\r\n    }\r\n  });\r\n\r\n  return maxDepth;\r\n}\r\n\r\n// ============================================\r\n// Navigator Operations\r\n// ============================================\r\n\r\n/**\r\n * Convert editor blocks to navigator nodes\r\n */\r\nexport function blocksToNavigatorNodes(\r\n  blocks: EditorBlock[],\r\n  selectedBlockId: string | null,\r\n  expandedIds: Set<string>,\r\n  depth = 0\r\n): NavigatorNode[] {\r\n  return blocks.map(block => {\r\n    const node: NavigatorNode = {\r\n      id: block.id,\r\n      label: block.template?.name || 'Untitled Block',\r\n      type: block.containerType,\r\n      isVisible: block.isVisible,\r\n      isSelected: block.id === selectedBlockId,\r\n      isExpanded: expandedIds.has(block.id),\r\n      depth,\r\n      children: block.children && block.children.length > 0\r\n        ? blocksToNavigatorNodes(\r\n            block.children,\r\n            selectedBlockId,\r\n            expandedIds,\r\n            depth + 1\r\n          )\r\n        : undefined,\r\n    };\r\n\r\n    return node;\r\n  });\r\n}\r\n\r\n// ============================================\r\n// Configuration Helpers\r\n// ============================================\r\n\r\n/**\r\n * Merge content, style, and advanced configs for rendering\r\n */\r\nexport function mergeConfigs(block: EditorBlock): Record<string, any> {\r\n  return {\r\n    ...block.contentConfig,\r\n    ...block.styleConfig,\r\n    ...block.advancedConfig,\r\n  };\r\n}\r\n\r\n/**\r\n * Split a flat config into three-tab structure\r\n */\r\nexport function splitConfigIntoTabs(\r\n  config: Record<string, any>,\r\n  schema: any\r\n): {\r\n  contentConfig: Record<string, any>;\r\n  styleConfig: Record<string, any>;\r\n  advancedConfig: Record<string, any>;\r\n} {\r\n  // This is a simplified version - in reality, you'd use the schema to determine\r\n  // which fields belong in which tab\r\n  const contentConfig: Record<string, any> = {};\r\n  const styleConfig: Record<string, any> = {};\r\n  const advancedConfig: Record<string, any> = {};\r\n\r\n  Object.entries(config).forEach(([key, value]) => {\r\n    // Style-related keys\r\n    if (\r\n      key.includes('color') ||\r\n      key.includes('background') ||\r\n      key.includes('font') ||\r\n      key.includes('padding') ||\r\n      key.includes('margin') ||\r\n      key.includes('border')\r\n    ) {\r\n      styleConfig[key] = value;\r\n    }\r\n    // Advanced-related keys\r\n    else if (\r\n      key.includes('animation') ||\r\n      key.includes('custom') ||\r\n      key.includes('position') ||\r\n      key.includes('zIndex')\r\n    ) {\r\n      advancedConfig[key] = value;\r\n    }\r\n    // Content by default\r\n    else {\r\n      contentConfig[key] = value;\r\n    }\r\n  });\r\n\r\n  return { contentConfig, styleConfig, advancedConfig };\r\n}\r\n\r\n// ============================================\r\n// Order/Reordering Helpers\r\n// ============================================\r\n\r\n/**\r\n * Reorder blocks within the same parent\r\n */\r\nexport function reorderBlocks(\r\n  blocks: EditorBlock[],\r\n  oldIndex: number,\r\n  newIndex: number\r\n): EditorBlock[] {\r\n  const result = Array.from(blocks);\r\n  const [removed] = result.splice(oldIndex, 1);\r\n  result.splice(newIndex, 0, removed);\r\n\r\n  // Update order values\r\n  return result.map((block, index) => ({\r\n    ...block,\r\n    order: index,\r\n  }));\r\n}\r\n\r\n/**\r\n * Update order values for all blocks to be sequential\r\n */\r\nexport function normalizeBlockOrders(blocks: EditorBlock[]): EditorBlock[] {\r\n  return blocks.map((block, index) => {\r\n    const updated = { ...block, order: index };\r\n\r\n    if (block.children && block.children.length > 0) {\r\n      updated.children = normalizeBlockOrders(block.children);\r\n    }\r\n\r\n    return updated;\r\n  });\r\n}\r\n\r\n// ============================================\r\n// Validation\r\n// ============================================\r\n\r\n/**\r\n * Validate block tree structure\r\n */\r\nexport function validateBlockTree(blocks: EditorBlock[]): {\r\n  isValid: boolean;\r\n  errors: string[];\r\n} {\r\n  const errors: string[] = [];\r\n  const blockIds = new Set<string>();\r\n\r\n  const validate = (block: EditorBlock, ancestors: string[] = []): void => {\r\n    // Check for duplicate IDs\r\n    if (blockIds.has(block.id)) {\r\n      errors.push(`Duplicate block ID: ${block.id}`);\r\n    }\r\n    blockIds.add(block.id);\r\n\r\n    // Check for circular references\r\n    if (ancestors.includes(block.id)) {\r\n      errors.push(`Circular reference detected: ${block.id}`);\r\n    }\r\n\r\n    // Check children\r\n    if (block.children) {\r\n      // Non-containers shouldn't have children\r\n      if (!isContainer(block)) {\r\n        errors.push(`Non-container block ${block.id} has children`);\r\n      }\r\n\r\n      block.children.forEach(child => {\r\n        validate(child, [...ancestors, block.id]);\r\n      });\r\n    }\r\n  };\r\n\r\n  blocks.forEach(block => validate(block));\r\n\r\n  return {\r\n    isValid: errors.length === 0,\r\n    errors,\r\n  };\r\n}\r\n\r\n// ============================================\r\n// Search & Filter\r\n// ============================================\r\n\r\n/**\r\n * Search blocks by text\r\n */\r\nexport function searchBlocks(\r\n  blocks: EditorBlock[],\r\n  query: string\r\n): EditorBlock[] {\r\n  const results: EditorBlock[] = [];\r\n  const lowerQuery = query.toLowerCase();\r\n\r\n  const search = (block: EditorBlock) => {\r\n    const templateName = block.template?.name?.toLowerCase() || '';\r\n    const configStr = JSON.stringify(block.contentConfig).toLowerCase();\r\n\r\n    if (templateName.includes(lowerQuery) || configStr.includes(lowerQuery)) {\r\n      results.push(block);\r\n    }\r\n\r\n    if (block.children && block.children.length > 0) {\r\n      block.children.forEach(search);\r\n    }\r\n  };\r\n\r\n  blocks.forEach(search);\r\n\r\n  return results;\r\n}\r\n"],"names":[],"mappings":"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"}},{"offset":{"line":785,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/normalizeBlockConfig.ts"],"sourcesContent":["/**\r\n * Normalizes block configuration data to ensure repeater fields are always arrays\r\n * This prevents \"value.map is not a function\" errors when loading existing blocks\r\n */\r\nexport function normalizeBlockConfig(config: any, schema: any): any {\r\n    if (!config || !schema) return config;\r\n\r\n    const normalized = { ...config };\r\n    const schemaFields = schema.fields || [];\r\n\r\n    // Recursively normalize repeater fields\r\n    const normalizeRepeaterField = (field: any, value: any): any => {\r\n        if (field.type === 'repeater' && field.fields) {\r\n            // Ensure value is an array\r\n            const arrayValue = Array.isArray(value) ? value : (value ? [value] : []);\r\n            \r\n            // Normalize each item in the repeater\r\n            return arrayValue.map((item: any) => {\r\n                const normalizedItem: any = {};\r\n                field.fields.forEach((subField: any) => {\r\n                    if (subField.type === 'repeater') {\r\n                        // Handle nested repeaters\r\n                        normalizedItem[subField.name] = normalizeRepeaterField(\r\n                            subField,\r\n                            item[subField.name]\r\n                        );\r\n                    } else {\r\n                        normalizedItem[subField.name] = item[subField.name] ?? (subField.default ?? '');\r\n                    }\r\n                });\r\n                return normalizedItem;\r\n            });\r\n        }\r\n        return value;\r\n    };\r\n\r\n    // Normalize all fields in the config\r\n    schemaFields.forEach((field: any) => {\r\n        if (field.type === 'repeater') {\r\n            normalized[field.name] = normalizeRepeaterField(field, normalized[field.name]);\r\n        }\r\n    });\r\n\r\n    return normalized;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,SAAS,qBAAqB,MAAW,EAAE,MAAW;IACzD,IAAI,CAAC,UAAU,CAAC,QAAQ,OAAO;IAE/B,MAAM,aAAa;QAAE,GAAG,MAAM;IAAC;IAC/B,MAAM,eAAe,OAAO,MAAM,IAAI,EAAE;IAExC,wCAAwC;IACxC,MAAM,yBAAyB,CAAC,OAAY;QACxC,IAAI,MAAM,IAAI,KAAK,cAAc,MAAM,MAAM,EAAE;YAC3C,2BAA2B;YAC3B,MAAM,aAAa,MAAM,OAAO,CAAC,SAAS,QAAS,QAAQ;gBAAC;aAAM,GAAG,EAAE;YAEvE,sCAAsC;YACtC,OAAO,WAAW,GAAG,CAAC,CAAC;gBACnB,MAAM,iBAAsB,CAAC;gBAC7B,MAAM,MAAM,CAAC,OAAO,CAAC,CAAC;oBAClB,IAAI,SAAS,IAAI,KAAK,YAAY;wBAC9B,0BAA0B;wBAC1B,cAAc,CAAC,SAAS,IAAI,CAAC,GAAG,uBAC5B,UACA,IAAI,CAAC,SAAS,IAAI,CAAC;oBAE3B,OAAO;wBACH,cAAc,CAAC,SAAS,IAAI,CAAC,GAAG,IAAI,CAAC,SAAS,IAAI,CAAC,IAAK,SAAS,OAAO,IAAI;oBAChF;gBACJ;gBACA,OAAO;YACX;QACJ;QACA,OAAO;IACX;IAEA,qCAAqC;IACrC,aAAa,OAAO,CAAC,CAAC;QAClB,IAAI,MAAM,IAAI,KAAK,YAAY;YAC3B,UAAU,CAAC,MAAM,IAAI,CAAC,GAAG,uBAAuB,OAAO,UAAU,CAAC,MAAM,IAAI,CAAC;QACjF;IACJ;IAEA,OAAO;AACX"}},{"offset":{"line":833,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/hooks/useCurrency.ts"],"sourcesContent":["'use client';\r\n\r\nimport { useSettings } from '@/contexts/SettingsContext';\r\nimport { formatCurrencyWithSymbol, formatCurrencyWithSymbolNoDecimals } from '@/lib/formatting';\r\n\r\n/**\r\n * Custom hook to format currency using the currency symbol from settings\r\n * This hook should be used throughout the application instead of hardcoding currency symbols\r\n */\r\nexport function useCurrency() {\r\n  const { settings } = useSettings();\r\n  const currencySymbol = settings.general_currency_symbol || '$';\r\n\r\n  /**\r\n   * Format currency with 2 decimal places\r\n   */\r\n  const format = (amount: number | string): string => {\r\n    return formatCurrencyWithSymbol(amount, currencySymbol);\r\n  };\r\n\r\n  /**\r\n   * Format currency without decimal places\r\n   */\r\n  const formatNoDecimals = (amount: number | string): string => {\r\n    return formatCurrencyWithSymbolNoDecimals(amount, currencySymbol);\r\n  };\r\n\r\n  /**\r\n   * Get the currency symbol\r\n   */\r\n  const symbol = currencySymbol;\r\n\r\n  /**\r\n   * Format a number with the currency symbol (for custom formatting)\r\n   */\r\n  const formatWithSymbol = (amount: number | string, options?: { decimals?: number }): string => {\r\n    const numAmount = typeof amount === 'string' ? parseFloat(amount) : amount;\r\n    \r\n    if (isNaN(numAmount)) {\r\n      return `${currencySymbol}0${options?.decimals === 0 ? '' : '.00'}`;\r\n    }\r\n\r\n    const formatted = new Intl.NumberFormat('en-US', {\r\n      minimumFractionDigits: options?.decimals ?? 2,\r\n      maximumFractionDigits: options?.decimals ?? 2,\r\n    }).format(numAmount);\r\n\r\n    return `${currencySymbol}${formatted}`;\r\n  };\r\n\r\n  return {\r\n    format,\r\n    formatNoDecimals,\r\n    symbol,\r\n    formatWithSymbol,\r\n  };\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AASO,SAAS;IACd,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,kJAAW;IAChC,MAAM,iBAAiB,SAAS,uBAAuB,IAAI;IAE3D;;GAEC,GACD,MAAM,SAAS,CAAC;QACd,OAAO,IAAA,oJAAwB,EAAC,QAAQ;IAC1C;IAEA;;GAEC,GACD,MAAM,mBAAmB,CAAC;QACxB,OAAO,IAAA,8JAAkC,EAAC,QAAQ;IACpD;IAEA;;GAEC,GACD,MAAM,SAAS;IAEf;;GAEC,GACD,MAAM,mBAAmB,CAAC,QAAyB;QACjD,MAAM,YAAY,OAAO,WAAW,WAAW,WAAW,UAAU;QAEpE,IAAI,MAAM,YAAY;YACpB,OAAO,GAAG,eAAe,CAAC,EAAE,SAAS,aAAa,IAAI,KAAK,OAAO;QACpE;QAEA,MAAM,YAAY,IAAI,KAAK,YAAY,CAAC,SAAS;YAC/C,uBAAuB,SAAS,YAAY;YAC5C,uBAAuB,SAAS,YAAY;QAC9C,GAAG,MAAM,CAAC;QAEV,OAAO,GAAG,iBAAiB,WAAW;IACxC;IAEA,OAAO;QACL;QACA;QACA;QACA;IACF;AACF"}},{"offset":{"line":882,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/hooks/useFlashSale.ts"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\n\r\ninterface FlashSaleData {\r\n  flashSale: {\r\n    id: string\r\n    name: string\r\n    description: string | null\r\n    discountType: 'PERCENTAGE' | 'FIXED_AMOUNT'\r\n    discountValue: number\r\n    startDate: string\r\n    endDate: string\r\n    bannerImage: string | null\r\n    bannerText: string | null\r\n  } | null\r\n  product: {\r\n    originalPrice: number\r\n    salePrice: number\r\n    maxQuantity: number | null\r\n    soldQuantity: number\r\n    available: number | null\r\n  } | null\r\n}\r\n\r\nexport function useFlashSale(productId: string) {\r\n  const [flashSaleData, setFlashSaleData] = useState<FlashSaleData>({\r\n    flashSale: null,\r\n    product: null,\r\n  })\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  useEffect(() => {\r\n    async function fetchFlashSale() {\r\n      try {\r\n        const response = await fetch(`/api/products/${productId}/flash-sale`)\r\n        if (response.ok) {\r\n          const data = await response.json()\r\n          setFlashSaleData(data)\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching flash sale:', error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    if (productId) {\r\n      fetchFlashSale()\r\n    } else {\r\n      setLoading(false)\r\n    }\r\n  }, [productId])\r\n\r\n  return { ...flashSaleData, loading }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAyBO,SAAS,aAAa,SAAiB;IAC5C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAgB;QAChE,WAAW;QACX,SAAS;IACX;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,eAAe;YACb,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM,CAAC,cAAc,EAAE,UAAU,WAAW,CAAC;gBACpE,IAAI,SAAS,EAAE,EAAE;oBACf,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,iBAAiB;gBACnB;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,8BAA8B;YAC9C,SAAU;gBACR,WAAW;YACb;QACF;QAEA,IAAI,WAAW;YACb;QACF,OAAO;YACL,WAAW;QACb;IACF,GAAG;QAAC;KAAU;IAEd,OAAO;QAAE,GAAG,aAAa;QAAE;IAAQ;AACrC"}},{"offset":{"line":926,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/hooks/useTheme.ts"],"sourcesContent":["/**\r\n * useTheme Hook\r\n * Convenience hook to access theme configuration\r\n */\r\n\r\nimport { useThemeContext } from '@/contexts/ThemeContext';\r\nimport { ThemeConfig } from '@/lib/themes/theme-schema';\r\n\r\nexport function useTheme(): {\r\n  theme: ThemeConfig | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  refreshTheme: () => Promise<void>;\r\n} {\r\n  return useThemeContext();\r\n}\r\n\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AAED;;AAGO,SAAS;IAMd,OAAO,IAAA,mJAAe;AACxB"}},{"offset":{"line":942,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/hooks/useKeyboardShortcuts.ts"],"sourcesContent":["/**\r\n * Keyboard Shortcuts Hook\r\n *\r\n * Global keyboard shortcut handler for the editor.\r\n * Matches Elementor's keyboard shortcuts.\r\n */\r\n\r\nimport { useEffect, useCallback } from 'react';\r\n\r\nexport interface KeyboardShortcut {\r\n  key: string;\r\n  ctrl?: boolean;\r\n  shift?: boolean;\r\n  alt?: boolean;\r\n  meta?: boolean;\r\n  description: string;\r\n  action: () => void;\r\n  preventDefault?: boolean;\r\n}\r\n\r\ninterface UseKeyboardShortcutsOptions {\r\n  enabled?: boolean;\r\n  shortcuts: KeyboardShortcut[];\r\n}\r\n\r\nexport function useKeyboardShortcuts({ enabled = true, shortcuts }: UseKeyboardShortcutsOptions) {\r\n  const handleKeyDown = useCallback(\r\n    (event: KeyboardEvent) => {\r\n      if (!enabled) return;\r\n\r\n      // Don't trigger shortcuts when typing in inputs, textareas, or contenteditable\r\n      const target = event.target as HTMLElement;\r\n      if (\r\n        target.tagName === 'INPUT' ||\r\n        target.tagName === 'TEXTAREA' ||\r\n        target.isContentEditable\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      for (const shortcut of shortcuts) {\r\n        const keyMatches = event.key.toLowerCase() === shortcut.key.toLowerCase();\r\n        const ctrlMatches = shortcut.ctrl ? (event.ctrlKey || event.metaKey) : !event.ctrlKey && !event.metaKey;\r\n        const shiftMatches = shortcut.shift ? event.shiftKey : !event.shiftKey;\r\n        const altMatches = shortcut.alt ? event.altKey : !event.altKey;\r\n        const metaMatches = shortcut.meta ? event.metaKey : !event.metaKey;\r\n\r\n        if (keyMatches && ctrlMatches && shiftMatches && altMatches) {\r\n          if (shortcut.preventDefault !== false) {\r\n            event.preventDefault();\r\n          }\r\n          shortcut.action();\r\n          break;\r\n        }\r\n      }\r\n    },\r\n    [enabled, shortcuts]\r\n  );\r\n\r\n  useEffect(() => {\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => {\r\n      window.removeEventListener('keydown', handleKeyDown);\r\n    };\r\n  }, [handleKeyDown]);\r\n}\r\n\r\n/**\r\n * Create editor keyboard shortcuts\r\n */\r\nexport function createEditorShortcuts(handlers: {\r\n  onSave?: () => void;\r\n  onUndo?: () => void;\r\n  onRedo?: () => void;\r\n  onCopy?: () => void;\r\n  onPaste?: () => void;\r\n  onDuplicate?: () => void;\r\n  onDelete?: () => void;\r\n  onOpenFinder?: () => void;\r\n  onOpenHistory?: () => void;\r\n  onToggleDeviceMode?: () => void;\r\n  onShowHelp?: () => void;\r\n  onSelectAll?: () => void;\r\n  onDeselectAll?: () => void;\r\n}): KeyboardShortcut[] {\r\n  const shortcuts: KeyboardShortcut[] = [];\r\n\r\n  if (handlers.onSave) {\r\n    shortcuts.push({\r\n      key: 's',\r\n      ctrl: true,\r\n      description: 'Save page',\r\n      action: handlers.onSave,\r\n    });\r\n  }\r\n\r\n  if (handlers.onUndo) {\r\n    shortcuts.push({\r\n      key: 'z',\r\n      ctrl: true,\r\n      description: 'Undo',\r\n      action: handlers.onUndo,\r\n    });\r\n  }\r\n\r\n  if (handlers.onRedo) {\r\n    shortcuts.push({\r\n      key: 'z',\r\n      ctrl: true,\r\n      shift: true,\r\n      description: 'Redo',\r\n      action: handlers.onRedo,\r\n    });\r\n    shortcuts.push({\r\n      key: 'y',\r\n      ctrl: true,\r\n      description: 'Redo',\r\n      action: handlers.onRedo,\r\n    });\r\n  }\r\n\r\n  if (handlers.onCopy) {\r\n    shortcuts.push({\r\n      key: 'c',\r\n      ctrl: true,\r\n      description: 'Copy selected block',\r\n      action: handlers.onCopy,\r\n    });\r\n  }\r\n\r\n  if (handlers.onPaste) {\r\n    shortcuts.push({\r\n      key: 'v',\r\n      ctrl: true,\r\n      description: 'Paste block',\r\n      action: handlers.onPaste,\r\n    });\r\n  }\r\n\r\n  if (handlers.onDuplicate) {\r\n    shortcuts.push({\r\n      key: 'd',\r\n      ctrl: true,\r\n      description: 'Duplicate selected block',\r\n      action: handlers.onDuplicate,\r\n    });\r\n  }\r\n\r\n  if (handlers.onDelete) {\r\n    shortcuts.push({\r\n      key: 'Delete',\r\n      description: 'Delete selected block',\r\n      action: handlers.onDelete,\r\n    });\r\n    shortcuts.push({\r\n      key: 'Backspace',\r\n      description: 'Delete selected block',\r\n      action: handlers.onDelete,\r\n    });\r\n  }\r\n\r\n  if (handlers.onOpenFinder) {\r\n    shortcuts.push({\r\n      key: 'e',\r\n      ctrl: true,\r\n      description: 'Open Finder',\r\n      action: handlers.onOpenFinder,\r\n    });\r\n    shortcuts.push({\r\n      key: 'k',\r\n      ctrl: true,\r\n      description: 'Open Finder',\r\n      action: handlers.onOpenFinder,\r\n    });\r\n  }\r\n\r\n  if (handlers.onOpenHistory) {\r\n    shortcuts.push({\r\n      key: 'h',\r\n      ctrl: true,\r\n      description: 'Open History',\r\n      action: handlers.onOpenHistory,\r\n    });\r\n  }\r\n\r\n  if (handlers.onToggleDeviceMode) {\r\n    shortcuts.push({\r\n      key: 'm',\r\n      ctrl: true,\r\n      description: 'Toggle device mode',\r\n      action: handlers.onToggleDeviceMode,\r\n    });\r\n  }\r\n\r\n  if (handlers.onShowHelp) {\r\n    shortcuts.push({\r\n      key: '/',\r\n      ctrl: true,\r\n      description: 'Show keyboard shortcuts',\r\n      action: handlers.onShowHelp,\r\n    });\r\n  }\r\n\r\n  if (handlers.onSelectAll) {\r\n    shortcuts.push({\r\n      key: 'a',\r\n      ctrl: true,\r\n      description: 'Select all blocks',\r\n      action: handlers.onSelectAll,\r\n    });\r\n  }\r\n\r\n  if (handlers.onDeselectAll) {\r\n    shortcuts.push({\r\n      key: 'Escape',\r\n      description: 'Deselect all',\r\n      action: handlers.onDeselectAll,\r\n    });\r\n  }\r\n\r\n  return shortcuts;\r\n}\r\n\r\n/**\r\n * Format shortcut for display\r\n */\r\nexport function formatShortcut(shortcut: KeyboardShortcut): string {\r\n  const parts: string[] = [];\r\n\r\n  if (shortcut.ctrl || shortcut.meta) {\r\n    parts.push('Ctrl');\r\n  }\r\n  if (shortcut.shift) {\r\n    parts.push('Shift');\r\n  }\r\n  if (shortcut.alt) {\r\n    parts.push('Alt');\r\n  }\r\n\r\n  parts.push(shortcut.key.charAt(0).toUpperCase() + shortcut.key.slice(1));\r\n\r\n  return parts.join('+');\r\n}\r\n"],"names":[],"mappings":"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"}},{"offset":{"line":1134,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/hooks/useEnhancedPageEditor.ts"],"sourcesContent":["/**\r\n * Enhanced Page Editor Hook\r\n *\r\n * Supports:\r\n * - Nested containers with children\r\n * - Three-tab configuration (content, style, advanced)\r\n * - Move blocks between containers\r\n * - Visibility toggling\r\n * - Hover state management\r\n * - Clipboard operations\r\n */\r\n\r\nimport { useState, useCallback, useEffect, useRef } from 'react';\r\nimport { toast } from 'react-hot-toast';\r\nimport { useRouter } from 'next/navigation';\r\nimport { EditorBlock, PageData, ContainerType, ClipboardData, DeviceMode } from '@/types/editor';\r\nimport {\r\n  buildBlockTree,\r\n  flattenBlockTree,\r\n  findBlockById,\r\n  updateBlockInTree,\r\n  removeBlockFromTree,\r\n  duplicateBlock as utilDuplicateBlock,\r\n  normalizeBlockOrders,\r\n  splitConfigIntoTabs,\r\n} from '@/lib/editor-utils';\r\n\r\ninterface UseEnhancedPageEditorProps {\r\n  pageId: string;\r\n  initialBlocks?: EditorBlock[];\r\n  initialPageData?: Partial<PageData>;\r\n  autoSaveEnabled?: boolean;\r\n  autoSaveDelay?: number;\r\n  templates?: any[];\r\n}\r\n\r\nexport function useEnhancedPageEditor({\r\n  pageId,\r\n  initialBlocks = [],\r\n  initialPageData = {},\r\n  autoSaveEnabled = true,\r\n  autoSaveDelay = 2000,\r\n  templates = [],\r\n}: UseEnhancedPageEditorProps) {\r\n  const router = useRouter();\r\n\r\n  // Core state\r\n  const [blocks, setBlocks] = useState<EditorBlock[]>(initialBlocks);\r\n  const [pageData, setPageData] = useState<Partial<PageData>>(initialPageData);\r\n  const [selectedBlockId, setSelectedBlockId] = useState<string | null>(null);\r\n  const [hoveredBlockId, setHoveredBlockId] = useState<string | null>(null);\r\n  const [deviceMode, setDeviceMode] = useState<DeviceMode>(DeviceMode.DESKTOP);\r\n  const [clipboard, setClipboard] = useState<ClipboardData | null>(null);\r\n\r\n  // Save state\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [isDirty, setIsDirty] = useState(false);\r\n  const [autoSaveStatus, setAutoSaveStatus] = useState<'idle' | 'saving' | 'saved' | 'error'>('idle');\r\n  const autoSaveTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n  const lastSavedStateRef = useRef<string>('');\r\n\r\n  // History state (Undo/Redo)\r\n  const [history, setHistory] = useState<Array<{ blocks: EditorBlock[]; pageData: Partial<PageData> }>>([]);\r\n  const [historyIndex, setHistoryIndex] = useState(-1);\r\n  const maxHistorySize = 50;\r\n  const historyUpdateTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Initialize blocks\r\n  useEffect(() => {\r\n    if (initialBlocks.length > 0 && blocks.length === 0) {\r\n      setBlocks(initialBlocks);\r\n      setHistory([{ blocks: initialBlocks, pageData: initialPageData }]);\r\n      setHistoryIndex(0);\r\n    }\r\n  }, [initialBlocks, blocks.length, initialPageData]);\r\n\r\n  // Save to history (debounced)\r\n  const saveToHistory = useCallback(\r\n    (blocksToSave: EditorBlock[], pageDataToSave: Partial<PageData>) => {\r\n      if (historyUpdateTimeoutRef.current) {\r\n        clearTimeout(historyUpdateTimeoutRef.current);\r\n      }\r\n\r\n      historyUpdateTimeoutRef.current = setTimeout(() => {\r\n        setHistory((prev) => {\r\n          const newHistory = prev.slice(0, historyIndex + 1);\r\n          newHistory.push({ blocks: blocksToSave, pageData: pageDataToSave });\r\n\r\n          if (newHistory.length > maxHistorySize) {\r\n            newHistory.shift();\r\n            return newHistory;\r\n          }\r\n\r\n          return newHistory;\r\n        });\r\n        setHistoryIndex((prev) => Math.min(prev + 1, maxHistorySize - 1));\r\n      }, 500);\r\n    },\r\n    [historyIndex, maxHistorySize]\r\n  );\r\n\r\n  // Undo/Redo\r\n  const undo = useCallback(() => {\r\n    if (historyIndex > 0) {\r\n      const newIndex = historyIndex - 1;\r\n      const state = history[newIndex];\r\n      setBlocks(state.blocks);\r\n      setPageData(state.pageData);\r\n      setHistoryIndex(newIndex);\r\n      setIsDirty(true);\r\n    }\r\n  }, [history, historyIndex]);\r\n\r\n  const redo = useCallback(() => {\r\n    if (historyIndex < history.length - 1) {\r\n      const newIndex = historyIndex + 1;\r\n      const state = history[newIndex];\r\n      setBlocks(state.blocks);\r\n      setPageData(state.pageData);\r\n      setHistoryIndex(newIndex);\r\n      setIsDirty(true);\r\n    }\r\n  }, [history, historyIndex]);\r\n\r\n  const canUndo = historyIndex > 0;\r\n  const canRedo = historyIndex < history.length - 1;\r\n\r\n  // LocalStorage backup\r\n  const saveToLocalStorage = useCallback(\r\n    (blocksToSave: EditorBlock[], pageDataToSave: Partial<PageData>) => {\r\n      const storageKey = `cms-editor-${pageId}`;\r\n      try {\r\n        localStorage.setItem(\r\n          storageKey,\r\n          JSON.stringify({\r\n            blocks: blocksToSave,\r\n            pageData: pageDataToSave,\r\n            timestamp: Date.now(),\r\n          })\r\n        );\r\n      } catch (error) {\r\n        console.error('Failed to save to localStorage:', error);\r\n      }\r\n    },\r\n    [pageId]\r\n  );\r\n\r\n  const clearLocalStorage = useCallback(() => {\r\n    const storageKey = `cms-editor-${pageId}`;\r\n    try {\r\n      localStorage.removeItem(storageKey);\r\n    } catch (error) {\r\n      console.error('Failed to clear localStorage:', error);\r\n    }\r\n  }, [pageId]);\r\n\r\n  // Load from localStorage\r\n  useEffect(() => {\r\n    const storageKey = `cms-editor-${pageId}`;\r\n    try {\r\n      const saved = localStorage.getItem(storageKey);\r\n      if (saved) {\r\n        const parsed = JSON.parse(saved);\r\n        if (parsed.blocks && parsed.blocks.length > 0) {\r\n          setBlocks(parsed.blocks);\r\n        }\r\n        if (parsed.pageData) {\r\n          setPageData(parsed.pageData);\r\n        }\r\n        setIsDirty(true);\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load from localStorage:', error);\r\n    }\r\n  }, [pageId]);\r\n\r\n  // Block operations\r\n  const generateBlockId = () => `temp-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n  const addBlock = useCallback(\r\n    (template: any, parentId?: string | null) => {\r\n      const { contentConfig, styleConfig, advancedConfig } = splitConfigIntoTabs(\r\n        template.defaultConfig || {},\r\n        template.configSchema\r\n      );\r\n\r\n      const newBlock: EditorBlock = {\r\n        id: generateBlockId(),\r\n        templateId: template.id,\r\n        containerType: ContainerType.BLOCK,\r\n        parentId: parentId || null,\r\n        contentConfig,\r\n        styleConfig,\r\n        advancedConfig,\r\n        config: template.defaultConfig, // Keep for backwards compatibility\r\n        order: blocks.filter((b) => b.parentId === parentId).length,\r\n        isVisible: true,\r\n        template,\r\n      };\r\n\r\n      setBlocks((prev) => {\r\n        const updated = [...prev, newBlock];\r\n        saveToHistory(updated, pageData);\r\n        return updated;\r\n      });\r\n      setSelectedBlockId(newBlock.id);\r\n      setIsDirty(true);\r\n    },\r\n    [blocks, pageData, saveToHistory]\r\n  );\r\n\r\n  const addContainerBlock = useCallback(\r\n    (containerType: ContainerType, parentId?: string | null) => {\r\n      // Find the appropriate container template based on container type\r\n      const templateSlug =\r\n        containerType === ContainerType.SECTION ? 'section-container' :\r\n        containerType === ContainerType.FLEXBOX ? 'flexbox-container' :\r\n        containerType === ContainerType.GRID ? 'grid-container' :\r\n        'container';\r\n\r\n      const containerTemplate = templates.find(t => t.slug === templateSlug);\r\n\r\n      if (!containerTemplate) {\r\n        toast.error(`Container template \"${templateSlug}\" not found. Please run the container templates seed script.`);\r\n        console.error(`Container template not found for slug: ${templateSlug}`);\r\n        return;\r\n      }\r\n\r\n      const newBlock: EditorBlock = {\r\n        id: generateBlockId(),\r\n        templateId: containerTemplate.id,\r\n        template: containerTemplate,\r\n        containerType,\r\n        parentId: parentId || null,\r\n        contentConfig: containerTemplate.defaultConfig || {},\r\n        styleConfig: {},\r\n        advancedConfig: {},\r\n        layoutSettings:\r\n          containerType === ContainerType.FLEXBOX\r\n            ? {\r\n                direction: 'row',\r\n                wrap: 'nowrap',\r\n                justifyContent: 'flex-start',\r\n                alignItems: 'stretch',\r\n                gap: 16,\r\n              }\r\n            : containerType === ContainerType.GRID\r\n            ? {\r\n                columns: 2,\r\n                columnGap: 16,\r\n                rowGap: 16,\r\n              }\r\n            : undefined,\r\n        order: blocks.filter((b) => b.parentId === parentId).length,\r\n        isVisible: true,\r\n        children: [],\r\n      };\r\n\r\n      setBlocks((prev) => {\r\n        const updated = [...prev, newBlock];\r\n        saveToHistory(updated, pageData);\r\n        return updated;\r\n      });\r\n      setSelectedBlockId(newBlock.id);\r\n      setIsDirty(true);\r\n    },\r\n    [blocks, pageData, saveToHistory, templates]\r\n  );\r\n\r\n  const updateBlockConfig = useCallback(\r\n    (blockId: string, tab: 'content' | 'style' | 'advanced', newConfig: any) => {\r\n      setBlocks((prev) => {\r\n        const updated = prev.map((block) => {\r\n          if (block.id === blockId) {\r\n            return {\r\n              ...block,\r\n              [`${tab}Config`]: newConfig,\r\n            };\r\n          }\r\n          return block;\r\n        });\r\n        saveToHistory(updated, pageData);\r\n        return updated;\r\n      });\r\n      setIsDirty(true);\r\n    },\r\n    [pageData, saveToHistory]\r\n  );\r\n\r\n  const removeBlock = useCallback(\r\n    (blockId: string) => {\r\n      setBlocks((prev) => {\r\n        const blockTree = buildBlockTree(prev);\r\n        const withoutBlock = removeBlockFromTree(blockTree, blockId);\r\n        const flattened = flattenBlockTree(withoutBlock);\r\n        const normalized = normalizeBlockOrders(flattened);\r\n        saveToHistory(normalized, pageData);\r\n        return normalized;\r\n      });\r\n      if (selectedBlockId === blockId) {\r\n        setSelectedBlockId(null);\r\n      }\r\n      setIsDirty(true);\r\n    },\r\n    [selectedBlockId, pageData, saveToHistory]\r\n  );\r\n\r\n  const duplicateBlock = useCallback(\r\n    (blockId: string) => {\r\n      const blockToDuplicate = findBlockById(blocks, blockId);\r\n      if (!blockToDuplicate) return;\r\n\r\n      const duplicated = utilDuplicateBlock(blockToDuplicate, generateBlockId);\r\n\r\n      setBlocks((prev) => {\r\n        const updated = [...prev, duplicated];\r\n        saveToHistory(updated, pageData);\r\n        return updated;\r\n      });\r\n      setSelectedBlockId(duplicated.id);\r\n      setIsDirty(true);\r\n    },\r\n    [blocks, pageData, saveToHistory]\r\n  );\r\n\r\n  const moveBlock = useCallback(\r\n    (blockId: string, newParentId: string | null, newOrder: number) => {\r\n      setBlocks((prev) => {\r\n        const block = findBlockById(prev, blockId);\r\n        if (!block) return prev;\r\n\r\n        // Update block's parent and order\r\n        const updatedBlock = {\r\n          ...block,\r\n          parentId: newParentId,\r\n          order: newOrder,\r\n        };\r\n\r\n        const updated = prev.map((b) => (b.id === blockId ? updatedBlock : b));\r\n        const normalized = normalizeBlockOrders(updated);\r\n        saveToHistory(normalized, pageData);\r\n        return normalized;\r\n      });\r\n      setIsDirty(true);\r\n    },\r\n    [pageData, saveToHistory]\r\n  );\r\n\r\n  const reorderBlocks = useCallback(\r\n    (newBlocks: EditorBlock[]) => {\r\n      const normalized = normalizeBlockOrders(newBlocks);\r\n      setBlocks(normalized);\r\n      saveToHistory(normalized, pageData);\r\n      setIsDirty(true);\r\n    },\r\n    [pageData, saveToHistory]\r\n  );\r\n\r\n  const toggleBlockVisibility = useCallback(\r\n    (blockId: string) => {\r\n      setBlocks((prev) => {\r\n        const updated = prev.map((block) =>\r\n          block.id === blockId ? { ...block, isVisible: !block.isVisible } : block\r\n        );\r\n        saveToHistory(updated, pageData);\r\n        return updated;\r\n      });\r\n      setIsDirty(true);\r\n    },\r\n    [pageData, saveToHistory]\r\n  );\r\n\r\n  // Clipboard operations\r\n  const copyBlock = useCallback((blockId: string) => {\r\n    const block = findBlockById(blocks, blockId);\r\n    if (block) {\r\n      setClipboard({\r\n        type: 'block',\r\n        data: block,\r\n        timestamp: Date.now(),\r\n      });\r\n      toast.success('Block copied to clipboard');\r\n    }\r\n  }, [blocks]);\r\n\r\n  const copyStyle = useCallback((blockId: string) => {\r\n    const block = findBlockById(blocks, blockId);\r\n    if (block && block.styleConfig) {\r\n      setClipboard({\r\n        type: 'style',\r\n        data: block.styleConfig,\r\n        timestamp: Date.now(),\r\n      });\r\n      toast.success('Style copied to clipboard');\r\n    }\r\n  }, [blocks]);\r\n\r\n  const pasteBlock = useCallback(\r\n    (parentId?: string | null) => {\r\n      if (!clipboard || clipboard.type !== 'block') return;\r\n\r\n      const block = clipboard.data as EditorBlock;\r\n      const duplicated = utilDuplicateBlock(block, generateBlockId);\r\n      duplicated.parentId = parentId || null;\r\n      duplicated.order = blocks.filter((b) => b.parentId === parentId).length;\r\n\r\n      setBlocks((prev) => {\r\n        const updated = [...prev, duplicated];\r\n        saveToHistory(updated, pageData);\r\n        return updated;\r\n      });\r\n      setSelectedBlockId(duplicated.id);\r\n      setIsDirty(true);\r\n      toast.success('Block pasted');\r\n    },\r\n    [clipboard, blocks, pageData, saveToHistory]\r\n  );\r\n\r\n  const pasteStyle = useCallback(\r\n    (blockId: string) => {\r\n      if (!clipboard || clipboard.type !== 'style') return;\r\n\r\n      updateBlockConfig(blockId, 'style', clipboard.data);\r\n      toast.success('Style pasted');\r\n    },\r\n    [clipboard, updateBlockConfig]\r\n  );\r\n\r\n  // Page data operations\r\n  const updatePageData = useCallback(\r\n    (field: string, value: any) => {\r\n      setPageData((prev) => {\r\n        const updated = { ...prev, [field]: value };\r\n        saveToHistory(blocks, updated);\r\n        return updated;\r\n      });\r\n      setIsDirty(true);\r\n    },\r\n    [blocks, saveToHistory]\r\n  );\r\n\r\n  // Save page\r\n  const savePage = useCallback(\r\n    async (isAutoSave = false) => {\r\n      setIsSaving(true);\r\n      if (isAutoSave) {\r\n        setAutoSaveStatus('saving');\r\n      }\r\n\r\n      try {\r\n        // Save page data\r\n        const pageResponse = await fetch(`/api/admin/cms/pages/${pageId}`, {\r\n          method: 'PUT',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(pageData),\r\n        });\r\n\r\n        if (!pageResponse.ok) {\r\n          const errorData = await pageResponse.json().catch(() => ({}));\r\n          throw new Error(errorData.error || 'Failed to save page data');\r\n        }\r\n\r\n        // Sync blocks\r\n        const blocksResponse = await fetch(`/api/admin/cms/pages/${pageId}/sync-blocks`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({\r\n            blocks: blocks.map((block) => ({\r\n              id: block.id,\r\n              templateId: block.templateId,\r\n              containerType: block.containerType,\r\n              parentId: block.parentId,\r\n              contentConfig: block.contentConfig,\r\n              styleConfig: block.styleConfig,\r\n              advancedConfig: block.advancedConfig,\r\n              layoutSettings: block.layoutSettings,\r\n              order: block.order,\r\n              isVisible: block.isVisible,\r\n              // Keep legacy config for backwards compatibility\r\n              config: block.config || block.contentConfig,\r\n            })),\r\n          }),\r\n        });\r\n\r\n        if (!blocksResponse.ok) {\r\n          throw new Error('Failed to save blocks');\r\n        }\r\n\r\n        const data = await blocksResponse.json();\r\n\r\n        if (data.page?.blocks) {\r\n          const updatedBlocks = data.page.blocks.map((block: any) => {\r\n            const existingBlock = blocks.find(\r\n              (b) => b.id === block.id || (b.templateId === block.templateId && b.order === block.order)\r\n            );\r\n\r\n            return {\r\n              ...block,\r\n              template: block.template || existingBlock?.template,\r\n            };\r\n          });\r\n\r\n          setBlocks(updatedBlocks);\r\n          lastSavedStateRef.current = JSON.stringify({ blocks: updatedBlocks, pageData });\r\n        }\r\n\r\n        setIsDirty(false);\r\n        if (isAutoSave) {\r\n          setAutoSaveStatus('saved');\r\n          clearLocalStorage();\r\n          setTimeout(() => setAutoSaveStatus('idle'), 2000);\r\n        } else {\r\n          toast.success('Page saved successfully');\r\n          clearLocalStorage();\r\n        }\r\n\r\n        router.refresh();\r\n      } catch (error: any) {\r\n        console.error('Error saving page:', error);\r\n        if (isAutoSave) {\r\n          setAutoSaveStatus('error');\r\n          setTimeout(() => setAutoSaveStatus('idle'), 3000);\r\n        } else {\r\n          toast.error(error.message || 'Failed to save page');\r\n        }\r\n      } finally {\r\n        setIsSaving(false);\r\n      }\r\n    },\r\n    [blocks, pageId, pageData, router, clearLocalStorage]\r\n  );\r\n\r\n  // Auto-save\r\n  useEffect(() => {\r\n    if (!autoSaveEnabled || !isDirty) {\r\n      return;\r\n    }\r\n\r\n    if (autoSaveTimeoutRef.current) {\r\n      clearTimeout(autoSaveTimeoutRef.current);\r\n    }\r\n\r\n    saveToLocalStorage(blocks, pageData);\r\n\r\n    autoSaveTimeoutRef.current = setTimeout(() => {\r\n      const currentState = JSON.stringify({ blocks, pageData });\r\n      if (currentState !== lastSavedStateRef.current) {\r\n        savePage(true);\r\n      }\r\n    }, autoSaveDelay);\r\n\r\n    return () => {\r\n      if (autoSaveTimeoutRef.current) {\r\n        clearTimeout(autoSaveTimeoutRef.current);\r\n      }\r\n    };\r\n  }, [blocks, pageData, isDirty, autoSaveEnabled, autoSaveDelay, savePage, saveToLocalStorage]);\r\n\r\n  return {\r\n    // State\r\n    blocks,\r\n    pageData,\r\n    selectedBlockId,\r\n    hoveredBlockId,\r\n    deviceMode,\r\n    clipboard,\r\n    isSaving,\r\n    isDirty,\r\n    autoSaveStatus,\r\n    canUndo,\r\n    canRedo,\r\n\r\n    // Block operations\r\n    addBlock,\r\n    addContainerBlock,\r\n    updateBlockConfig,\r\n    removeBlock,\r\n    duplicateBlock,\r\n    moveBlock,\r\n    reorderBlocks,\r\n    toggleBlockVisibility,\r\n\r\n    // Clipboard\r\n    copyBlock,\r\n    copyStyle,\r\n    pasteBlock,\r\n    pasteStyle,\r\n\r\n    // Page operations\r\n    updatePageData,\r\n    savePage,\r\n\r\n    // History\r\n    undo,\r\n    redo,\r\n\r\n    // UI state\r\n    setSelectedBlockId,\r\n    setHoveredBlockId,\r\n    setDeviceMode,\r\n  };\r\n}\r\n"],"names":[],"mappings":"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"}},{"offset":{"line":1710,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/contexts/ThemeContext.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { ThemeConfig } from '@/lib/themes/theme-schema';\r\n\r\ninterface ThemeContextType {\r\n  theme: ThemeConfig | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  refreshTheme: () => Promise<void>;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\r\n\r\nexport function useThemeContext() {\r\n  const context = useContext(ThemeContext);\r\n  if (context === undefined) {\r\n    throw new Error('useThemeContext must be used within a ThemeProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\ninterface ThemeProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function ThemeProvider({ children }: ThemeProviderProps) {\r\n  const [theme, setTheme] = useState<ThemeConfig | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const fetchActiveTheme = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const response = await fetch('/api/themes/active', {\r\n        cache: 'no-store',\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch active theme');\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.theme) {\r\n        setTheme(data.theme);\r\n      } else {\r\n        setTheme(null);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching theme:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to load theme');\r\n      setTheme(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchActiveTheme();\r\n  }, []);\r\n\r\n  return (\r\n    <ThemeContext.Provider\r\n      value={{\r\n        theme,\r\n        loading,\r\n        error,\r\n        refreshTheme: fetchActiveTheme,\r\n      }}\r\n    >\r\n      {children}\r\n    </ThemeContext.Provider>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AAYA,MAAM,6BAAe,IAAA,sNAAa,EAA+B;AAE1D,SAAS;IACd,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AAMO,SAAS,cAAc,EAAE,QAAQ,EAAsB;IAC5D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAqB;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAElD,MAAM,mBAAmB;QACvB,IAAI;YACF,WAAW;YACX,SAAS;YACT,MAAM,WAAW,MAAM,MAAM,sBAAsB;gBACjD,OAAO;YACT;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,IAAI,KAAK,KAAK,EAAE;gBACd,SAAS,KAAK,KAAK;YACrB,OAAO;gBACL,SAAS;YACX;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yBAAyB;YACvC,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;YAC9C,SAAS;QACX,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAA,kNAAS,EAAC;QACR;IACF,GAAG,EAAE;IAEL,qBACE,8OAAC,aAAa,QAAQ;QACpB,OAAO;YACL;YACA;YACA;YACA,cAAc;QAChB;kBAEC;;;;;;AAGP"}},{"offset":{"line":1778,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/types/editor.ts"],"sourcesContent":["/**\r\n * CMS Page Editor Types\r\n *\r\n * Comprehensive type definitions for the Elementor-style page builder\r\n * with support for nested containers, three-tab configuration, and advanced features.\r\n */\r\n\r\n// ============================================\r\n// Enums\r\n// ============================================\r\n\r\nexport enum ContainerType {\r\n  BLOCK = 'BLOCK',       // Regular block (no children)\r\n  SECTION = 'SECTION',   // Full-width section container\r\n  FLEXBOX = 'FLEXBOX',   // Flexbox container\r\n  GRID = 'GRID',         // Grid container\r\n}\r\n\r\nexport enum BlockCategory {\r\n  HERO = 'HERO',\r\n  CONTENT = 'CONTENT',\r\n  FEATURES = 'FEATURES',\r\n  CTA = 'CTA',\r\n  TESTIMONIALS = 'TESTIMONIALS',\r\n  PRICING = 'PRICING',\r\n  TEAM = 'TEAM',\r\n  STATS = 'STATS',\r\n  LOGO_GRID = 'LOGO_GRID',\r\n  FORM = 'FORM',\r\n  FAQ = 'FAQ',\r\n  GALLERY = 'GALLERY',\r\n  VIDEO = 'VIDEO',\r\n  NAVIGATION = 'NAVIGATION',\r\n  HEADER = 'HEADER',\r\n  FOOTER = 'FOOTER',\r\n  SOCIAL = 'SOCIAL',\r\n  BREADCRUMBS = 'BREADCRUMBS',\r\n  DIVIDER = 'DIVIDER',\r\n  SPACER = 'SPACER',\r\n  CUSTOM = 'CUSTOM',\r\n  PRODUCT = 'PRODUCT',\r\n  BLOG = 'BLOG',\r\n  CONTAINER = 'CONTAINER',\r\n  LAYOUT = 'LAYOUT',\r\n}\r\n\r\nexport enum DeviceMode {\r\n  DESKTOP = 'DESKTOP',\r\n  TABLET = 'TABLET',\r\n  MOBILE = 'MOBILE',\r\n}\r\n\r\n// ============================================\r\n// Block Template & Instance Types\r\n// ============================================\r\n\r\nexport interface BlockTemplate {\r\n  id: string;\r\n  name: string;\r\n  slug: string;\r\n  description?: string;\r\n  category: BlockCategory;\r\n  thumbnail?: string;\r\n  previewUrl?: string;\r\n  defaultConfig: Record<string, any>;\r\n  configSchema: ConfigSchema;\r\n  componentCode: string;\r\n  htmlTemplate?: string;\r\n  cssStyles?: string;\r\n  isSystem: boolean;\r\n  isActive: boolean;\r\n  isPro: boolean;\r\n  usageCount: number;\r\n}\r\n\r\n// ============================================\r\n// Three-Tab Configuration Types\r\n// ============================================\r\n\r\nexport interface ContentConfig {\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface StyleConfig {\r\n  // Colors\r\n  backgroundColor?: string;\r\n  textColor?: string;\r\n  borderColor?: string;\r\n\r\n  // Typography\r\n  fontSize?: string;\r\n  fontFamily?: string;\r\n  fontWeight?: string;\r\n  lineHeight?: string;\r\n  letterSpacing?: string;\r\n  textAlign?: 'left' | 'center' | 'right' | 'justify';\r\n\r\n  // Spacing\r\n  padding?: {\r\n    top?: number;\r\n    right?: number;\r\n    bottom?: number;\r\n    left?: number;\r\n  };\r\n  margin?: {\r\n    top?: number;\r\n    right?: number;\r\n    bottom?: number;\r\n    left?: number;\r\n  };\r\n\r\n  // Border\r\n  borderWidth?: number;\r\n  borderStyle?: 'solid' | 'dashed' | 'dotted' | 'double' | 'none';\r\n  borderRadius?: {\r\n    topLeft?: number;\r\n    topRight?: number;\r\n    bottomRight?: number;\r\n    bottomLeft?: number;\r\n  };\r\n\r\n  // Background\r\n  backgroundImage?: string;\r\n  backgroundSize?: 'cover' | 'contain' | 'auto';\r\n  backgroundPosition?: string;\r\n  backgroundRepeat?: 'repeat' | 'no-repeat' | 'repeat-x' | 'repeat-y';\r\n\r\n  // Shadow\r\n  boxShadow?: string;\r\n  textShadow?: string;\r\n\r\n  // Size\r\n  width?: string;\r\n  height?: string;\r\n  maxWidth?: string;\r\n  maxHeight?: string;\r\n  minWidth?: string;\r\n  minHeight?: string;\r\n\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface AdvancedConfig {\r\n  // Custom CSS & Classes\r\n  customCss?: string;\r\n  customClasses?: string;\r\n\r\n  // Positioning\r\n  position?: 'static' | 'relative' | 'absolute' | 'fixed' | 'sticky';\r\n  top?: number;\r\n  right?: number;\r\n  bottom?: number;\r\n  left?: number;\r\n  zIndex?: number;\r\n\r\n  // Display\r\n  display?: 'block' | 'inline' | 'inline-block' | 'flex' | 'grid' | 'none';\r\n  overflow?: 'visible' | 'hidden' | 'scroll' | 'auto';\r\n\r\n  // Animation\r\n  animationType?: string;\r\n  animationDelay?: number;\r\n  animationDuration?: number;\r\n  animationEasing?: string;\r\n\r\n  // Visibility Rules\r\n  hideOnMobile?: boolean;\r\n  hideOnTablet?: boolean;\r\n  hideOnDesktop?: boolean;\r\n  visibilityRules?: VisibilityRule[];\r\n\r\n  // Advanced Features\r\n  customAttributes?: Record<string, string>;\r\n  customData?: Record<string, any>;\r\n\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface VisibilityRule {\r\n  type: 'user_role' | 'date_range' | 'time_range' | 'device' | 'custom';\r\n  condition: Record<string, any>;\r\n}\r\n\r\n// ============================================\r\n// Layout Settings (for containers)\r\n// ============================================\r\n\r\nexport interface FlexboxSettings {\r\n  direction: 'row' | 'column' | 'row-reverse' | 'column-reverse';\r\n  wrap: 'nowrap' | 'wrap' | 'wrap-reverse';\r\n  justifyContent: 'flex-start' | 'flex-end' | 'center' | 'space-between' | 'space-around' | 'space-evenly';\r\n  alignItems: 'flex-start' | 'flex-end' | 'center' | 'baseline' | 'stretch';\r\n  alignContent?: 'flex-start' | 'flex-end' | 'center' | 'space-between' | 'space-around' | 'stretch';\r\n  gap?: number;\r\n}\r\n\r\nexport interface GridSettings {\r\n  columns: number | string;\r\n  rows?: number | string;\r\n  columnGap?: number;\r\n  rowGap?: number;\r\n  autoFlow?: 'row' | 'column' | 'row dense' | 'column dense';\r\n  justifyItems?: 'start' | 'end' | 'center' | 'stretch';\r\n  alignItems?: 'start' | 'end' | 'center' | 'stretch';\r\n}\r\n\r\nexport type LayoutSettings = FlexboxSettings | GridSettings | Record<string, any>;\r\n\r\n// ============================================\r\n// Editor Block Type\r\n// ============================================\r\n\r\nexport interface EditorBlock {\r\n  id: string;\r\n  templateId: string;\r\n\r\n  // Container support\r\n  containerType: ContainerType;\r\n  parentId?: string | null;\r\n  children?: EditorBlock[];\r\n\r\n  // Three-tab configuration\r\n  contentConfig: ContentConfig;\r\n  styleConfig?: StyleConfig;\r\n  advancedConfig?: AdvancedConfig;\r\n\r\n  // Layout settings (for containers)\r\n  layoutSettings?: LayoutSettings;\r\n\r\n  // Legacy config (backwards compatibility)\r\n  config?: Record<string, any>;\r\n\r\n  // Position\r\n  order: number;\r\n\r\n  // Visibility\r\n  isVisible: boolean;\r\n\r\n  // Template reference (populated when loaded)\r\n  template?: BlockTemplate;\r\n}\r\n\r\n// ============================================\r\n// Config Schema Types\r\n// ============================================\r\n\r\nexport interface ConfigField {\r\n  type: 'text' | 'textarea' | 'number' | 'image' | 'color' | 'select' | 'toggle' | 'slider' | 'repeater' | 'rich_text' | 'date';\r\n  name: string;\r\n  label: string;\r\n  placeholder?: string;\r\n  defaultValue?: any;\r\n  required?: boolean;\r\n  description?: string;\r\n\r\n  // Validation\r\n  min?: number;\r\n  max?: number;\r\n  step?: number;\r\n  minLength?: number;\r\n  maxLength?: number;\r\n  pattern?: string;\r\n\r\n  // Select options\r\n  options?: Array<{ label: string; value: any }>;\r\n\r\n  // Repeater fields\r\n  fields?: ConfigField[];\r\n  minItems?: number;\r\n  maxItems?: number;\r\n\r\n  // Conditional visibility\r\n  condition?: {\r\n    field: string;\r\n    operator: 'equals' | 'notEquals' | 'contains' | 'greaterThan' | 'lessThan' | 'empty' | 'notEmpty';\r\n    value: any;\r\n  };\r\n\r\n  // Tab assignment\r\n  tab?: 'content' | 'style' | 'advanced';\r\n\r\n  [key: string]: any;\r\n}\r\n\r\nexport interface ConfigSection {\r\n  id: string;\r\n  label: string;\r\n  icon?: string;\r\n  fields: ConfigField[];\r\n  collapsible?: boolean;\r\n  collapsed?: boolean;\r\n}\r\n\r\nexport interface ConfigTab {\r\n  id: 'content' | 'style' | 'advanced' | string;\r\n  label: string;\r\n  icon?: string;\r\n  sections?: ConfigSection[];\r\n  fields?: ConfigField[];\r\n}\r\n\r\nexport interface ConfigSchema {\r\n  // Can use tabs, sections, or flat fields\r\n  tabs?: ConfigTab[];\r\n  sections?: ConfigSection[];\r\n  fields?: ConfigField[];\r\n}\r\n\r\n// ============================================\r\n// Page Data Types\r\n// ============================================\r\n\r\nexport interface PageData {\r\n  id: string;\r\n  title: string;\r\n  slug: string;\r\n  description?: string;\r\n  status: 'DRAFT' | 'PUBLISHED' | 'SCHEDULED' | 'ARCHIVED';\r\n  useBlockEditor: boolean;\r\n\r\n  // SEO\r\n  seoTitle?: string;\r\n  seoDescription?: string;\r\n  seoKeywords?: string;\r\n  ogImage?: string;\r\n\r\n  // Layout config\r\n  layoutConfig?: Record<string, any>;\r\n  customCss?: string;\r\n  customJs?: string;\r\n\r\n  // Publishing\r\n  publishedAt?: string | Date;\r\n  scheduledPublishAt?: string | Date;\r\n}\r\n\r\n// ============================================\r\n// Editor State Types\r\n// ============================================\r\n\r\nexport interface EditorState {\r\n  blocks: EditorBlock[];\r\n  selectedBlockId: string | null;\r\n  hoveredBlockId: string | null;\r\n  deviceMode: DeviceMode;\r\n  isDirty: boolean;\r\n  isSaving: boolean;\r\n  pageData: PageData;\r\n}\r\n\r\nexport interface EditorHistory {\r\n  blocks: EditorBlock[];\r\n  pageData: PageData;\r\n  timestamp: number;\r\n}\r\n\r\n// ============================================\r\n// Navigator Types\r\n// ============================================\r\n\r\nexport interface NavigatorNode {\r\n  id: string;\r\n  label: string;\r\n  type: ContainerType;\r\n  isVisible: boolean;\r\n  isSelected: boolean;\r\n  isExpanded: boolean;\r\n  children?: NavigatorNode[];\r\n  depth: number;\r\n}\r\n\r\n// ============================================\r\n// Context Menu Types\r\n// ============================================\r\n\r\nexport interface ContextMenuItem {\r\n  id: string;\r\n  label: string;\r\n  icon?: string;\r\n  action: () => void;\r\n  shortcut?: string;\r\n  disabled?: boolean;\r\n  separator?: boolean;\r\n  submenu?: ContextMenuItem[];\r\n}\r\n\r\n// ============================================\r\n// Clipboard Types\r\n// ============================================\r\n\r\nexport interface ClipboardData {\r\n  type: 'block' | 'style';\r\n  data: EditorBlock | StyleConfig;\r\n  timestamp: number;\r\n}\r\n\r\n// ============================================\r\n// Export Types\r\n// ============================================\r\n\r\nexport type {\r\n  EditorBlock as default,\r\n};\r\n"],"names":[],"mappings":"AAAA;;;;;CAKC,GAED,+CAA+C;AAC/C,QAAQ;AACR,+CAA+C;;;;;;;;;AAExC,IAAA,AAAK,uCAAA;;;;;WAAA;;AAOL,IAAA,AAAK,uCAAA;;;;;;;;;;;;;;;;;;;;;;;;;;WAAA;;AA4BL,IAAA,AAAK,oCAAA;;;;WAAA"}}],"debugId":"cec6f4d5-81a9-58a4-bd75-6b193bddc06b"}