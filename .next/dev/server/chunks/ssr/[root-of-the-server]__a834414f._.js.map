{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/permissions.ts"],"sourcesContent":["import { UserRole } from '@prisma/client'\n\nexport type PermissionResource =\n  | 'PRODUCT'\n  | 'ORDER'\n  | 'CUSTOMER'\n  | 'CATEGORY'\n  | 'REVIEW'\n  | 'DISCOUNT'\n  | 'SETTINGS'\n  | 'ANALYTICS'\n  | 'FEATURES'\n  | 'ADMIN_USER'\n  | 'STOCK_ALERT'\n  | 'NEWSLETTER'\n  | 'REFUND'\n  | 'INVENTORY'\n  | 'SUPPLIER'\n  | 'PURCHASE_ORDER'\n\nexport type PermissionAction =\n  | 'VIEW'\n  | 'CREATE'\n  | 'UPDATE'\n  | 'DELETE'\n  | 'MANAGE'\n\n/**\n * Default permissions for each role\n * Format: \"RESOURCE:ACTION\"\n */\nconst ROLE_PERMISSIONS: Record<string, string[]> = {\n  SUPERADMIN: [\n    // Has ALL permissions including feature management\n    'PRODUCT:MANAGE',\n    'ORDER:MANAGE',\n    'CUSTOMER:MANAGE',\n    'CATEGORY:MANAGE',\n    'REVIEW:MANAGE',\n    'DISCOUNT:MANAGE',\n    'SETTINGS:MANAGE',\n    'ANALYTICS:MANAGE',\n    'FEATURES:MANAGE',\n    'ADMIN_USER:MANAGE',\n    'STOCK_ALERT:MANAGE',\n    'NEWSLETTER:MANAGE',\n    'REFUND:MANAGE',\n    'INVENTORY:MANAGE',\n    'SUPPLIER:MANAGE',\n    'PURCHASE_ORDER:MANAGE',\n  ],\n\n  ADMIN: [\n    // Has all permissions EXCEPT feature management\n    'PRODUCT:MANAGE',\n    'ORDER:MANAGE',\n    'CUSTOMER:MANAGE',\n    'CATEGORY:MANAGE',\n    'REVIEW:MANAGE',\n    'DISCOUNT:MANAGE',\n    'SETTINGS:MANAGE',\n    'ANALYTICS:MANAGE',\n    'ADMIN_USER:MANAGE',\n    'STOCK_ALERT:MANAGE',\n    'NEWSLETTER:MANAGE',\n    'REFUND:MANAGE',\n    'INVENTORY:MANAGE',\n    'SUPPLIER:MANAGE',\n    'PURCHASE_ORDER:MANAGE',\n  ],\n\n  MANAGER: [\n    // Can manage orders, view/update customers and products\n    'ORDER:MANAGE',\n    'CUSTOMER:VIEW',\n    'CUSTOMER:UPDATE',\n    'PRODUCT:VIEW',\n    'PRODUCT:UPDATE',\n    'PRODUCT:CREATE',\n    'CATEGORY:VIEW',\n    'REVIEW:VIEW',\n    'REVIEW:UPDATE',\n    'STOCK_ALERT:VIEW',\n    'REFUND:VIEW',\n    'REFUND:UPDATE',\n    'INVENTORY:MANAGE',\n    'SUPPLIER:VIEW',\n    'PURCHASE_ORDER:MANAGE',\n  ],\n\n  EDITOR: [\n    // Can edit products and categories\n    'PRODUCT:VIEW',\n    'PRODUCT:CREATE',\n    'PRODUCT:UPDATE',\n    'CATEGORY:MANAGE',\n    'REVIEW:VIEW',\n    'STOCK_ALERT:VIEW',\n  ],\n\n  SUPPORT: [\n    // View-only access to orders and customers\n    'ORDER:VIEW',\n    'CUSTOMER:VIEW',\n    'PRODUCT:VIEW',\n    'CATEGORY:VIEW',\n    'REVIEW:VIEW',\n    'REFUND:VIEW',\n  ],\n\n  VIEWER: [\n    // Read-only access to all resources\n    'PRODUCT:VIEW',\n    'ORDER:VIEW',\n    'CUSTOMER:VIEW',\n    'CATEGORY:VIEW',\n    'REVIEW:VIEW',\n    'DISCOUNT:VIEW',\n    'ANALYTICS:VIEW',\n    'STOCK_ALERT:VIEW',\n    'NEWSLETTER:VIEW',\n    'REFUND:VIEW',\n  ],\n\n  CUSTOMER: [],\n}\n\n/**\n * Get default permissions for a given role\n */\nexport function getDefaultPermissionsForRole(role: UserRole | string): string[] {\n  return ROLE_PERMISSIONS[role] || []\n}\n\n/**\n * Check if a role has a specific permission\n * MANAGE permission grants all sub-permissions (VIEW, CREATE, UPDATE, DELETE)\n */\nexport function hasPermission(\n  role: UserRole | string | undefined,\n  resource: PermissionResource | string,\n  action: PermissionAction | string\n): boolean {\n  if (!role) return false\n  \n  // SUPERADMIN has all permissions\n  if (role === 'SUPERADMIN') return true\n\n  const permissions = getDefaultPermissionsForRole(role)\n  \n  // Check exact permission\n  const exactPermission = `${resource}:${action}`\n  if (permissions.includes(exactPermission)) return true\n\n  // If resource has MANAGE permission, it includes all actions\n  const managePermission = `${resource}:MANAGE`\n  if (permissions.includes(managePermission)) {\n    // MANAGE grants VIEW, CREATE, UPDATE, DELETE\n    if (['VIEW', 'CREATE', 'UPDATE', 'DELETE'].includes(action)) {\n      return true\n    }\n  }\n\n  return false\n}\n\n/**\n * Helper functions for common permission checks\n */\nexport function canViewResource(role: UserRole | string, resource: PermissionResource): boolean {\n  return hasPermission(role, resource, 'VIEW')\n}\n\nexport function canCreateResource(role: UserRole | string, resource: PermissionResource): boolean {\n  return hasPermission(role, resource, 'CREATE')\n}\n\nexport function canUpdateResource(role: UserRole | string, resource: PermissionResource): boolean {\n  return hasPermission(role, resource, 'UPDATE')\n}\n\nexport function canDeleteResource(role: UserRole | string, resource: PermissionResource): boolean {\n  return hasPermission(role, resource, 'DELETE')\n}\n\nexport function canManageResource(role: UserRole | string, resource: PermissionResource): boolean {\n  return hasPermission(role, resource, 'MANAGE')\n}\n\n/**\n * Check if user is an admin (any admin role)\n */\nexport function isAdmin(role: UserRole | string | undefined): boolean {\n  if (!role) return false\n  return ['ADMIN', 'SUPERADMIN', 'MANAGER', 'EDITOR', 'SUPPORT', 'VIEWER'].includes(role)\n}\n\n/**\n * Check if user is a super admin\n */\nexport function isSuperAdmin(role: UserRole | string | undefined): boolean {\n  return role === 'SUPERADMIN'\n}\n\n/**\n * Get user's effective permissions (for display purposes)\n */\nexport function getUserPermissions(role: UserRole | string): {\n  resource: string\n  actions: string[]\n}[] {\n  const permissions = getDefaultPermissionsForRole(role)\n  const grouped: Record<string, Set<string>> = {}\n\n  permissions.forEach(permission => {\n    const [resource, action] = permission.split(':')\n    if (!grouped[resource]) {\n      grouped[resource] = new Set()\n    }\n    \n    if (action === 'MANAGE') {\n      // MANAGE implies all actions\n      grouped[resource].add('VIEW')\n      grouped[resource].add('CREATE')\n      grouped[resource].add('UPDATE')\n      grouped[resource].add('DELETE')\n      grouped[resource].add('MANAGE')\n    } else {\n      grouped[resource].add(action)\n    }\n  })\n\n  return Object.entries(grouped).map(([resource, actions]) => ({\n    resource,\n    actions: Array.from(actions).sort(),\n  }))\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 219, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/features.ts"],"sourcesContent":["import { prisma } from './prisma'\n\n/**\n * Check if a feature is enabled\n */\nexport async function isFeatureEnabled(featureName: string): Promise<boolean> {\n  try {\n    const feature = await prisma.featureFlag.findUnique({\n      where: { name: featureName },\n    })\n    return feature?.enabled ?? false\n  } catch (error) {\n    console.error(`Error checking feature flag ${featureName}:`, error)\n    return false\n  }\n}\n\n/**\n * Get all enabled features\n */\nexport async function getEnabledFeatures(): Promise<string[]> {\n  try {\n    const features = await prisma.featureFlag.findMany({\n      where: { enabled: true },\n      select: { name: true },\n    })\n    return features.map(f => f.name)\n  } catch (error) {\n    console.error('Error getting enabled features:', error)\n    return []\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAKO,eAAe,iBAAiB,WAAmB;IACxD,IAAI;QACF,MAAM,UAAU,MAAM,8HAAM,CAAC,WAAW,CAAC,UAAU,CAAC;YAClD,OAAO;gBAAE,MAAM;YAAY;QAC7B;QACA,OAAO,SAAS,WAAW;IAC7B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,4BAA4B,EAAE,YAAY,CAAC,CAAC,EAAE;QAC7D,OAAO;IACT;AACF;AAKO,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,MAAM,8HAAM,CAAC,WAAW,CAAC,QAAQ,CAAC;YACjD,OAAO;gBAAE,SAAS;YAAK;YACvB,QAAQ;gBAAE,MAAM;YAAK;QACvB;QACA,OAAO,SAAS,GAAG,CAAC,CAAA,IAAK,EAAE,IAAI;IACjC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO,EAAE;IACX;AACF"}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/components/admin/AdminUsersClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const AdminUsersClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call AdminUsersClient() from the server but AdminUsersClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/admin/AdminUsersClient.tsx <module evaluation>\",\n    \"AdminUsersClient\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,mBAAmB,IAAA,wQAAuB,EACnD;IAAa,MAAM,IAAI,MAAM;AAAgP,GAC7Q,2EACA","ignoreList":[0]}},
    {"offset": {"line": 274, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/components/admin/AdminUsersClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const AdminUsersClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call AdminUsersClient() from the server but AdminUsersClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/admin/AdminUsersClient.tsx\",\n    \"AdminUsersClient\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;AACO,MAAM,mBAAmB,IAAA,wQAAuB,EACnD;IAAa,MAAM,IAAI,MAAM;AAAgP,GAC7Q,uDACA","ignoreList":[0]}},
    {"offset": {"line": 288, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 296, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/app/admin/%28protected%29/users/page.tsx"],"sourcesContent":["import { getServerSession } from 'next-auth/next'\r\nimport { authOptions } from '@/lib/auth'\r\nimport { redirect, notFound } from 'next/navigation'\r\nimport Link from 'next/link'\r\nimport { hasPermission } from '@/lib/permissions'\r\nimport { isFeatureEnabled } from '@/lib/features'\r\nimport { AdminUsersClient } from '@/components/admin/AdminUsersClient'\r\n\r\nexport const metadata = {\r\n  title: 'Admin Users | Admin Panel',\r\n  description: 'Manage admin users and their permissions',\r\n}\r\n\r\nexport default async function AdminUsersPage() {\r\n  const session = await getServerSession(authOptions)\r\n\r\n  // Check authentication\r\n  if (!session?.user) {\r\n    redirect('/admin/login')\r\n  }\r\n\r\n  // Check if feature is enabled\r\n  const featureEnabled = await isFeatureEnabled('multi_admin')\r\n  if (!featureEnabled) {\r\n    notFound()\r\n  }\r\n\r\n  // Check permissions - only SUPERADMIN and ADMIN can view this page\r\n  if (!hasPermission(session.user.role, 'ADMIN_USER', 'VIEW')) {\r\n    notFound()\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col gap-6\">\r\n      <div>\r\n        <h1 className=\"text-3xl font-bold tracking-tight\">Admin Users</h1>\r\n        <p className=\"text-muted-foreground\">\r\n          Manage admin users and their roles\r\n        </p>\r\n        {!featureEnabled && (\r\n          <div className=\"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\r\n            <p className=\"text-sm text-yellow-800\">\r\n              <strong>Note:</strong> The multi-admin feature flag is not enabled. \r\n              You can enable it in <Link href=\"/admin/features\" className=\"underline font-semibold\">Features</Link> to unlock additional functionality.\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <AdminUsersClient currentUserRole={session.user.role} />\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;AAEO,MAAM,WAAW;IACtB,OAAO;IACP,aAAa;AACf;AAEe,eAAe;IAC5B,MAAM,UAAU,MAAM,IAAA,iKAAgB,EAAC,iIAAW;IAElD,uBAAuB;IACvB,IAAI,CAAC,SAAS,MAAM;QAClB,IAAA,iMAAQ,EAAC;IACX;IAEA,8BAA8B;IAC9B,MAAM,iBAAiB,MAAM,IAAA,0IAAgB,EAAC;IAC9C,IAAI,CAAC,gBAAgB;QACnB,IAAA,iMAAQ;IACV;IAEA,mEAAmE;IACnE,IAAI,CAAC,IAAA,0IAAa,EAAC,QAAQ,IAAI,CAAC,IAAI,EAAE,cAAc,SAAS;QAC3D,IAAA,iMAAQ;IACV;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;;kCACC,8OAAC;wBAAG,WAAU;kCAAoC;;;;;;kCAClD,8OAAC;wBAAE,WAAU;kCAAwB;;;;;;oBAGpC,CAAC,gCACA,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAE,WAAU;;8CACX,8OAAC;8CAAO;;;;;;gCAAc;8CACD,8OAAC,0LAAI;oCAAC,MAAK;oCAAkB,WAAU;8CAA0B;;;;;;gCAAe;;;;;;;;;;;;;;;;;;0BAM7G,8OAAC,mKAAgB;gBAAC,iBAAiB,QAAQ,IAAI,CAAC,IAAI;;;;;;;;;;;;AAG1D"}}]
}