{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: ['query'],\n  });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;KAAQ;AAChB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/auth.ts"],"sourcesContent":["import { NextAuthOptions } from 'next-auth';\nimport CredentialsProvider from 'next-auth/providers/credentials';\nimport { PrismaAdapter } from '@next-auth/prisma-adapter';\nimport { prisma } from './prisma';\nimport { compare } from 'bcryptjs';\n\nexport const authOptions: NextAuthOptions = {\n  adapter: PrismaAdapter(prisma),\n  session: {\n    strategy: 'jwt',\n  },\n  pages: {\n    signIn: '/admin/login',\n  },\n  providers: [\n    CredentialsProvider({\n      name: 'credentials',\n      credentials: {\n        email: { label: 'Email', type: 'email' },\n        password: { label: 'Password', type: 'password' },\n      },\n      async authorize(credentials) {\n        if (!credentials?.email || !credentials?.password) {\n          return null;\n        }\n\n        const user = await prisma.user.findUnique({\n          where: {\n            email: credentials.email,\n          },\n        });\n\n        if (!user || !user.password) {\n          return null;\n        }\n\n        const isPasswordValid = await compare(\n          credentials.password,\n          user.password\n        );\n\n        if (!isPasswordValid) {\n          return null;\n        }\n\n        return {\n          id: user.id,\n          email: user.email,\n          name: user.name,\n          role: user.role,\n        };\n      },\n    }),\n  ],\n  callbacks: {\n    async jwt({ token, user, trigger }) {\n      if (user) {\n        return {\n          ...token,\n          id: user.id,\n          role: user.role,\n        };\n      }\n\n      // Validate session hasn't been invalidated\n      if (token.id) {\n        const dbUser = await prisma.user.findUnique({\n          where: { id: token.id as string },\n          select: { sessionsInvalidatedAt: true, role: true },\n        });\n\n        if (dbUser) {\n          // Check if JWT was issued before sessions were invalidated\n          if (dbUser.sessionsInvalidatedAt) {\n            const tokenIssuedAt = token.iat ? token.iat * 1000 : 0; // Convert to milliseconds\n            const invalidatedAt = new Date(dbUser.sessionsInvalidatedAt).getTime();\n\n            if (tokenIssuedAt < invalidatedAt) {\n              // Session has been invalidated - return null to force re-login\n              return null as any;\n            }\n          }\n\n          // Update role in token if it changed\n          token.role = dbUser.role;\n        } else {\n          // User no longer exists\n          return null as any;\n        }\n      }\n\n      return token;\n    },\n    async session({ session, token }) {\n      // If token is null, session is invalid\n      if (!token) {\n        return null as any;\n      }\n\n      return {\n        ...session,\n        user: {\n          ...session.user,\n          id: token.id,\n          role: token.role,\n        },\n      };\n    },\n  },\n};\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;AAEO,MAAM,cAA+B;IAC1C,SAAS,IAAA,uLAAa,EAAC,gIAAM;IAC7B,SAAS;QACP,UAAU;IACZ;IACA,OAAO;QACL,QAAQ;IACV;IACA,WAAW;QACT,IAAA,qKAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,OAAO;gBACT;gBAEA,MAAM,OAAO,MAAM,gIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBACxC,OAAO;wBACL,OAAO,YAAY,KAAK;oBAC1B;gBACF;gBAEA,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;oBAC3B,OAAO;gBACT;gBAEA,MAAM,kBAAkB,MAAM,IAAA,8IAAO,EACnC,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGf,IAAI,CAAC,iBAAiB;oBACpB,OAAO;gBACT;gBAEA,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;oBACf,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE;YAChC,IAAI,MAAM;gBACR,OAAO;oBACL,GAAG,KAAK;oBACR,IAAI,KAAK,EAAE;oBACX,MAAM,KAAK,IAAI;gBACjB;YACF;YAEA,2CAA2C;YAC3C,IAAI,MAAM,EAAE,EAAE;gBACZ,MAAM,SAAS,MAAM,gIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;oBAC1C,OAAO;wBAAE,IAAI,MAAM,EAAE;oBAAW;oBAChC,QAAQ;wBAAE,uBAAuB;wBAAM,MAAM;oBAAK;gBACpD;gBAEA,IAAI,QAAQ;oBACV,2DAA2D;oBAC3D,IAAI,OAAO,qBAAqB,EAAE;wBAChC,MAAM,gBAAgB,MAAM,GAAG,GAAG,MAAM,GAAG,GAAG,OAAO,GAAG,0BAA0B;wBAClF,MAAM,gBAAgB,IAAI,KAAK,OAAO,qBAAqB,EAAE,OAAO;wBAEpE,IAAI,gBAAgB,eAAe;4BACjC,+DAA+D;4BAC/D,OAAO;wBACT;oBACF;oBAEA,qCAAqC;oBACrC,MAAM,IAAI,GAAG,OAAO,IAAI;gBAC1B,OAAO;oBACL,wBAAwB;oBACxB,OAAO;gBACT;YACF;YAEA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,uCAAuC;YACvC,IAAI,CAAC,OAAO;gBACV,OAAO;YACT;YAEA,OAAO;gBACL,GAAG,OAAO;gBACV,MAAM;oBACJ,GAAG,QAAQ,IAAI;oBACf,IAAI,MAAM,EAAE;oBACZ,MAAM,MAAM,IAAI;gBAClB;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 264, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/cloudinary.ts"],"sourcesContent":["import { v2 as cloudinary } from 'cloudinary';\n\ncloudinary.config({\n  cloud_name: process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,\n  api_key: process.env.CLOUDINARY_API_KEY,\n  api_secret: process.env.CLOUDINARY_API_SECRET,\n});\n\nexport default cloudinary;\n\nexport const uploadToCloudinary = async (file: File, folder: string = 'ecommerce/products'): Promise<any> => {\n  const arrayBuffer = await file.arrayBuffer();\n  const buffer = Buffer.from(arrayBuffer);\n\n  return new Promise((resolve, reject) => {\n    cloudinary.uploader\n      .upload_stream(\n        {\n          folder: folder,\n          resource_type: 'auto', // Allow video/audio/docs\n        },\n        (error, result) => {\n          if (error) reject(error);\n          else resolve(result);\n        }\n      )\n      .end(buffer);\n  });\n};\n\nexport const deleteFromCloudinary = async (publicId: string): Promise<void> => {\n  await cloudinary.uploader.destroy(publicId);\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAEA,gJAAU,CAAC,MAAM,CAAC;IAChB,UAAU;IACV,SAAS,QAAQ,GAAG,CAAC,kBAAkB;IACvC,YAAY,QAAQ,GAAG,CAAC,qBAAqB;AAC/C;uCAEe,gJAAU;AAElB,MAAM,qBAAqB,OAAO,MAAY,SAAiB,oBAAoB;IACxF,MAAM,cAAc,MAAM,KAAK,WAAW;IAC1C,MAAM,SAAS,OAAO,IAAI,CAAC;IAE3B,OAAO,IAAI,QAAQ,CAAC,SAAS;QAC3B,gJAAU,CAAC,QAAQ,CAChB,aAAa,CACZ;YACE,QAAQ;YACR,eAAe;QACjB,GACA,CAAC,OAAO;YACN,IAAI,OAAO,OAAO;iBACb,QAAQ;QACf,GAED,GAAG,CAAC;IACT;AACF;AAEO,MAAM,uBAAuB,OAAO;IACzC,MAAM,gJAAU,CAAC,QAAQ,CAAC,OAAO,CAAC;AACpC"}},
    {"offset": {"line": 300, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/activity-log.ts"],"sourcesContent":["import { prisma } from './prisma'\n\nexport interface ActivityLogInput {\n  userId: string\n  action: string\n  resource: string\n  resourceId?: string\n  details?: string\n  ipAddress?: string\n  userAgent?: string\n}\n\nexport interface ActivityLogFilters {\n  page?: number\n  limit?: number\n  userId?: string\n  action?: string\n  resource?: string\n  resourceId?: string\n  startDate?: Date\n  endDate?: Date\n}\n\nexport interface ActivityLogResult {\n  logs: any[]\n  total: number\n  page: number\n  limit: number\n  totalPages: number\n}\n\n/**\n * Log an admin activity\n */\nexport async function logActivity(input: ActivityLogInput) {\n  try {\n    const log = await prisma.adminActivityLog.create({\n      data: {\n        userId: input.userId,\n        action: input.action,\n        resource: input.resource,\n        resourceId: input.resourceId,\n        details: input.details,\n        ipAddress: input.ipAddress,\n        userAgent: input.userAgent,\n      },\n    })\n    return log\n  } catch (error) {\n    console.error('Error logging activity:', error)\n    throw error\n  }\n}\n\n/**\n * Get activity logs with filters and pagination\n */\nexport async function getActivityLogs(\n  filters: ActivityLogFilters = {}\n): Promise<ActivityLogResult> {\n  const {\n    page = 1,\n    limit = 20,\n    userId,\n    action,\n    resource,\n    resourceId,\n    startDate,\n    endDate,\n  } = filters\n\n  const where: any = {}\n\n  if (userId) {\n    where.userId = userId\n  }\n\n  if (action) {\n    where.action = action\n  }\n\n  if (resource) {\n    where.resource = resource\n  }\n\n  if (resourceId) {\n    where.resourceId = resourceId\n  }\n\n  if (startDate || endDate) {\n    where.createdAt = {}\n    if (startDate) {\n      where.createdAt.gte = startDate\n    }\n    if (endDate) {\n      where.createdAt.lte = endDate\n    }\n  }\n\n  const [logs, total] = await Promise.all([\n    prisma.adminActivityLog.findMany({\n      where,\n      include: {\n        user: {\n          select: {\n            name: true,\n            email: true,\n            role: true,\n          },\n        },\n      },\n      orderBy: { createdAt: 'desc' },\n      skip: (page - 1) * limit,\n      take: limit,\n    }),\n    prisma.adminActivityLog.count({ where }),\n  ])\n\n  return {\n    logs,\n    total,\n    page,\n    limit,\n    totalPages: Math.ceil(total / limit) || 0,\n  }\n}\n\n/**\n * Get activity logs by user ID\n */\nexport async function getActivityLogsByUser(\n  userId: string,\n  options: { page?: number; limit?: number } = {}\n): Promise<ActivityLogResult> {\n  return getActivityLogs({\n    userId,\n    page: options.page,\n    limit: options.limit,\n  })\n}\n\n/**\n * Get activity logs by resource\n */\nexport async function getActivityLogsByResource(\n  resource: string,\n  resourceId?: string,\n  options: { page?: number; limit?: number } = {}\n): Promise<ActivityLogResult> {\n  return getActivityLogs({\n    resource,\n    resourceId,\n    page: options.page,\n    limit: options.limit,\n  })\n}\n\n/**\n * Helper to extract IP address from request\n */\nexport function getClientIp(request: Request): string | undefined {\n  const forwardedFor = request.headers.get('x-forwarded-for')\n  if (forwardedFor) {\n    return forwardedFor.split(',')[0].trim()\n  }\n  const realIp = request.headers.get('x-real-ip')\n  if (realIp) {\n    return realIp\n  }\n  return undefined\n}\n\n/**\n * Helper to extract user agent from request\n */\nexport function getUserAgent(request: Request): string | undefined {\n  return request.headers.get('user-agent') || undefined\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;AAkCO,eAAe,YAAY,KAAuB;IACvD,IAAI;QACF,MAAM,MAAM,MAAM,gIAAM,CAAC,gBAAgB,CAAC,MAAM,CAAC;YAC/C,MAAM;gBACJ,QAAQ,MAAM,MAAM;gBACpB,QAAQ,MAAM,MAAM;gBACpB,UAAU,MAAM,QAAQ;gBACxB,YAAY,MAAM,UAAU;gBAC5B,SAAS,MAAM,OAAO;gBACtB,WAAW,MAAM,SAAS;gBAC1B,WAAW,MAAM,SAAS;YAC5B;QACF;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,MAAM;IACR;AACF;AAKO,eAAe,gBACpB,UAA8B,CAAC,CAAC;IAEhC,MAAM,EACJ,OAAO,CAAC,EACR,QAAQ,EAAE,EACV,MAAM,EACN,MAAM,EACN,QAAQ,EACR,UAAU,EACV,SAAS,EACT,OAAO,EACR,GAAG;IAEJ,MAAM,QAAa,CAAC;IAEpB,IAAI,QAAQ;QACV,MAAM,MAAM,GAAG;IACjB;IAEA,IAAI,QAAQ;QACV,MAAM,MAAM,GAAG;IACjB;IAEA,IAAI,UAAU;QACZ,MAAM,QAAQ,GAAG;IACnB;IAEA,IAAI,YAAY;QACd,MAAM,UAAU,GAAG;IACrB;IAEA,IAAI,aAAa,SAAS;QACxB,MAAM,SAAS,GAAG,CAAC;QACnB,IAAI,WAAW;YACb,MAAM,SAAS,CAAC,GAAG,GAAG;QACxB;QACA,IAAI,SAAS;YACX,MAAM,SAAS,CAAC,GAAG,GAAG;QACxB;IACF;IAEA,MAAM,CAAC,MAAM,MAAM,GAAG,MAAM,QAAQ,GAAG,CAAC;QACtC,gIAAM,CAAC,gBAAgB,CAAC,QAAQ,CAAC;YAC/B;YACA,SAAS;gBACP,MAAM;oBACJ,QAAQ;wBACN,MAAM;wBACN,OAAO;wBACP,MAAM;oBACR;gBACF;YACF;YACA,SAAS;gBAAE,WAAW;YAAO;YAC7B,MAAM,CAAC,OAAO,CAAC,IAAI;YACnB,MAAM;QACR;QACA,gIAAM,CAAC,gBAAgB,CAAC,KAAK,CAAC;YAAE;QAAM;KACvC;IAED,OAAO;QACL;QACA;QACA;QACA;QACA,YAAY,KAAK,IAAI,CAAC,QAAQ,UAAU;IAC1C;AACF;AAKO,eAAe,sBACpB,MAAc,EACd,UAA6C,CAAC,CAAC;IAE/C,OAAO,gBAAgB;QACrB;QACA,MAAM,QAAQ,IAAI;QAClB,OAAO,QAAQ,KAAK;IACtB;AACF;AAKO,eAAe,0BACpB,QAAgB,EAChB,UAAmB,EACnB,UAA6C,CAAC,CAAC;IAE/C,OAAO,gBAAgB;QACrB;QACA;QACA,MAAM,QAAQ,IAAI;QAClB,OAAO,QAAQ,KAAK;IACtB;AACF;AAKO,SAAS,YAAY,OAAgB;IAC1C,MAAM,eAAe,QAAQ,OAAO,CAAC,GAAG,CAAC;IACzC,IAAI,cAAc;QAChB,OAAO,aAAa,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI;IACxC;IACA,MAAM,SAAS,QAAQ,OAAO,CAAC,GAAG,CAAC;IACnC,IAAI,QAAQ;QACV,OAAO;IACT;IACA,OAAO;AACT;AAKO,SAAS,aAAa,OAAgB;IAC3C,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC,iBAAiB;AAC9C"}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/export-utils.ts"],"sourcesContent":["/**\n * Export/Import utility functions\n * Handles CSV, JSON, and data transformation\n */\n\nexport interface ExportColumn {\n  key: string\n  header: string\n  transform?: (value: any, row: any) => any\n}\n\n/**\n * Convert array of objects to CSV string\n */\nexport function convertToCSV(data: any[], columns: ExportColumn[]): string {\n  if (!data || data.length === 0) {\n    return columns.map((col) => col.header).join(',') + '\\n'\n  }\n\n  // Headers\n  const headers = columns.map((col) => col.header).join(',')\n\n  // Rows\n  const rows = data.map((row) => {\n    return columns\n      .map((col) => {\n        let value = row[col.key]\n\n        // Apply transform if provided\n        if (col.transform) {\n          value = col.transform(value, row)\n        }\n\n        // Handle different data types\n        if (value === null || value === undefined) {\n          return ''\n        }\n\n        if (typeof value === 'object') {\n          value = JSON.stringify(value)\n        }\n\n        // Escape CSV special characters\n        const stringValue = String(value)\n        if (\n          stringValue.includes(',') ||\n          stringValue.includes('\"') ||\n          stringValue.includes('\\n')\n        ) {\n          return `\"${stringValue.replace(/\"/g, '\"\"')}\"`\n        }\n\n        return stringValue\n      })\n      .join(',')\n  })\n\n  return headers + '\\n' + rows.join('\\n')\n}\n\n/**\n * Parse CSV string to array of objects\n */\nexport function parseCSV(csvString: string): any[] {\n  const lines = csvString.split('\\n').filter((line) => line.trim())\n\n  if (lines.length === 0) {\n    return []\n  }\n\n  // Parse headers\n  const headers = parseCSVLine(lines[0])\n\n  // Parse rows\n  const data = []\n  for (let i = 1; i < lines.length; i++) {\n    const values = parseCSVLine(lines[i])\n    const row: any = {}\n\n    headers.forEach((header, index) => {\n      row[header] = values[index] || ''\n    })\n\n    data.push(row)\n  }\n\n  return data\n}\n\n/**\n * Parse a single CSV line handling quotes\n */\nfunction parseCSVLine(line: string): string[] {\n  const result = []\n  let current = ''\n  let inQuotes = false\n\n  for (let i = 0; i < line.length; i++) {\n    const char = line[i]\n    const nextChar = line[i + 1]\n\n    if (char === '\"') {\n      if (inQuotes && nextChar === '\"') {\n        // Escaped quote\n        current += '\"'\n        i++ // Skip next quote\n      } else {\n        // Toggle quotes\n        inQuotes = !inQuotes\n      }\n    } else if (char === ',' && !inQuotes) {\n      // End of field\n      result.push(current.trim())\n      current = ''\n    } else {\n      current += char\n    }\n  }\n\n  // Add last field\n  result.push(current.trim())\n\n  return result\n}\n\n/**\n * Product export columns\n */\nexport const PRODUCT_EXPORT_COLUMNS: ExportColumn[] = [\n  { key: 'sku', header: 'SKU' },\n  { key: 'name', header: 'Name' },\n  { key: 'price', header: 'Price' },\n  { key: 'comparePrice', header: 'Compare Price' },\n  { key: 'stock', header: 'Stock' },\n  {\n    key: 'category',\n    header: 'Category',\n    transform: (value) => value?.name || '',\n  },\n  {\n    key: 'published',\n    header: 'Published',\n    transform: (value) => (value ? 'Yes' : 'No'),\n  },\n  {\n    key: 'featured',\n    header: 'Featured',\n    transform: (value) => (value ? 'Yes' : 'No'),\n  },\n  { key: 'description', header: 'Description' },\n  {\n    key: 'createdAt',\n    header: 'Created At',\n    transform: (value) => new Date(value).toISOString(),\n  },\n]\n\n/**\n * Order export columns\n */\nexport const ORDER_EXPORT_COLUMNS: ExportColumn[] = [\n  { key: 'orderNumber', header: 'Order Number' },\n  {\n    key: 'createdAt',\n    header: 'Date',\n    transform: (value) => new Date(value).toISOString(),\n  },\n  {\n    key: 'user',\n    header: 'Customer Email',\n    transform: (value, row) => value?.email || row.guestEmail || '',\n  },\n  { key: 'status', header: 'Status' },\n  { key: 'paymentStatus', header: 'Payment Status' },\n  { key: 'total', header: 'Total' },\n  {\n    key: 'items',\n    header: 'Items',\n    transform: (value) => value?.length || 0,\n  },\n  { key: 'trackingNumber', header: 'Tracking Number' },\n]\n\n/**\n * Customer export columns\n */\nexport const CUSTOMER_EXPORT_COLUMNS: ExportColumn[] = [\n  { key: 'email', header: 'Email' },\n  { key: 'name', header: 'Name' },\n  {\n    key: 'orders',\n    header: 'Total Orders',\n    transform: (value) => value?.length || 0,\n  },\n  {\n    key: 'orders',\n    header: 'Total Spent',\n    transform: (value) =>\n      value?.reduce((sum: number, order: any) => sum + Number(order.total), 0) || 0,\n  },\n  {\n    key: 'createdAt',\n    header: 'Created At',\n    transform: (value) => new Date(value).toISOString(),\n  },\n  {\n    key: 'emailVerified',\n    header: 'Email Verified',\n    transform: (value) => (value ? 'Yes' : 'No'),\n  },\n]\n\n/**\n * Category export columns\n */\nexport const CATEGORY_EXPORT_COLUMNS: ExportColumn[] = [\n  { key: 'name', header: 'Name' },\n  { key: 'slug', header: 'Slug' },\n  { key: 'description', header: 'Description' },\n  {\n    key: 'parent',\n    header: 'Parent Category',\n    transform: (value) => value?.name || '',\n  },\n  {\n    key: 'products',\n    header: 'Product Count',\n    transform: (value) => value?.length || 0,\n  },\n]\n\n/**\n * Inventory export columns\n */\nexport const INVENTORY_EXPORT_COLUMNS: ExportColumn[] = [\n  { key: 'sku', header: 'SKU' },\n  { key: 'name', header: 'Product Name' },\n  { key: 'stock', header: 'Current Stock' },\n  {\n    key: 'stockAlert',\n    header: 'Alert Threshold',\n    transform: (value) => value?.threshold || '',\n  },\n  {\n    key: 'category',\n    header: 'Category',\n    transform: (value) => value?.name || '',\n  },\n  { key: 'price', header: 'Price' },\n  {\n    key: 'updatedAt',\n    header: 'Last Updated',\n    transform: (value) => new Date(value).toISOString(),\n  },\n]\n\n/**\n * Get export columns by type\n */\nexport function getExportColumns(type: string): ExportColumn[] {\n  switch (type) {\n    case 'PRODUCTS':\n      return PRODUCT_EXPORT_COLUMNS\n    case 'ORDERS':\n      return ORDER_EXPORT_COLUMNS\n    case 'CUSTOMERS':\n      return CUSTOMER_EXPORT_COLUMNS\n    case 'CATEGORIES':\n      return CATEGORY_EXPORT_COLUMNS\n    case 'INVENTORY':\n      return INVENTORY_EXPORT_COLUMNS\n    default:\n      return []\n  }\n}\n\n/**\n * Validate import row for products\n */\nexport function validateProductRow(row: any, rowNumber: number): string[] {\n  const errors: string[] = []\n\n  if (!row.SKU || !row.SKU.trim()) {\n    errors.push(`Row ${rowNumber}: SKU is required`)\n  }\n\n  if (!row.Name || !row.Name.trim()) {\n    errors.push(`Row ${rowNumber}: Name is required`)\n  }\n\n  if (!row.Price || isNaN(Number(row.Price))) {\n    errors.push(`Row ${rowNumber}: Valid price is required`)\n  }\n\n  if (!row.Stock || isNaN(Number(row.Stock))) {\n    errors.push(`Row ${rowNumber}: Valid stock quantity is required`)\n  }\n\n  return errors\n}\n\n/**\n * Validate import row for orders\n */\nexport function validateOrderRow(row: any, rowNumber: number): string[] {\n  const errors: string[] = []\n\n  if (!row['Order Number'] || !row['Order Number'].trim()) {\n    errors.push(`Row ${rowNumber}: Order Number is required`)\n  }\n\n  if (!row['Customer Email'] || !row['Customer Email'].trim()) {\n    errors.push(`Row ${rowNumber}: Customer Email is required`)\n  }\n\n  if (!row.Total || isNaN(Number(row.Total))) {\n    errors.push(`Row ${rowNumber}: Valid total is required`)\n  }\n\n  return errors\n}\n\n/**\n * Validate import row for customers\n */\nexport function validateCustomerRow(row: any, rowNumber: number): string[] {\n  const errors: string[] = []\n\n  if (!row.Email || !row.Email.trim()) {\n    errors.push(`Row ${rowNumber}: Email is required`)\n  } else if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(row.Email)) {\n    errors.push(`Row ${rowNumber}: Invalid email format`)\n  }\n\n  if (!row.Name || !row.Name.trim()) {\n    errors.push(`Row ${rowNumber}: Name is required`)\n  }\n\n  return errors\n}\n\n/**\n * Validate import data by type\n */\nexport function validateImportData(\n  type: string,\n  data: any[]\n): { valid: boolean; errors: string[] } {\n  const errors: string[] = []\n\n  data.forEach((row, index) => {\n    const rowNumber = index + 2 // +2 because index starts at 0 and we skip header\n\n    switch (type) {\n      case 'PRODUCTS':\n        errors.push(...validateProductRow(row, rowNumber))\n        break\n      case 'ORDERS':\n        errors.push(...validateOrderRow(row, rowNumber))\n        break\n      case 'CUSTOMERS':\n        errors.push(...validateCustomerRow(row, rowNumber))\n        break\n    }\n  })\n\n  return {\n    valid: errors.length === 0,\n    errors,\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 784, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/app/api/admin/export/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { getServerSession } from 'next-auth/next'\nimport { authOptions } from '@/lib/auth'\nimport { prisma } from '@/lib/prisma'\nimport cloudinary from '@/lib/cloudinary'\nimport { logActivity, getClientIp, getUserAgent } from '@/lib/activity-log'\nimport { convertToCSV, getExportColumns } from '@/lib/export-utils'\n\n/**\n * GET /api/admin/export\n * List all exports with pagination\n */\nexport async function GET(request: NextRequest) {\n  try {\n    // Check authentication\n    const session = await getServerSession(authOptions)\n    if (!session?.user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n    }\n\n    // Check if user is ADMIN or SUPERADMIN\n    if (!['ADMIN', 'SUPERADMIN'].includes(session.user.role)) {\n      return NextResponse.json({ error: 'Insufficient permissions' }, { status: 403 })\n    }\n\n    // Parse query parameters\n    const searchParams = request.nextUrl.searchParams\n    const page = parseInt(searchParams.get('page') || '1')\n    const limit = parseInt(searchParams.get('limit') || '20')\n    const type = searchParams.get('type')\n    const status = searchParams.get('status')\n\n    // Build where clause\n    const where: any = {}\n    if (type) {\n      where.type = type\n    }\n    if (status) {\n      where.status = status\n    }\n\n    // Get exports with pagination\n    const [exports, total] = await Promise.all([\n      prisma.dataExport.findMany({\n        where,\n        include: {\n          createdBy: {\n            select: {\n              id: true,\n              name: true,\n              email: true,\n            },\n          },\n        },\n        orderBy: { createdAt: 'desc' },\n        skip: (page - 1) * limit,\n        take: limit,\n      }),\n      prisma.dataExport.count({ where }),\n    ])\n\n    return NextResponse.json({\n      exports,\n      total,\n      page,\n      limit,\n      totalPages: Math.ceil(total / limit),\n    })\n  } catch (error) {\n    console.error('Error fetching exports:', error)\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n\n/**\n * POST /api/admin/export\n * Create a new data export job\n */\nexport async function POST(request: NextRequest) {\n  try {\n    // Check authentication\n    const session = await getServerSession(authOptions)\n    if (!session?.user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n    }\n\n    // Check if user is ADMIN or SUPERADMIN\n    if (!['ADMIN', 'SUPERADMIN'].includes(session.user.role)) {\n      return NextResponse.json({ error: 'Insufficient permissions' }, { status: 403 })\n    }\n\n    // Parse request body\n    const body = await request.json()\n    const {\n      type, // PRODUCTS, ORDERS, CUSTOMERS, CATEGORIES, INVENTORY\n      format = 'CSV', // CSV, JSON, XLSX\n      filters = {},\n    } = body\n\n    // Validate type\n    const validTypes = ['PRODUCTS', 'ORDERS', 'CUSTOMERS', 'CATEGORIES', 'INVENTORY']\n    if (!type || !validTypes.includes(type)) {\n      return NextResponse.json({ error: 'Invalid export type' }, { status: 400 })\n    }\n\n    // Validate format\n    const validFormats = ['CSV', 'JSON']\n    if (!validFormats.includes(format)) {\n      return NextResponse.json(\n        { error: 'Invalid format. Supported: CSV, JSON' },\n        { status: 400 }\n      )\n    }\n\n    // Create export record\n    const dataExport = await prisma.dataExport.create({\n      data: {\n        type,\n        format,\n        status: 'IN_PROGRESS',\n        filters: JSON.stringify(filters),\n        createdById: session.user.id,\n      },\n    })\n\n    // Log activity\n    await logActivity({\n      userId: session.user.id,\n      action: 'CREATE',\n      resource: 'DATA_EXPORT',\n      resourceId: dataExport.id,\n      details: `Started ${type} export in ${format} format`,\n      ipAddress: getClientIp(request),\n      userAgent: getUserAgent(request),\n    })\n\n    // Generate export asynchronously\n    setImmediate(async () => {\n      try {\n        let data: any[] = []\n        let recordCount = 0\n\n        // Fetch data based on type\n        switch (type) {\n          case 'PRODUCTS':\n            data = await prisma.product.findMany({\n              include: {\n                category: true,\n                images: true,\n              },\n              where: filters.categoryId\n                ? { categoryId: filters.categoryId }\n                : undefined,\n            })\n            recordCount = data.length\n            break\n\n          case 'ORDERS':\n            const orderWhere: any = {}\n            if (filters.status) {\n              orderWhere.status = filters.status\n            }\n            if (filters.startDate) {\n              orderWhere.createdAt = {\n                gte: new Date(filters.startDate),\n              }\n            }\n            if (filters.endDate) {\n              orderWhere.createdAt = {\n                ...orderWhere.createdAt,\n                lte: new Date(filters.endDate),\n              }\n            }\n\n            data = await prisma.order.findMany({\n              where: orderWhere,\n              include: {\n                user: {\n                  select: {\n                    email: true,\n                    name: true,\n                  },\n                },\n                items: true,\n              },\n            })\n            recordCount = data.length\n            break\n\n          case 'CUSTOMERS':\n            data = await prisma.user.findMany({\n              where: {\n                role: 'CUSTOMER',\n              },\n              include: {\n                orders: {\n                  select: {\n                    total: true,\n                  },\n                },\n              },\n            })\n            recordCount = data.length\n            break\n\n          case 'CATEGORIES':\n            data = await prisma.category.findMany({\n              include: {\n                parent: true,\n                products: true,\n              },\n            })\n            recordCount = data.length\n            break\n\n          case 'INVENTORY':\n            data = await prisma.product.findMany({\n              include: {\n                category: true,\n                stockAlert: true,\n              },\n              where: filters.lowStock\n                ? {\n                  stock: {\n                    lt: 10,\n                  },\n                }\n                : undefined,\n            })\n            recordCount = data.length\n            break\n        }\n\n        // Generate file based on format\n        let fileContent: string\n        let mimeType: string\n        let fileExtension: string\n\n        if (format === 'CSV') {\n          const columns = getExportColumns(type)\n          fileContent = convertToCSV(data, columns)\n          mimeType = 'text/csv'\n          fileExtension = 'csv'\n        } else {\n          // JSON\n          fileContent = JSON.stringify(data, null, 2)\n          mimeType = 'application/json'\n          fileExtension = 'json'\n        }\n\n        const filename = `export-${type.toLowerCase()}-${Date.now()}.${fileExtension}`\n        const fileSize = Buffer.byteLength(fileContent, 'utf8')\n\n        // Upload to Cloudinary\n        const uploadResult = await cloudinary.uploader.upload(\n          `data:${mimeType};base64,${Buffer.from(fileContent).toString('base64')}`,\n          {\n            folder: 'ecommerce/exports',\n            resource_type: 'raw',\n            public_id: `export-${dataExport.id}`,\n            format: fileExtension,\n          }\n        )\n\n        // Update export record\n        await prisma.dataExport.update({\n          where: { id: dataExport.id },\n          data: {\n            status: 'COMPLETED',\n            filename,\n            fileUrl: uploadResult.secure_url,\n            fileSize,\n            recordCount,\n            completedAt: new Date(),\n            expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // 7 days\n          },\n        })\n\n        console.log(`Export ${dataExport.id} completed successfully`)\n      } catch (error) {\n        console.error(`Error generating export ${dataExport.id}:`, error)\n        await prisma.dataExport.update({\n          where: { id: dataExport.id },\n          data: {\n            status: 'FAILED',\n            errorMessage: error instanceof Error ? error.message : 'Unknown error',\n          },\n        })\n      }\n    })\n\n    return NextResponse.json({\n      export: {\n        id: dataExport.id,\n        status: dataExport.status,\n        message: 'Export started. Check status at /api/admin/export/' + dataExport.id,\n      },\n    }, { status: 201 })\n  } catch (error) {\n    console.error('Error creating export:', error)\n    return NextResponse.json({ error: 'Internal server error' }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}