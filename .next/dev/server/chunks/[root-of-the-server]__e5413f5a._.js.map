{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma =\n  globalForPrisma.prisma ??\n  new PrismaClient({\n    log: ['query'],\n  });\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK;QAAC;KAAQ;AAChB;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 69, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/features.ts"],"sourcesContent":["import { prisma } from './prisma'\n\n/**\n * Check if a feature is enabled\n */\nexport async function isFeatureEnabled(featureName: string): Promise<boolean> {\n  try {\n    const feature = await prisma.featureFlag.findUnique({\n      where: { name: featureName },\n    })\n    return feature?.enabled ?? false\n  } catch (error) {\n    console.error(`Error checking feature flag ${featureName}:`, error)\n    return false\n  }\n}\n\n/**\n * Get all enabled features\n */\nexport async function getEnabledFeatures(): Promise<string[]> {\n  try {\n    const features = await prisma.featureFlag.findMany({\n      where: { enabled: true },\n      select: { name: true },\n    })\n    return features.map(f => f.name)\n  } catch (error) {\n    console.error('Error getting enabled features:', error)\n    return []\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAKO,eAAe,iBAAiB,WAAmB;IACxD,IAAI;QACF,MAAM,UAAU,MAAM,gIAAM,CAAC,WAAW,CAAC,UAAU,CAAC;YAClD,OAAO;gBAAE,MAAM;YAAY;QAC7B;QACA,OAAO,SAAS,WAAW;IAC7B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,4BAA4B,EAAE,YAAY,CAAC,CAAC,EAAE;QAC7D,OAAO;IACT;AACF;AAKO,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,MAAM,gIAAM,CAAC,WAAW,CAAC,QAAQ,CAAC;YACjD,OAAO;gBAAE,SAAS;YAAK;YACvB,QAAQ;gBAAE,MAAM;YAAK;QACvB;QACA,OAAO,SAAS,GAAG,CAAC,CAAA,IAAK,EAAE,IAAI;IACjC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mCAAmC;QACjD,OAAO,EAAE;IACX;AACF"}},
    {"offset": {"line": 110, "column": 0}, "map": {"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/app/api/products/%5Bid%5D/flash-sale/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { prisma } from '@/lib/prisma'\r\nimport { isFeatureEnabled } from '@/lib/features'\r\n\r\n// Check if a product has an active flash sale (public)\r\nexport async function GET(\r\n  request: NextRequest,\r\n  { params }: { params: Promise<{ id: string }> }\r\n) {\r\n  try {\r\n    const enabled = await isFeatureEnabled('flash_sales')\r\n    if (!enabled) {\r\n      return NextResponse.json({ flashSale: null })\r\n    }\r\n\r\n    const { id } = await params\r\n    const now = new Date()\r\n\r\n    // Find active flash sales that include this product\r\n    const flashSaleProduct = await prisma.flashSaleProduct.findFirst({\r\n      where: {\r\n        productId: id,\r\n        flashSale: {\r\n          status: 'ACTIVE',\r\n          isActive: true,\r\n          startDate: { lte: now },\r\n          endDate: { gt: now },\r\n        },\r\n        // Filter by availability in application code\r\n      },\r\n      include: {\r\n        flashSale: {\r\n          select: {\r\n            id: true,\r\n            name: true,\r\n            description: true,\r\n            discountType: true,\r\n            discountValue: true,\r\n            startDate: true,\r\n            endDate: true,\r\n            bannerImage: true,\r\n            bannerText: true,\r\n          },\r\n        },\r\n      },\r\n    })\r\n\r\n    if (!flashSaleProduct) {\r\n      return NextResponse.json({ flashSale: null })\r\n    }\r\n\r\n    // Check if product is still available (hasn't reached maxQuantity)\r\n    if (\r\n      flashSaleProduct.maxQuantity !== null &&\r\n      flashSaleProduct.soldQuantity >= flashSaleProduct.maxQuantity\r\n    ) {\r\n      return NextResponse.json({ flashSale: null })\r\n    }\r\n\r\n    return NextResponse.json({\r\n      flashSale: {\r\n        id: flashSaleProduct.flashSale.id,\r\n        name: flashSaleProduct.flashSale.name,\r\n        description: flashSaleProduct.flashSale.description,\r\n        discountType: flashSaleProduct.flashSale.discountType,\r\n        discountValue: flashSaleProduct.flashSale.discountValue,\r\n        startDate: flashSaleProduct.flashSale.startDate,\r\n        endDate: flashSaleProduct.flashSale.endDate,\r\n        bannerImage: flashSaleProduct.flashSale.bannerImage,\r\n        bannerText: flashSaleProduct.flashSale.bannerText,\r\n      },\r\n      product: {\r\n        originalPrice: Number(flashSaleProduct.originalPrice),\r\n        salePrice: Number(flashSaleProduct.salePrice),\r\n        maxQuantity: flashSaleProduct.maxQuantity,\r\n        soldQuantity: flashSaleProduct.soldQuantity,\r\n        available: flashSaleProduct.maxQuantity !== null\r\n          ? flashSaleProduct.maxQuantity - flashSaleProduct.soldQuantity\r\n          : null,\r\n      },\r\n    })\r\n  } catch (error) {\r\n    console.error('Error checking product flash sale:', error)\r\n    return NextResponse.json({ flashSale: null })\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAGO,eAAe,IACpB,OAAoB,EACpB,EAAE,MAAM,EAAuC;IAE/C,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,4IAAgB,EAAC;QACvC,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,WAAW;YAAK;QAC7C;QAEA,MAAM,EAAE,EAAE,EAAE,GAAG,MAAM;QACrB,MAAM,MAAM,IAAI;QAEhB,oDAAoD;QACpD,MAAM,mBAAmB,MAAM,gIAAM,CAAC,gBAAgB,CAAC,SAAS,CAAC;YAC/D,OAAO;gBACL,WAAW;gBACX,WAAW;oBACT,QAAQ;oBACR,UAAU;oBACV,WAAW;wBAAE,KAAK;oBAAI;oBACtB,SAAS;wBAAE,IAAI;oBAAI;gBACrB;YAEF;YACA,SAAS;gBACP,WAAW;oBACT,QAAQ;wBACN,IAAI;wBACJ,MAAM;wBACN,aAAa;wBACb,cAAc;wBACd,eAAe;wBACf,WAAW;wBACX,SAAS;wBACT,aAAa;wBACb,YAAY;oBACd;gBACF;YACF;QACF;QAEA,IAAI,CAAC,kBAAkB;YACrB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,WAAW;YAAK;QAC7C;QAEA,mEAAmE;QACnE,IACE,iBAAiB,WAAW,KAAK,QACjC,iBAAiB,YAAY,IAAI,iBAAiB,WAAW,EAC7D;YACA,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,WAAW;YAAK;QAC7C;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,WAAW;gBACT,IAAI,iBAAiB,SAAS,CAAC,EAAE;gBACjC,MAAM,iBAAiB,SAAS,CAAC,IAAI;gBACrC,aAAa,iBAAiB,SAAS,CAAC,WAAW;gBACnD,cAAc,iBAAiB,SAAS,CAAC,YAAY;gBACrD,eAAe,iBAAiB,SAAS,CAAC,aAAa;gBACvD,WAAW,iBAAiB,SAAS,CAAC,SAAS;gBAC/C,SAAS,iBAAiB,SAAS,CAAC,OAAO;gBAC3C,aAAa,iBAAiB,SAAS,CAAC,WAAW;gBACnD,YAAY,iBAAiB,SAAS,CAAC,UAAU;YACnD;YACA,SAAS;gBACP,eAAe,OAAO,iBAAiB,aAAa;gBACpD,WAAW,OAAO,iBAAiB,SAAS;gBAC5C,aAAa,iBAAiB,WAAW;gBACzC,cAAc,iBAAiB,YAAY;gBAC3C,WAAW,iBAAiB,WAAW,KAAK,OACxC,iBAAiB,WAAW,GAAG,iBAAiB,YAAY,GAC5D;YACN;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sCAAsC;QACpD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,WAAW;QAAK;IAC7C;AACF"}}]
}