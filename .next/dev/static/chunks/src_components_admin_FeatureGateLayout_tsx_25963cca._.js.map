{"version":3,"sources":null,"sections":[{"offset":{"line":5,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/components/admin/FeatureGateLayout.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { useSession } from 'next-auth/react'\r\nimport { useRouter } from 'next/navigation'\r\nimport toast from 'react-hot-toast'\r\n\r\ninterface FeatureGateLayoutProps {\r\n  featureName: string\r\n  featureDisplayName: string\r\n  children: React.ReactNode\r\n}\r\n\r\nexport default function FeatureGateLayout({\r\n  featureName,\r\n  featureDisplayName,\r\n  children,\r\n}: FeatureGateLayoutProps) {\r\n  const { data: session, status } = useSession()\r\n  const router = useRouter()\r\n  const [featureEnabled, setFeatureEnabled] = useState<boolean | null>(null)\r\n  const [isLoading, setIsLoading] = useState(true)\r\n\r\n  useEffect(() => {\r\n    const checkFeatureAccess = async () => {\r\n      try {\r\n        // Check if feature is enabled\r\n        const response = await fetch('/api/features/enabled')\r\n        if (response.ok) {\r\n          const data = await response.json()\r\n          const isEnabled = data.features?.includes(featureName)\r\n          setFeatureEnabled(isEnabled)\r\n\r\n          if (!isEnabled) {\r\n            // Feature is disabled - redirect to admin dashboard\r\n            toast.error(`${featureDisplayName} feature is not available`)\r\n            router.push('/admin')\r\n            return\r\n          }\r\n        } else {\r\n          // If API fails, assume feature is disabled\r\n          setFeatureEnabled(false)\r\n          router.push('/admin')\r\n          return\r\n        }\r\n      } catch (error) {\r\n        console.error('Error checking feature access:', error)\r\n        setFeatureEnabled(false)\r\n        toast.error('Unable to verify feature access')\r\n        router.push('/admin')\r\n      } finally {\r\n        setIsLoading(false)\r\n      }\r\n    }\r\n\r\n    if (status !== 'loading' && session) {\r\n      checkFeatureAccess()\r\n    }\r\n  }, [status, session, router, featureName, featureDisplayName])\r\n\r\n  // Show loading state while checking\r\n  if (status === 'loading' || isLoading || featureEnabled === null) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // If feature is disabled, show nothing (will redirect)\r\n  if (!featureEnabled) {\r\n    return null\r\n  }\r\n\r\n  // Feature is enabled - render children\r\n  return <>{children}</>\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAae,SAAS,kBAAkB,EACxC,WAAW,EACX,kBAAkB,EAClB,QAAQ,EACe;;IACvB,MAAM,EAAE,MAAM,OAAO,EAAE,MAAM,EAAE,GAAG,IAAA,+JAAU;IAC5C,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAiB;IACrE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,IAAA,0KAAS;uCAAC;YACR,MAAM;kEAAqB;oBACzB,IAAI;wBACF,8BAA8B;wBAC9B,MAAM,WAAW,MAAM,MAAM;wBAC7B,IAAI,SAAS,EAAE,EAAE;4BACf,MAAM,OAAO,MAAM,SAAS,IAAI;4BAChC,MAAM,YAAY,KAAK,QAAQ,EAAE,SAAS;4BAC1C,kBAAkB;4BAElB,IAAI,CAAC,WAAW;gCACd,oDAAoD;gCACpD,qKAAK,CAAC,KAAK,CAAC,GAAG,mBAAmB,yBAAyB,CAAC;gCAC5D,OAAO,IAAI,CAAC;gCACZ;4BACF;wBACF,OAAO;4BACL,2CAA2C;4BAC3C,kBAAkB;4BAClB,OAAO,IAAI,CAAC;4BACZ;wBACF;oBACF,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,kCAAkC;wBAChD,kBAAkB;wBAClB,qKAAK,CAAC,KAAK,CAAC;wBACZ,OAAO,IAAI,CAAC;oBACd,SAAU;wBACR,aAAa;oBACf;gBACF;;YAEA,IAAI,WAAW,aAAa,SAAS;gBACnC;YACF;QACF;sCAAG;QAAC;QAAQ;QAAS;QAAQ;QAAa;KAAmB;IAE7D,oCAAoC;IACpC,IAAI,WAAW,aAAa,aAAa,mBAAmB,MAAM;QAChE,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;;;;;;;IAI1C;IAEA,uDAAuD;IACvD,IAAI,CAAC,gBAAgB;QACnB,OAAO;IACT;IAEA,uCAAuC;IACvC,qBAAO;kBAAG;;AACZ;GAlEwB;;QAKY,+JAAU;QAC7B,kJAAS;;;KANF"}}],"debugId":"775d568e-dbdc-5b51-9301-680ae88e0e78"}