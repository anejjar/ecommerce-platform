{"version":3,"sources":null,"sections":[{"offset":{"line":5,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/i18n.ts"],"sourcesContent":["import { getRequestConfig } from 'next-intl/server';\nimport { notFound } from 'next/navigation';\n\n// Supported locales - can be managed from admin\nexport const locales = ['en', 'fr'] as const;\nexport type Locale = (typeof locales)[number];\nexport const defaultLocale: Locale = 'en';\n\nexport default getRequestConfig(async ({ requestLocale }) => {\n  let locale = await requestLocale;\n\n  // Validate that the incoming `locale` parameter is valid\n  if (!locale || !locales.includes(locale as Locale)) {\n    locale = defaultLocale;\n  }\n\n  try {\n    // Try to load translations from the messages directory (admin managed)\n    const messages = (await import(`../messages/${locale}.json`)).default;\n    return {\n      locale: locale as string,\n      messages\n    };\n  } catch (error) {\n    // If no translation file exists, fall back to English\n    console.warn(`Translation file for ${locale} not found, using English`);\n    const messages = (await import(`../messages/en.json`)).default;\n    return {\n      locale: locale as string,\n      messages\n    };\n  }\n});\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAIO,MAAM,UAAU;IAAC;IAAM;CAAK;AAE5B,MAAM,gBAAwB;6CAEtB,IAAA,uNAAgB,OAAC,OAAO,EAAE,aAAa,EAAE;IACtD,IAAI,SAAS,MAAM;IAEnB,yDAAyD;IACzD,IAAI,CAAC,UAAU,CAAC,QAAQ,QAAQ,CAAC,SAAmB;QAClD,SAAS;IACX;IAEA,IAAI;QACF,uEAAuE;QACvE,MAAM,WAAW,CAAC;;;;;;;;;kBAAa,CAAC,YAAY,EAAE,OAAO,KAAK,CAAC,CAAC,EAAE,OAAO;QACrE,OAAO;YACL,QAAQ;YACR;QACF;IACF,EAAE,OAAO,OAAO;QACd,sDAAsD;QACtD,QAAQ,IAAI,CAAC,CAAC,qBAAqB,EAAE,OAAO,yBAAyB,CAAC;QACtE,MAAM,WAAW,CAAC,gFAAmC,EAAE,OAAO;QAC9D,OAAO;YACL,QAAQ;YACR;QACF;IACF;AACF"}},{"offset":{"line":62,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/navigation.ts"],"sourcesContent":["import { createNavigation } from 'next-intl/navigation';\r\nimport { locales } from './i18n';\r\n\r\nexport const { Link, redirect, usePathname, useRouter } =\r\n    createNavigation({ locales });\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEO,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,WAAW,EAAE,SAAS,EAAE,GACnD,IAAA,qRAAgB,EAAC;IAAE,SAAA,yHAAO;AAAC"}},{"offset":{"line":86,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/redux/hooks.ts"],"sourcesContent":["import { useDispatch, useSelector, useStore } from 'react-redux';\nimport type { RootState, AppDispatch, AppStore } from './store';\n\nexport const useAppDispatch = useDispatch.withTypes<AppDispatch>();\nexport const useAppSelector = useSelector.withTypes<RootState>();\nexport const useAppStore = useStore.withTypes<AppStore>();\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAGO,MAAM,iBAAiB,2KAAW,CAAC,SAAS;AAC5C,MAAM,iBAAiB,2KAAW,CAAC,SAAS;AAC5C,MAAM,cAAc,wKAAQ,CAAC,SAAS"}},{"offset":{"line":106,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/formatting.ts"],"sourcesContent":["/**\r\n * Localized formatting utilities for currency, dates, and numbers\r\n */\r\n\r\n/**\r\n * Format currency based on locale\r\n */\r\nexport function formatCurrency(\r\n  amount: number | string,\r\n  locale: string = 'en',\r\n  currency: string = 'USD'\r\n): string {\r\n  const numAmount = typeof amount === 'string' ? parseFloat(amount) : amount;\r\n\r\n  try {\r\n    return new Intl.NumberFormat(locale, {\r\n      style: 'currency',\r\n      currency,\r\n    }).format(numAmount);\r\n  } catch (error) {\r\n    // Fallback to USD if currency not supported\r\n    return new Intl.NumberFormat(locale, {\r\n      style: 'currency',\r\n      currency: 'USD',\r\n    }).format(numAmount);\r\n  }\r\n}\r\n\r\n/**\r\n * Format date based on locale\r\n */\r\nexport function formatDate(\r\n  date: Date | string,\r\n  locale: string = 'en',\r\n  options?: Intl.DateTimeFormatOptions\r\n): string {\r\n  const dateObj = typeof date === 'string' ? new Date(date) : date;\r\n\r\n  const defaultOptions: Intl.DateTimeFormatOptions = {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    ...options,\r\n  };\r\n\r\n  return new Intl.DateTimeFormat(locale, defaultOptions).format(dateObj);\r\n}\r\n\r\n/**\r\n * Format date and time based on locale\r\n */\r\nexport function formatDateTime(\r\n  date: Date | string,\r\n  locale: string = 'en',\r\n  options?: Intl.DateTimeFormatOptions\r\n): string {\r\n  const dateObj = typeof date === 'string' ? new Date(date) : date;\r\n\r\n  const defaultOptions: Intl.DateTimeFormatOptions = {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    ...options,\r\n  };\r\n\r\n  return new Intl.DateTimeFormat(locale, defaultOptions).format(dateObj);\r\n}\r\n\r\n/**\r\n * Format number based on locale\r\n */\r\nexport function formatNumber(\r\n  number: number | string,\r\n  locale: string = 'en',\r\n  options?: Intl.NumberFormatOptions\r\n): string {\r\n  const num = typeof number === 'string' ? parseFloat(number) : number;\r\n\r\n  return new Intl.NumberFormat(locale, options).format(num);\r\n}\r\n\r\n/**\r\n * Format percentage based on locale\r\n */\r\nexport function formatPercentage(\r\n  value: number | string,\r\n  locale: string = 'en',\r\n  decimals: number = 0\r\n): string {\r\n  const num = typeof value === 'string' ? parseFloat(value) : value;\r\n\r\n  return new Intl.NumberFormat(locale, {\r\n    style: 'percent',\r\n    minimumFractionDigits: decimals,\r\n    maximumFractionDigits: decimals,\r\n  }).format(num / 100);\r\n}\r\n\r\n/**\r\n * Format relative time (e.g., \"2 days ago\", \"in 3 hours\")\r\n */\r\nexport function formatRelativeTime(\r\n  date: Date | string,\r\n  locale: string = 'en'\r\n): string {\r\n  const dateObj = typeof date === 'string' ? new Date(date) : date;\r\n  const now = new Date();\r\n  const diffInSeconds = Math.floor((now.getTime() - dateObj.getTime()) / 1000);\r\n\r\n  const rtf = new Intl.RelativeTimeFormat(locale, { numeric: 'auto' });\r\n\r\n  const intervals: { unit: Intl.RelativeTimeFormatUnit; seconds: number }[] = [\r\n    { unit: 'year', seconds: 31536000 },\r\n    { unit: 'month', seconds: 2592000 },\r\n    { unit: 'week', seconds: 604800 },\r\n    { unit: 'day', seconds: 86400 },\r\n    { unit: 'hour', seconds: 3600 },\r\n    { unit: 'minute', seconds: 60 },\r\n    { unit: 'second', seconds: 1 },\r\n  ];\r\n\r\n  for (const interval of intervals) {\r\n    const count = Math.floor(Math.abs(diffInSeconds) / interval.seconds);\r\n    if (count >= 1) {\r\n      return rtf.format(diffInSeconds > 0 ? -count : count, interval.unit);\r\n    }\r\n  }\r\n\r\n  return rtf.format(0, 'second');\r\n}\r\n\r\n/**\r\n * Format file size with locale-specific number formatting\r\n */\r\nexport function formatFileSize(\r\n  bytes: number,\r\n  locale: string = 'en',\r\n  decimals: number = 2\r\n): string {\r\n  if (bytes === 0) return '0 Bytes';\r\n\r\n  const k = 1024;\r\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\r\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n\r\n  const value = bytes / Math.pow(k, i);\r\n  const formatted = formatNumber(value, locale, {\r\n    minimumFractionDigits: decimals,\r\n    maximumFractionDigits: decimals,\r\n  });\r\n\r\n  return `${formatted} ${sizes[i]}`;\r\n}\r\n\r\n/**\r\n * Get locale-specific currency symbol\r\n */\r\nexport function getCurrencySymbol(locale: string = 'en', currency: string = 'USD'): string {\r\n  const formatted = new Intl.NumberFormat(locale, {\r\n    style: 'currency',\r\n    currency,\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0,\r\n  }).format(0);\r\n\r\n  // Extract symbol by removing the number\r\n  return formatted.replace(/\\d/g, '').trim();\r\n}\r\n\r\n/**\r\n * Format currency amount with custom symbol\r\n * This is used when you want to use the currency symbol from settings\r\n */\r\nexport function formatCurrencyWithSymbol(\r\n  amount: number | string,\r\n  symbol: string = '$',\r\n  locale: string = 'en-US'\r\n): string {\r\n  const numAmount = typeof amount === 'string' ? parseFloat(amount) : amount;\r\n  \r\n  if (isNaN(numAmount)) {\r\n    return `${symbol}0.00`;\r\n  }\r\n\r\n  // Format the number with locale-specific formatting\r\n  const formatted = new Intl.NumberFormat(locale, {\r\n    minimumFractionDigits: 2,\r\n    maximumFractionDigits: 2,\r\n  }).format(numAmount);\r\n\r\n  return `${symbol}${formatted}`;\r\n}\r\n\r\n/**\r\n * Format currency amount with custom symbol (no decimals)\r\n */\r\nexport function formatCurrencyWithSymbolNoDecimals(\r\n  amount: number | string,\r\n  symbol: string = '$',\r\n  locale: string = 'en-US'\r\n): string {\r\n  const numAmount = typeof amount === 'string' ? parseFloat(amount) : amount;\r\n  \r\n  if (isNaN(numAmount)) {\r\n    return `${symbol}0`;\r\n  }\r\n\r\n  // Format the number with locale-specific formatting\r\n  const formatted = new Intl.NumberFormat(locale, {\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0,\r\n  }).format(numAmount);\r\n\r\n  return `${symbol}${formatted}`;\r\n}\r\n\r\n/**\r\n * Format list of items based on locale\r\n */\r\nexport function formatList(\r\n  items: string[],\r\n  locale: string = 'en',\r\n  type: 'conjunction' | 'disjunction' = 'conjunction'\r\n): string {\r\n  if (items.length === 0) return '';\r\n  if (items.length === 1) return items[0];\r\n\r\n  const formatter = new Intl.ListFormat(locale, {\r\n    style: 'long',\r\n    type,\r\n  });\r\n\r\n  return formatter.format(items);\r\n}\r\n\r\n/**\r\n * Format compact number (e.g., 1K, 1M)\r\n */\r\nexport function formatCompactNumber(\r\n  number: number | string,\r\n  locale: string = 'en'\r\n): string {\r\n  const num = typeof number === 'string' ? parseFloat(number) : number;\r\n\r\n  return new Intl.NumberFormat(locale, {\r\n    notation: 'compact',\r\n    compactDisplay: 'short',\r\n  }).format(num);\r\n}\r\n\r\n/**\r\n * Locale configuration for specific locales\r\n */\r\nexport const localeConfigs = {\r\n  en: {\r\n    currency: 'USD',\r\n    dateFormat: 'MM/DD/YYYY',\r\n    timeFormat: '12h',\r\n  },\r\n  fr: {\r\n    currency: 'EUR',\r\n    dateFormat: 'DD/MM/YYYY',\r\n    timeFormat: '24h',\r\n  },\r\n} as const;\r\n\r\n/**\r\n * Get locale configuration\r\n */\r\nexport function getLocaleConfig(locale: string) {\r\n  return localeConfigs[locale as keyof typeof localeConfigs] || localeConfigs.en;\r\n}\r\n"],"names":[],"mappings":"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"}},{"offset":{"line":324,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/image-utils.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\n\r\n/**\r\n * Placeholder image data URL for product images\r\n * A professional SVG placeholder with icon\r\n */\r\nexport const PLACEHOLDER_PRODUCT_IMAGE = `data:image/svg+xml;charset=utf-8,${encodeURIComponent(\r\n  `<svg width=\"400\" height=\"400\" xmlns=\"http://www.w3.org/2000/svg\">\r\n    <defs>\r\n      <linearGradient id=\"bg\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\r\n        <stop offset=\"0%\" style=\"stop-color:#f9fafb;stop-opacity:1\" />\r\n        <stop offset=\"100%\" style=\"stop-color:#f3f4f6;stop-opacity:1\" />\r\n      </linearGradient>\r\n    </defs>\r\n    <rect width=\"400\" height=\"400\" fill=\"url(#bg)\"/>\r\n    <g transform=\"translate(200, 200)\">\r\n      <!-- Shopping bag icon -->\r\n      <path d=\"M-40 -20 L-40 60 L40 60 L40 -20 Z\" fill=\"#e5e7eb\" stroke=\"#d1d5db\" stroke-width=\"2\"/>\r\n      <rect x=\"-35\" y=\"-15\" width=\"70\" height=\"70\" fill=\"#e5e7eb\"/>\r\n      <path d=\"M-25 -20 Q-25 -45 0 -45 Q25 -45 25 -20\" fill=\"none\" stroke=\"#9ca3af\" stroke-width=\"3\" stroke-linecap=\"round\"/>\r\n      <!-- Shopping bag icon bottom -->\r\n      <circle cx=\"0\" cy=\"20\" r=\"3\" fill=\"#9ca3af\"/>\r\n    </g>\r\n    <text x=\"200\" y=\"280\" font-family=\"system-ui, -apple-system, sans-serif\" font-size=\"14\" fill=\"#9ca3af\" text-anchor=\"middle\" font-weight=\"500\">No Image Available</text>\r\n  </svg>`\r\n)}`;\r\n\r\n/**\r\n * Handle image error by replacing with placeholder\r\n * Works with both regular img elements and Next.js Image component\r\n */\r\nexport function handleImageError(e: React.SyntheticEvent<HTMLImageElement, Event>) {\r\n  const target = e.currentTarget;\r\n  // Prevent infinite loop if placeholder also fails\r\n  const currentSrc = target.src || target.getAttribute('src') || '';\r\n\r\n  if (currentSrc && !currentSrc.includes('data:image/svg+xml') && !currentSrc.includes('placeholder')) {\r\n    try {\r\n      // For Next.js Image, we need to update the src directly\r\n      // The onError handler receives the native img element\r\n      target.src = PLACEHOLDER_PRODUCT_IMAGE;\r\n      target.setAttribute('src', PLACEHOLDER_PRODUCT_IMAGE);\r\n      target.onerror = null; // Prevent infinite loop\r\n    } catch (error) {\r\n      // If setting src fails, try to hide the image and show placeholder\r\n      console.warn('Failed to set placeholder image:', error);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Handle image error for native HTML img elements\r\n * Use this for standard <img> tags (non-Next.js Image components)\r\n */\r\nexport function handleNativeImageError(e: React.SyntheticEvent<HTMLImageElement, Event>) {\r\n  const target = e.currentTarget;\r\n  const currentSrc = target.src || '';\r\n\r\n  if (currentSrc && !currentSrc.includes('data:image/svg+xml') && !currentSrc.includes('placeholder')) {\r\n    target.onerror = null; // Prevent infinite loop\r\n    target.src = PLACEHOLDER_PRODUCT_IMAGE;\r\n  }\r\n}\r\n\r\n/**\r\n * Get product image URL with fallback to placeholder\r\n */\r\nexport function getProductImageUrl(imageUrl: string | null | undefined): string {\r\n  if (!imageUrl || imageUrl.trim() === '') {\r\n    return PLACEHOLDER_PRODUCT_IMAGE;\r\n  }\r\n  return imageUrl;\r\n}\r\n\r\n/**\r\n * Hook for handling image errors with state\r\n * Use this for Next.js Image components when onError doesn't work reliably\r\n */\r\nexport function useImageErrorHandler(initialSrc: string | null | undefined) {\r\n  const [imageSrc, setImageSrc] = useState<string>(\r\n    getProductImageUrl(initialSrc)\r\n  );\r\n  const [hasError, setHasError] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (initialSrc && initialSrc !== imageSrc && !hasError) {\r\n      setImageSrc(initialSrc);\r\n      setHasError(false);\r\n    }\r\n  }, [initialSrc, imageSrc, hasError]);\r\n\r\n  const handleError = useCallback(() => {\r\n    if (!hasError) {\r\n      setHasError(true);\r\n      setImageSrc(PLACEHOLDER_PRODUCT_IMAGE);\r\n    }\r\n  }, [hasError]);\r\n\r\n  return { imageSrc, handleError, hasError };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;;AAMO,MAAM,4BAA4B,CAAC,iCAAiC,EAAE,mBAC3E,CAAC;;;;;;;;;;;;;;;;;QAiBK,CAAC,GACN;AAMI,SAAS,iBAAiB,CAAgD;IAC/E,MAAM,SAAS,EAAE,aAAa;IAC9B,kDAAkD;IAClD,MAAM,aAAa,OAAO,GAAG,IAAI,OAAO,YAAY,CAAC,UAAU;IAE/D,IAAI,cAAc,CAAC,WAAW,QAAQ,CAAC,yBAAyB,CAAC,WAAW,QAAQ,CAAC,gBAAgB;QACnG,IAAI;YACF,wDAAwD;YACxD,sDAAsD;YACtD,OAAO,GAAG,GAAG;YACb,OAAO,YAAY,CAAC,OAAO;YAC3B,OAAO,OAAO,GAAG,MAAM,wBAAwB;QACjD,EAAE,OAAO,OAAO;YACd,mEAAmE;YACnE,QAAQ,IAAI,CAAC,oCAAoC;QACnD;IACF;AACF;AAMO,SAAS,uBAAuB,CAAgD;IACrF,MAAM,SAAS,EAAE,aAAa;IAC9B,MAAM,aAAa,OAAO,GAAG,IAAI;IAEjC,IAAI,cAAc,CAAC,WAAW,QAAQ,CAAC,yBAAyB,CAAC,WAAW,QAAQ,CAAC,gBAAgB;QACnG,OAAO,OAAO,GAAG,MAAM,wBAAwB;QAC/C,OAAO,GAAG,GAAG;IACf;AACF;AAKO,SAAS,mBAAmB,QAAmC;IACpE,IAAI,CAAC,YAAY,SAAS,IAAI,OAAO,IAAI;QACvC,OAAO;IACT;IACA,OAAO;AACT;AAMO,SAAS,qBAAqB,UAAqC;;IACxE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EACtC,mBAAmB;IAErB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,IAAA,0KAAS;0CAAC;YACR,IAAI,cAAc,eAAe,YAAY,CAAC,UAAU;gBACtD,YAAY;gBACZ,YAAY;YACd;QACF;yCAAG;QAAC;QAAY;QAAU;KAAS;IAEnC,MAAM,cAAc,IAAA,4KAAW;yDAAC;YAC9B,IAAI,CAAC,UAAU;gBACb,YAAY;gBACZ,YAAY;YACd;QACF;wDAAG;QAAC;KAAS;IAEb,OAAO;QAAE;QAAU;QAAa;IAAS;AAC3C;GArBgB"}},{"offset":{"line":428,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/lib/normalizeBlockConfig.ts"],"sourcesContent":["/**\r\n * Normalizes block configuration data to ensure repeater fields are always arrays\r\n * This prevents \"value.map is not a function\" errors when loading existing blocks\r\n */\r\nexport function normalizeBlockConfig(config: any, schema: any): any {\r\n    if (!config || !schema) return config;\r\n\r\n    const normalized = { ...config };\r\n    const schemaFields = schema.fields || [];\r\n\r\n    // Recursively normalize repeater fields\r\n    const normalizeRepeaterField = (field: any, value: any): any => {\r\n        if (field.type === 'repeater' && field.fields) {\r\n            // Ensure value is an array\r\n            const arrayValue = Array.isArray(value) ? value : (value ? [value] : []);\r\n            \r\n            // Normalize each item in the repeater\r\n            return arrayValue.map((item: any) => {\r\n                const normalizedItem: any = {};\r\n                field.fields.forEach((subField: any) => {\r\n                    if (subField.type === 'repeater') {\r\n                        // Handle nested repeaters\r\n                        normalizedItem[subField.name] = normalizeRepeaterField(\r\n                            subField,\r\n                            item[subField.name]\r\n                        );\r\n                    } else {\r\n                        normalizedItem[subField.name] = item[subField.name] ?? (subField.default ?? '');\r\n                    }\r\n                });\r\n                return normalizedItem;\r\n            });\r\n        }\r\n        return value;\r\n    };\r\n\r\n    // Normalize all fields in the config\r\n    schemaFields.forEach((field: any) => {\r\n        if (field.type === 'repeater') {\r\n            normalized[field.name] = normalizeRepeaterField(field, normalized[field.name]);\r\n        }\r\n    });\r\n\r\n    return normalized;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AACM,SAAS,qBAAqB,MAAW,EAAE,MAAW;IACzD,IAAI,CAAC,UAAU,CAAC,QAAQ,OAAO;IAE/B,MAAM,aAAa;QAAE,GAAG,MAAM;IAAC;IAC/B,MAAM,eAAe,OAAO,MAAM,IAAI,EAAE;IAExC,wCAAwC;IACxC,MAAM,yBAAyB,CAAC,OAAY;QACxC,IAAI,MAAM,IAAI,KAAK,cAAc,MAAM,MAAM,EAAE;YAC3C,2BAA2B;YAC3B,MAAM,aAAa,MAAM,OAAO,CAAC,SAAS,QAAS,QAAQ;gBAAC;aAAM,GAAG,EAAE;YAEvE,sCAAsC;YACtC,OAAO,WAAW,GAAG,CAAC,CAAC;gBACnB,MAAM,iBAAsB,CAAC;gBAC7B,MAAM,MAAM,CAAC,OAAO,CAAC,CAAC;oBAClB,IAAI,SAAS,IAAI,KAAK,YAAY;wBAC9B,0BAA0B;wBAC1B,cAAc,CAAC,SAAS,IAAI,CAAC,GAAG,uBAC5B,UACA,IAAI,CAAC,SAAS,IAAI,CAAC;oBAE3B,OAAO;wBACH,cAAc,CAAC,SAAS,IAAI,CAAC,GAAG,IAAI,CAAC,SAAS,IAAI,CAAC,IAAK,SAAS,OAAO,IAAI;oBAChF;gBACJ;gBACA,OAAO;YACX;QACJ;QACA,OAAO;IACX;IAEA,qCAAqC;IACrC,aAAa,OAAO,CAAC,CAAC;QAClB,IAAI,MAAM,IAAI,KAAK,YAAY;YAC3B,UAAU,CAAC,MAAM,IAAI,CAAC,GAAG,uBAAuB,OAAO,UAAU,CAAC,MAAM,IAAI,CAAC;QACjF;IACJ;IAEA,OAAO;AACX"}},{"offset":{"line":479,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/hooks/useCurrency.ts"],"sourcesContent":["'use client';\r\n\r\nimport { useSettings } from '@/contexts/SettingsContext';\r\nimport { formatCurrencyWithSymbol, formatCurrencyWithSymbolNoDecimals } from '@/lib/formatting';\r\n\r\n/**\r\n * Custom hook to format currency using the currency symbol from settings\r\n * This hook should be used throughout the application instead of hardcoding currency symbols\r\n */\r\nexport function useCurrency() {\r\n  const { settings } = useSettings();\r\n  const currencySymbol = settings.general_currency_symbol || '$';\r\n\r\n  /**\r\n   * Format currency with 2 decimal places\r\n   */\r\n  const format = (amount: number | string): string => {\r\n    return formatCurrencyWithSymbol(amount, currencySymbol);\r\n  };\r\n\r\n  /**\r\n   * Format currency without decimal places\r\n   */\r\n  const formatNoDecimals = (amount: number | string): string => {\r\n    return formatCurrencyWithSymbolNoDecimals(amount, currencySymbol);\r\n  };\r\n\r\n  /**\r\n   * Get the currency symbol\r\n   */\r\n  const symbol = currencySymbol;\r\n\r\n  /**\r\n   * Format a number with the currency symbol (for custom formatting)\r\n   */\r\n  const formatWithSymbol = (amount: number | string, options?: { decimals?: number }): string => {\r\n    const numAmount = typeof amount === 'string' ? parseFloat(amount) : amount;\r\n    \r\n    if (isNaN(numAmount)) {\r\n      return `${currencySymbol}0${options?.decimals === 0 ? '' : '.00'}`;\r\n    }\r\n\r\n    const formatted = new Intl.NumberFormat('en-US', {\r\n      minimumFractionDigits: options?.decimals ?? 2,\r\n      maximumFractionDigits: options?.decimals ?? 2,\r\n    }).format(numAmount);\r\n\r\n    return `${currencySymbol}${formatted}`;\r\n  };\r\n\r\n  return {\r\n    format,\r\n    formatNoDecimals,\r\n    symbol,\r\n    formatWithSymbol,\r\n  };\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAEA;AACA;;AAHA;;;AASO,SAAS;;IACd,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,qJAAW;IAChC,MAAM,iBAAiB,SAAS,uBAAuB,IAAI;IAE3D;;GAEC,GACD,MAAM,SAAS,CAAC;QACd,OAAO,IAAA,uJAAwB,EAAC,QAAQ;IAC1C;IAEA;;GAEC,GACD,MAAM,mBAAmB,CAAC;QACxB,OAAO,IAAA,iKAAkC,EAAC,QAAQ;IACpD;IAEA;;GAEC,GACD,MAAM,SAAS;IAEf;;GAEC,GACD,MAAM,mBAAmB,CAAC,QAAyB;QACjD,MAAM,YAAY,OAAO,WAAW,WAAW,WAAW,UAAU;QAEpE,IAAI,MAAM,YAAY;YACpB,OAAO,GAAG,eAAe,CAAC,EAAE,SAAS,aAAa,IAAI,KAAK,OAAO;QACpE;QAEA,MAAM,YAAY,IAAI,KAAK,YAAY,CAAC,SAAS;YAC/C,uBAAuB,SAAS,YAAY;YAC5C,uBAAuB,SAAS,YAAY;QAC9C,GAAG,MAAM,CAAC;QAEV,OAAO,GAAG,iBAAiB,WAAW;IACxC;IAEA,OAAO;QACL;QACA;QACA;QACA;IACF;AACF;GA/CgB;;QACO,qJAAW"}},{"offset":{"line":538,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/hooks/useFlashSale.ts"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\n\r\ninterface FlashSaleData {\r\n  flashSale: {\r\n    id: string\r\n    name: string\r\n    description: string | null\r\n    discountType: 'PERCENTAGE' | 'FIXED_AMOUNT'\r\n    discountValue: number\r\n    startDate: string\r\n    endDate: string\r\n    bannerImage: string | null\r\n    bannerText: string | null\r\n  } | null\r\n  product: {\r\n    originalPrice: number\r\n    salePrice: number\r\n    maxQuantity: number | null\r\n    soldQuantity: number\r\n    available: number | null\r\n  } | null\r\n}\r\n\r\nexport function useFlashSale(productId: string) {\r\n  const [flashSaleData, setFlashSaleData] = useState<FlashSaleData>({\r\n    flashSale: null,\r\n    product: null,\r\n  })\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  useEffect(() => {\r\n    async function fetchFlashSale() {\r\n      try {\r\n        const response = await fetch(`/api/products/${productId}/flash-sale`)\r\n        if (response.ok) {\r\n          const data = await response.json()\r\n          setFlashSaleData(data)\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching flash sale:', error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    if (productId) {\r\n      fetchFlashSale()\r\n    } else {\r\n      setLoading(false)\r\n    }\r\n  }, [productId])\r\n\r\n  return { ...flashSaleData, loading }\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAEA;;AAFA;;AAyBO,SAAS,aAAa,SAAiB;;IAC5C,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAgB;QAChE,WAAW;QACX,SAAS;IACX;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;kCAAC;YACR,eAAe;gBACb,IAAI;oBACF,MAAM,WAAW,MAAM,MAAM,CAAC,cAAc,EAAE,UAAU,WAAW,CAAC;oBACpE,IAAI,SAAS,EAAE,EAAE;wBACf,MAAM,OAAO,MAAM,SAAS,IAAI;wBAChC,iBAAiB;oBACnB;gBACF,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,8BAA8B;gBAC9C,SAAU;oBACR,WAAW;gBACb;YACF;YAEA,IAAI,WAAW;gBACb;YACF,OAAO;gBACL,WAAW;YACb;QACF;iCAAG;QAAC;KAAU;IAEd,OAAO;QAAE,GAAG,aAAa;QAAE;IAAQ;AACrC;GA9BgB"}},{"offset":{"line":590,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/hooks/useTheme.ts"],"sourcesContent":["/**\r\n * useTheme Hook\r\n * Convenience hook to access theme configuration\r\n */\r\n\r\nimport { useThemeContext } from '@/contexts/ThemeContext';\r\nimport { ThemeConfig } from '@/lib/themes/theme-schema';\r\n\r\nexport function useTheme(): {\r\n  theme: ThemeConfig | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  refreshTheme: () => Promise<void>;\r\n} {\r\n  return useThemeContext();\r\n}\r\n\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AAED;;;AAGO,SAAS;;IAMd,OAAO,IAAA,sJAAe;AACxB;GAPgB;;QAMP,sJAAe"}},{"offset":{"line":616,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/hooks/usePageEditor.ts"],"sourcesContent":["import { useState, useCallback, useEffect, useRef } from 'react';\nimport { toast } from 'react-hot-toast';\nimport { useRouter } from 'next/navigation';\n\nexport interface EditorBlock {\n    id: string;\n    templateId: string;\n    config: any;\n    order: number;\n    template?: {\n        id: string;\n        name: string;\n        slug: string;\n        category: string;\n        componentCode: string;\n        defaultConfig: any;\n        configSchema: any;\n    };\n}\n\ninterface UsePageEditorProps {\n    pageId: string;\n    initialBlocks?: EditorBlock[];\n    initialPageData?: any;\n    autoSaveEnabled?: boolean;\n    autoSaveDelay?: number;\n}\n\nexport function usePageEditor({ \n    pageId, \n    initialBlocks = [], \n    initialPageData = {},\n    autoSaveEnabled = true,\n    autoSaveDelay = 2000,\n    templates = []\n}: UsePageEditorProps) {\n    const router = useRouter();\n    const [blocks, setBlocks] = useState<EditorBlock[]>(initialBlocks);\n    const [pageData, setPageData] = useState(initialPageData);\n    const [selectedBlockId, setSelectedBlockId] = useState<string | null>(null);\n    const [isSaving, setIsSaving] = useState(false);\n    const [isDirty, setIsDirty] = useState(false);\n    const [autoSaveStatus, setAutoSaveStatus] = useState<'idle' | 'saving' | 'saved' | 'error'>('idle');\n    const autoSaveTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n    const lastSavedStateRef = useRef<string>('');\n    \n    // Undo/Redo state\n    const [history, setHistory] = useState<Array<{ blocks: EditorBlock[]; pageData: any }>>([]);\n    const [historyIndex, setHistoryIndex] = useState(-1);\n    const maxHistorySize = 50;\n    const configUpdateTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n    const pageDataUpdateTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n    // Initialize blocks if provided later (e.g. after fetch) - only if blocks array is empty\n    useEffect(() => {\n        if (initialBlocks.length > 0 && blocks.length === 0) {\n            setBlocks(initialBlocks);\n            // Initialize history with initial state\n            setHistory([{ blocks: initialBlocks, pageData: initialPageData }]);\n            setHistoryIndex(0);\n        }\n    }, [initialBlocks, blocks.length, initialPageData]);\n\n    // Save state to history\n    const saveToHistory = useCallback((blocksToSave: EditorBlock[], pageDataToSave: any) => {\n        setHistory(prev => {\n            const newHistory = prev.slice(0, historyIndex + 1);\n            newHistory.push({ blocks: blocksToSave, pageData: pageDataToSave });\n            \n            // Limit history size\n            if (newHistory.length > maxHistorySize) {\n                newHistory.shift();\n                return newHistory;\n            }\n            \n            return newHistory;\n        });\n        setHistoryIndex(prev => Math.min(prev + 1, maxHistorySize - 1));\n    }, [historyIndex, maxHistorySize]);\n\n    // Undo function\n    const undo = useCallback(() => {\n        if (historyIndex > 0) {\n            const newIndex = historyIndex - 1;\n            const state = history[newIndex];\n            setBlocks(state.blocks);\n            setPageData(state.pageData);\n            setHistoryIndex(newIndex);\n            setIsDirty(true);\n        }\n    }, [history, historyIndex]);\n\n    // Redo function\n    const redo = useCallback(() => {\n        if (historyIndex < history.length - 1) {\n            const newIndex = historyIndex + 1;\n            const state = history[newIndex];\n            setBlocks(state.blocks);\n            setPageData(state.pageData);\n            setHistoryIndex(newIndex);\n            setIsDirty(true);\n        }\n    }, [history, historyIndex]);\n\n    // Check if undo/redo is available\n    const canUndo = historyIndex > 0;\n    const canRedo = historyIndex < history.length - 1;\n\n    // Load from localStorage on mount\n    useEffect(() => {\n        const storageKey = `cms-editor-${pageId}`;\n        try {\n            const saved = localStorage.getItem(storageKey);\n            if (saved) {\n                const parsed = JSON.parse(saved);\n                if (parsed.blocks && parsed.blocks.length > 0) {\n                    setBlocks(parsed.blocks);\n                }\n                if (parsed.pageData) {\n                    setPageData(parsed.pageData);\n                }\n                setIsDirty(true);\n            }\n        } catch (error) {\n            console.error('Failed to load from localStorage:', error);\n        }\n    }, [pageId]);\n\n    // Save to localStorage as backup\n    const saveToLocalStorage = useCallback((blocksToSave: EditorBlock[], pageDataToSave: any) => {\n        const storageKey = `cms-editor-${pageId}`;\n        try {\n            localStorage.setItem(storageKey, JSON.stringify({\n                blocks: blocksToSave,\n                pageData: pageDataToSave,\n                timestamp: Date.now()\n            }));\n        } catch (error) {\n            console.error('Failed to save to localStorage:', error);\n        }\n    }, [pageId]);\n\n    // Clear localStorage after successful save\n    const clearLocalStorage = useCallback(() => {\n        const storageKey = `cms-editor-${pageId}`;\n        try {\n            localStorage.removeItem(storageKey);\n        } catch (error) {\n            console.error('Failed to clear localStorage:', error);\n        }\n    }, [pageId]);\n\n    const addBlock = useCallback((template: any) => {\n        const newBlock: EditorBlock = {\n            id: `temp-${Date.now()}`, // Temporary ID until saved\n            templateId: template.id,\n            config: template.defaultConfig || {},\n            order: blocks.length,\n            template: template\n        };\n\n        setBlocks(prev => {\n            const updated = [...prev, newBlock];\n            saveToHistory(updated, pageData);\n            return updated;\n        });\n        setSelectedBlockId(newBlock.id);\n        setIsDirty(true);\n    }, [blocks.length, pageData, saveToHistory]);\n\n    const updateBlockConfig = useCallback((blockId: string, newConfig: any) => {\n        setBlocks(prev => {\n            const updated = prev.map(block =>\n                block.id === blockId ? { ...block, config: newConfig } : block\n            );\n            // Debounce history saves for config updates (only save every 500ms)\n            if (configUpdateTimeoutRef.current) {\n                clearTimeout(configUpdateTimeoutRef.current);\n            }\n            configUpdateTimeoutRef.current = setTimeout(() => {\n                saveToHistory(updated, pageData);\n            }, 500);\n            return updated;\n        });\n        setIsDirty(true);\n    }, [pageData, saveToHistory]);\n\n    const removeBlock = useCallback((blockId: string) => {\n        setBlocks(prev => {\n            const updated = prev.filter(block => block.id !== blockId);\n            saveToHistory(updated, pageData);\n            return updated;\n        });\n        if (selectedBlockId === blockId) {\n            setSelectedBlockId(null);\n        }\n        setIsDirty(true);\n    }, [selectedBlockId, pageData, saveToHistory]);\n\n    const duplicateBlock = useCallback((blockId: string) => {\n        const blockToDuplicate = blocks.find(b => b.id === blockId);\n        if (!blockToDuplicate) return;\n\n        const newBlock: EditorBlock = {\n            id: `temp-${Date.now()}`,\n            templateId: blockToDuplicate.templateId,\n            config: { ...blockToDuplicate.config },\n            order: blockToDuplicate.order + 1,\n            template: blockToDuplicate.template\n        };\n\n        setBlocks(prev => {\n            const index = prev.findIndex(b => b.id === blockId);\n            const updated = [\n                ...prev.slice(0, index + 1),\n                newBlock,\n                ...prev.slice(index + 1).map(b => ({ ...b, order: b.order + 1 }))\n            ];\n            saveToHistory(updated, pageData);\n            return updated;\n        });\n        setSelectedBlockId(newBlock.id);\n        setIsDirty(true);\n    }, [blocks, pageData, saveToHistory]);\n\n    const reorderBlocks = useCallback((newBlocks: EditorBlock[]) => {\n        // Update order property based on index\n        const orderedBlocks = newBlocks.map((block, index) => ({\n            ...block,\n            order: index\n        }));\n        setBlocks(orderedBlocks);\n        saveToHistory(orderedBlocks, pageData);\n        setIsDirty(true);\n    }, [pageData, saveToHistory]);\n\n    const updatePageData = useCallback((field: string, value: any) => {\n        setPageData(prev => {\n            const updated = { ...prev, [field]: value };\n            // Debounce history saves for page data updates\n            if (pageDataUpdateTimeoutRef.current) {\n                clearTimeout(pageDataUpdateTimeoutRef.current);\n            }\n            pageDataUpdateTimeoutRef.current = setTimeout(() => {\n                saveToHistory(blocks, updated);\n            }, 500);\n            return updated;\n        });\n        setIsDirty(true);\n    }, [blocks, saveToHistory]);\n\n    const savePage = useCallback(async (isAutoSave = false) => {\n        setIsSaving(true);\n        if (isAutoSave) {\n            setAutoSaveStatus('saving');\n        }\n        try {\n            // Save page data first\n            const pageResponse = await fetch(`/api/admin/cms/pages/${pageId}`, {\n                method: 'PUT',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    title: pageData.title,\n                    slug: pageData.slug,\n                    description: pageData.description,\n                    seoTitle: pageData.seoTitle,\n                    seoDescription: pageData.seoDescription,\n                    seoKeywords: pageData.seoKeywords,\n                    status: pageData.status,\n                }),\n            });\n\n            if (!pageResponse.ok) {\n                const errorData = await pageResponse.json().catch(() => ({}));\n                throw new Error(errorData.error || 'Failed to save page data');\n            }\n\n            // Then sync blocks\n            const blocksResponse = await fetch(`/api/admin/cms/pages/${pageId}/sync-blocks`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    blocks: blocks.map(block => ({\n                        id: block.id,\n                        templateId: block.templateId,\n                        config: block.config,\n                        order: block.order,\n                    })),\n                }),\n            });\n\n            if (!blocksResponse.ok) {\n                throw new Error('Failed to save blocks');\n            }\n\n            const data = await blocksResponse.json();\n\n            // Update blocks with the server response (to get real IDs for temp blocks)\n            if (data.page?.blocks) {\n                // Create a mapping from old block IDs to new block IDs\n                // This helps preserve the selected block when temp IDs are replaced\n                const idMap = new Map<string, string>();\n                \n                // First, try to match by index (most common case)\n                blocks.forEach((oldBlock, index) => {\n                    if (data.page.blocks[index]) {\n                        idMap.set(oldBlock.id, data.page.blocks[index].id);\n                    }\n                });\n                \n                // Also match by templateId + order as fallback (in case order changed)\n                blocks.forEach((oldBlock) => {\n                    if (!idMap.has(oldBlock.id)) {\n                        const matchingBlock = data.page.blocks.find(\n                            (newBlock: any) => \n                                newBlock.templateId === oldBlock.templateId && \n                                newBlock.order === oldBlock.order\n                        );\n                        if (matchingBlock) {\n                            idMap.set(oldBlock.id, matchingBlock.id);\n                        }\n                    }\n                });\n\n                const updatedBlocks = data.page.blocks.map((block: any) => {\n                    // Find the existing block to preserve template data if server response is incomplete\n                    const existingBlock = blocks.find(b => \n                        b.id === block.id || \n                        (b.templateId === block.templateId && b.order === block.order)\n                    );\n                    \n                    // Use template from server response if it has configSchema\n                    let template = block.template;\n                    if (!template || !template.configSchema) {\n                        // Fall back to existing block's template\n                        if (existingBlock?.template && existingBlock.template.configSchema) {\n                            template = existingBlock.template;\n                        } else {\n                            // Last resort: find template from templates array\n                            const templateFromArray = templates.find(t => t.id === block.templateId);\n                            if (templateFromArray) {\n                                template = templateFromArray;\n                            } else {\n                                // Use whatever we have\n                                template = block.template || existingBlock?.template;\n                            }\n                        }\n                    }\n                    \n                    return {\n                        id: block.id,\n                        templateId: block.templateId,\n                        config: block.config,\n                        order: block.order,\n                        template: template,\n                    };\n                });\n                setBlocks(updatedBlocks);\n                \n                // Preserve selected block ID if it was a temp block that got a new ID\n                if (selectedBlockId && idMap.has(selectedBlockId)) {\n                    const newId = idMap.get(selectedBlockId);\n                    if (newId) {\n                        setSelectedBlockId(newId);\n                    }\n                } else if (selectedBlockId) {\n                    // If the selected block ID doesn't exist in updated blocks, check if it still exists\n                    const blockStillExists = updatedBlocks.some(b => b.id === selectedBlockId);\n                    if (!blockStillExists) {\n                        // Block was removed or ID changed, deselect\n                        setSelectedBlockId(null);\n                    }\n                }\n                \n                // Update last saved state\n                lastSavedStateRef.current = JSON.stringify({ blocks: updatedBlocks, pageData });\n            }\n\n            setIsDirty(false);\n            if (isAutoSave) {\n                setAutoSaveStatus('saved');\n                clearLocalStorage();\n                setTimeout(() => setAutoSaveStatus('idle'), 2000);\n            } else {\n                toast.success('Page saved successfully');\n                clearLocalStorage();\n            }\n            \n            // Refresh will reload the page data from server\n            router.refresh();\n        } catch (error: any) {\n            console.error('Error saving page:', error);\n            if (isAutoSave) {\n                setAutoSaveStatus('error');\n                setTimeout(() => setAutoSaveStatus('idle'), 3000);\n            } else {\n                toast.error(error.message || 'Failed to save page');\n            }\n        } finally {\n            setIsSaving(false);\n        }\n    }, [blocks, pageId, pageData, router, clearLocalStorage]);\n\n    // Auto-save effect\n    useEffect(() => {\n        if (!autoSaveEnabled || !isDirty) {\n            return;\n        }\n\n        // Clear existing timeout\n        if (autoSaveTimeoutRef.current) {\n            clearTimeout(autoSaveTimeoutRef.current);\n        }\n\n        // Save current state to localStorage\n        saveToLocalStorage(blocks, pageData);\n\n        // Set new timeout for auto-save\n        autoSaveTimeoutRef.current = setTimeout(() => {\n            const currentState = JSON.stringify({ blocks, pageData });\n            // Only auto-save if state has changed since last save\n            if (currentState !== lastSavedStateRef.current) {\n                savePage(true);\n            }\n        }, autoSaveDelay);\n\n        return () => {\n            if (autoSaveTimeoutRef.current) {\n                clearTimeout(autoSaveTimeoutRef.current);\n            }\n        };\n    }, [blocks, pageData, isDirty, autoSaveEnabled, autoSaveDelay, savePage, saveToLocalStorage]);\n\n    return {\n        blocks,\n        pageData,\n        selectedBlockId,\n        setSelectedBlockId,\n        addBlock,\n        updateBlockConfig,\n        updatePageData,\n        removeBlock,\n        reorderBlocks,\n        savePage,\n        isSaving,\n        isDirty,\n        autoSaveStatus,\n        undo,\n        redo,\n        canUndo,\n        canRedo,\n        duplicateBlock\n    };\n}\n"],"names":[],"mappings":"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"}},{"offset":{"line":1181,"column":0},"url":null,"map":{"version":3,"sources":["file:///C:/laragon/www/claude/ecommerce-platform/src/contexts/ThemeContext.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { ThemeConfig } from '@/lib/themes/theme-schema';\r\n\r\ninterface ThemeContextType {\r\n  theme: ThemeConfig | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  refreshTheme: () => Promise<void>;\r\n}\r\n\r\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\r\n\r\nexport function useThemeContext() {\r\n  const context = useContext(ThemeContext);\r\n  if (context === undefined) {\r\n    throw new Error('useThemeContext must be used within a ThemeProvider');\r\n  }\r\n  return context;\r\n}\r\n\r\ninterface ThemeProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function ThemeProvider({ children }: ThemeProviderProps) {\r\n  const [theme, setTheme] = useState<ThemeConfig | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const fetchActiveTheme = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const response = await fetch('/api/themes/active', {\r\n        cache: 'no-store',\r\n      });\r\n      \r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch active theme');\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data.theme) {\r\n        setTheme(data.theme);\r\n      } else {\r\n        setTheme(null);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error fetching theme:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to load theme');\r\n      setTheme(null);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchActiveTheme();\r\n  }, []);\r\n\r\n  return (\r\n    <ThemeContext.Provider\r\n      value={{\r\n        theme,\r\n        loading,\r\n        error,\r\n        refreshTheme: fetchActiveTheme,\r\n      }}\r\n    >\r\n      {children}\r\n    </ThemeContext.Provider>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AAYA,MAAM,6BAAe,IAAA,8KAAa,EAA+B;AAE1D,SAAS;;IACd,MAAM,UAAU,IAAA,2KAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;GANgB;AAYT,SAAS,cAAc,EAAE,QAAQ,EAAsB;;IAC5D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAqB;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,MAAM,mBAAmB;QACvB,IAAI;YACF,WAAW;YACX,SAAS;YACT,MAAM,WAAW,MAAM,MAAM,sBAAsB;gBACjD,OAAO;YACT;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAChC,IAAI,KAAK,KAAK,EAAE;gBACd,SAAS,KAAK,KAAK;YACrB,OAAO;gBACL,SAAS;YACX;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yBAAyB;YACvC,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;YAC9C,SAAS;QACX,SAAU;YACR,WAAW;QACb;IACF;IAEA,IAAA,0KAAS;mCAAC;YACR;QACF;kCAAG,EAAE;IAEL,qBACE,6LAAC,aAAa,QAAQ;QACpB,OAAO;YACL;YACA;YACA;YACA,cAAc;QAChB;kBAEC;;;;;;AAGP;IAhDgB;KAAA"}}],"debugId":"fc6809c1-0759-5dca-ba53-aeb26a27a9fc"}